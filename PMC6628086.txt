
==== Front
Brain SciBrain ScibrainsciBrain Sciences2076-3425MDPI 10.3390/brainsci9060144brainsci-09-00144ArticleUncovering Dynamic Brain Reconfiguration in MEG Working Memory n-Back Task Using Topological Data Analysis https://orcid.org/0000-0002-1299-8571Duman Ali Nabi 1*Tatar Ahmet Emin 1Pirim Harun 21 Department of Mathematics and Statistics, King Fahd University of Petroleum and Minerals, Dhahran 31261, Saudi Arabia; atatar@kfupm.edu.sa2 Department of Systems Engineering, King Fahd University of Petroleum and Minerals, Dhahran 31261, Saudi Arabia; harunpirim@kfupm.edu.sa* Correspondence: aliduman@kfupm.edu.sa19 6 2019 6 2019 9 6 14405 5 2019 15 6 2019 © 2019 by the authors.2019Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (http://creativecommons.org/licenses/by/4.0/).The increasing availability of high temporal resolution neuroimaging data has increased the efforts to understand the dynamics of neural functions. Until recently, there are few studies on generative models supporting classification and prediction of neural systems compared to the description of the architecture. However, the requirement of collapsing data spatially and temporally in the state-of-the art methods to analyze functional magnetic resonance imaging (fMRI), electroencephalogram (EEG) and magnetoencephalography (MEG) data cause loss of important information. In this study, we addressed this issue using a topological data analysis (TDA) method, called Mapper, which visualizes evolving patterns of brain activity as a mathematical graph. Accordingly, we analyzed preprocessed MEG data of 83 subjects from Human Connectome Project (HCP) collected during working memory n-back task. We examined variation in the dynamics of the brain states with the Mapper graphs, and to determine how this variation relates to measures such as response time and performance. The application of the Mapper method to MEG data detected a novel neuroimaging marker that explained the performance of the participants along with the ground truth of response time. In addition, TDA enabled us to distinguish two task-positive brain activations during 0-back and 2-back tasks, which is hard to detect with the other pipelines that require collapsing the data in the spatial and temporal domain. Further, the Mapper graphs of the individuals also revealed one large group in the middle of the stimulus detecting the high engagement in the brain with fine temporal resolution, which could contribute to increase spatiotemporal resolution by merging different imaging modalities. Hence, our work provides another evidence to the effectiveness of the TDA methods for extracting subtle dynamic properties of high temporal resolution MEG data without the temporal and spatial collapse.

working memorytopological data analysisdynamic functional connectivitymapperMEG
==== Body
1. Introduction
Understanding relations or interactions that link many elements of neurobiological systems is highly important area of research due to the recent development of imaging methods and the increasing availability of neural data. Several analytical methods to explore the time-evolving patterns of interaction between the regions of the brain are proposed to extract valuable insight from mesoscale neuroimaging data including functional magnetic resonance imaging (fMRI), electrocorticography (ECoG), magnetoencephalography (MEG), and electroencephalography (EEG). These approaches include the tools from topology and graph theory in mathematics, algorithm development in computer science, statistical mechanics in physics, and systems engineering.

Earlier techniques focusing on the inter-regional functional connectivity (FC) over the entire time scan time successfully investigate modular structure of brain regions in fMRI [1,2,3] and [4,5,6]. However, more recent studies suggest that the assessment of temporal dynamics is a more accurate way in describing cognitive processes as FC patterns may change over time [7,8,9,10,11]. As noted in [12], there are two main approaches to measure dynamic FC. The first one uses multiple successive time points and is mainly used for experiment without trial locking (e.g., resting state). The most abundant method that falls into the category is the sliding windows method MEG/EEG [13,14,15], which is formulated by dividing the whole time interval into sections, where FC is investigated. Other approaches include Hidden Markov Models [16,17] and phase difference derivative [18]. The second one, which is used in multiple task trials, is aggregation across the same time point of multiple trials to generate connectivity dynamics. In any of these pipelines, collapsing the data in temporal or spatial scale may result in loss of important information. For example, the sliding window time intervals reduces the temporal resolution of the raw data. Moreover, choosing a window width is an issue: As too short widows are negatively affected by noise, while the long ones may fail to capture rapid changes in FC. Saggar et al. recently addressed this issue of collapsing data for fMRI using topological data analysis (TDA) based on a method called Mapper [19].

TDA methods (i.e., persistent homology and Mapper) are not new to the neuroimaging community. Some remarkable applications of persistent homology include the detection of intrinsic structure in correlations between neural spike trains [20], analysis of the formation of spatial maps in the hippocampus [21] and characterization of the global architecture of fMRI data [22]. All these application concentrate on the static topological structure of the data and they need to be modified in order to be applied to detect dynamic characteristics.

In this study, we resorted to the Mapper method to investigate the dynamic features of the MEG data during cognition. One advantage of the Mapper over the other unsupervised machine learning (ML) techniques such as independent component analysis (ICA) [23] and clustering via correlation [24] is the compact and easily readable visual presentation of the data preserving the geometric structure. This visual output of Mapper is a graph using a single node for each cluster determined by a filtration function on a data cloud and laying edges between nodes whose corresponding clusters share at least one point. It has recently been applied to biological datasets successfully to extract novel insights such as identification of subpopulations of cancer, identification of genomic biomarkers, disease association, RNA folding, viral evolution, immunology, diabetes, and preclinical spinal cord injury [25,26,27].

Mapper can visualize the complex multivariate relationship of various variables simultaneously as a network diagram. The resulting topological map can be investigated to understand the relationship of each variable across the topological space to identify groups of clustered individuals that can be further probed for specific relationships among outcomes, validation and hypothesis testing. In [28], application of the Mapper to structural MRI data revealed two large subgroups of fragile X syndrome. Through direct visualization of functional and health outcomes, Mapper uncovered interactions between spinal cord injury and co-occurring traumatic brain injury (TBI), as well as detrimental drug effects [26]. In [29], it identified a unique diagnostic subgroup of patients with unfavorable outcome after mild TBI. It is also shown to be useful in defining less heterogeneous clinical subgroups in ADHD [30].

In [19], the authors applied Mapper to fMRI data to investigate the dynamics of overall brain reconfiguration during different cognitive tasks. Even though fMRI has been used to study brain dynamics before due to the maturity and availability of this technology, its temporal resolution is too low to detect subtle changes in brain dynamics [31]. In fMRI, neural activation is indirectly measured via local changes in the level of blood oxygenation that makes harder to collect real-time information of neural activities. In our study, we hence applied Mapper to a high temporal resolution MEG dataset from 83 individuals who performed working memory n-back task. With MEG, the sequence of neural events can be readily tracked with millisecond resolution. Hence, it is ideal for investigating the cognitive tasks that involve rapid decision making as it can detect directly the fast fluctuations in neuronal coherence. It is therefore natural to expect temporally more subtle biomarkers when applying Mapper pipeline to a MEG dataset rather than a fMRI dataset of the same cognitive task.

Here, we suggest an alternative visualization of MEG dataset from Human Connectome Project (HCP) using the Mapper algorithm to get new insights from the brain patterns dynamics. The nature of Mapper, which represents similar data points closer than dissimilar ones in a mathematical graph, enabled us to visually trace the brain states during the 0-back and 2-back working memory tasks. To show efficacy of our method, we tested the following hypotheses:Application of the Mapper method to MEG data would detect novel neuroimaging marker that explains the performance of the participants along with the ground truth of response time.

TDA would distinguish two task-positive brain activations during 0-back and 2-back tasks, which are hard to detect with other pipelines due to the low temporal resolution of the imaging modality and the collapse of the data in the spatial and temporal domain.

The Mapper graphs of the individuals would reveal one large group in the middle of the stimulus detecting the high engagement in the brain with fine temporal resolution. Hence, our pipeline with other imaging modalities (e.g., fMRI) could increase the spatiotemporal resolution in the analysis of brain dynamics.



2. Methods
2.1. Subjects and Data
We used the human non-invasive resting state and task Magnetoencephalography (MEG) dataset. It is publicly available from the Human Connectome Project (HCP) consortium [32]. It was acquired on a Magnes 3600 MEG (4D NeuroImaging, San Diego, USA) with 248 magnetometers. The Working memory data are available for a subset of 89 subjects (mean 28.7 years, range 22–35, 41 female/48 male) with two sessions per task. Each task has a similar or identical experimental design to the corresponding task acquired during fMRI imaging. In working memory task, people have to remember the occurrence of a n-back previously shown item (with n=0 and 2) with the items being either tools or faces [32]. Data are segmented to the onset of the non-target item (WM task).

We used the parcellated results (using Yeo et al.’s (2011) 17-network parcellation [33]) of the srcavgdics pipeline on the source-reconstructed (megconnectome pipeline v3) Working Memory data averaged event-related and time-frequency responses created by the tmegpreproc pipeline. The data created by the tmegpreproc pipeline have frequency 512. More information on these pipelines can be found in [32].

To these data, we also added subjects’ accuracies from 0-back and 2-back tests and median reaction time for these tests. If one of these pieces of information were missing for a subject, we excluded it from the dataset.

2.2. Topological Data Analysis: Mapper
The TDA-based Mapper method is considered as an unsupervised machine learning technique to analyze high-dimensional data. Unlike the supervised methods such as support vector machines (SVM) that compare predefined groups, it is used to discover previously unknown groups within a dataset. Mapper algorithm returns a compact representation in the shape of a graph which preserves the geometric properties of the underlying dataset; hence, it helps to point out complex multivariate features of the input data in an unbiased and data-driven manner. Moreover, Mapper can apply a set of dimension reduction techniques (e.g., principal component analysis (PCA), singular value decomposition (SVD), and stochastic neighborhood estimation (SNE)) to the data without the necessity of prior categorization or extensive cleaning, which might result in the loss of salient information.

We now explain the Mapper pipeline that we used to produce the Mapper graph. One can refer to [34,35,36] for theoretical details of the TDA-based methods. As with many other machine learning techniques, it starts with a n×m data matrix whose rows and columns correspond to the variables of interest (e.g., time points) and their observed values (e.g., voxel). One can consider the matrix as a point cloud consisting of m points in n-dimensional space. The first step of the Mapper is to assign values to the data points; these values, called filter values, can be the output of a density estimator, measure of centrality, PCA, SVD, stochastic neighborhood estimation (SNE), etc. In the second step, Mapper divides the filter space into the overlapping bins. The shape of the bins (e.g., interval, rectangle, rectangular prism, etc.) depends on the filter values. For example, if the range of the filter values is the interval [0,9], one can choose the bins as [0,3], [2,5], [4,7] and [6,9]. The purpose of the filter values is to collapse high dimensional data to a single data point and detect the meaningful properties of the data. Once the filter values and overlapping bins are determined, Mapper distributes the data points into the point sets based on their filter values. In the last step, Mapper clusters the data points in each set using a chosen distance metric, which can be any similarity function such as correlation, Euclidean, L1 or L∞ metrics along with a clustering algorithm such as single linkage clustering and density based clustering. The outcome of Mapper is a combinatorial graph whose nodes are the clusters and edges are between the nodes which share one or more data points. The resulting graph captures the geometric structure of the dataset indicating the spectra and clusters in a compact manner.

We note that the Mapper algorithm has several parameters: the number of intervals, the overlapping percentage, the distance, and the clustering algorithm. Increasing the number of intervals increases the complexity of the final visualization as the number nodes increase. As a result, each node contains only the highly similar data points. On the other hand, the change in the overlapping percentage effects the number of edges in the final graph. An increase in the percentage results in an increase in the number of edges. Once the network is extracted, the parameters can be tuned to focus the network similar to focusing a microscope on an image.

Mapper graphs can be investigated by focusing its structures at different scales, which include the local scale analysis of nodes (or edges), the intermediate (mesoscale) structures such as core-periphery and modality [19] and the global level of summary statistics. In this study, we concentrated on local level analysis. We detected the time points where the brain state returns to the baseline and statistically compared the result with ground truth obtained from HCP database.

2.3. Constructing the Mapper Graph for MEG Dataset
We applied the Mapper algorithm to the MEG working memory task data from HCP. Our goal was to trace the brain activation patterns during the 0-back and 2-back memory tests of each participant.

We refer to the flowchart in Figure 1 for a quick illustration of our methods.

As a first step in the flowchart, we obtained the source-level processed data from HCP, which has 91 time-points vs. 642 voxels. The preprocessing step returned the parcellated results of source-reconstructed Working Memory averaged event-related and time-frequency responses using the Yeo et al.’s (2011) [33] 17-network parcellation. In this case, our point cloud of 91 time points whose coordinates are the readings from 642 MEG locations, is a high-dimensional space, referred to as time space. This process of extracting an ordered list from the raw data, such as a row in a matrix, is called vectorization, and is a common first step in machine learning methods. Even though vectorization causes the loss of the locations of voxels relative to each other, the process does not affect the outcome of the machine learning methods (see [37]).

To proceed with the algorithm, we next chose a metric to measure the similarity between the vectors (i.e., brain states) in the time space. We used the Euclidean metric, which has proven to be successful in previous applications of neuroimage data [26,28].

The second step in the flowchart is to set a reference state to be used in filter selection. The first 30 out of 91 time-points in our data were given as the baseline brain states recorded before the stimulus. We chose a reference brain state sa as the average of this 30 baseline states.

As a next step, we assigned a filter value to each brain state as the Euclidean distance between that state and the sa. This is an idea suggested in [38] to trace the brain activation patterns during the 0-back (2-back) memory test of each participant. This method enables us to use the 2D representation of the brain dynamics by visually tracking if the brain sates return to earlier states or form new states, as displayed by loops, dead zones, and branches.

The metric and the filter together lead to the construction of the mapper graph via the next three steps indicated in the flowchart. In the first step, the brain states are binned by dividing the filter values into overlapping intervals. The number of intervals as well as overlapping percentage (i.e., parameters) is rigorously discussed in the next subsection. Two brain-states fall in the same bin if their distances from sa are similar. In the second step, each bin is clustered in a way that two brain-states are included in the same cluster if they are close to each other with respect to the Euclidean metric. This is done using the single linkage clustering, which is widely used in TDA. The third step is the construction of edges. As the bins are allowed to overlap, the clusters from different bins may share common points. The clusters share a common point are joined by an edge (see Figure 2).

To trace the brain patterns, we used an unconventional visualization of the Mapper graph. In Figure 3, each cluster corresponds to a node in the mapper graph. In this way, we can visually track the changes in brain states during the task.

The input MEG data have temporally ordered 91-brain-states. From the raw data, we know that the first 30 time-points represent the time interval before the stimulus. We then recorded the first time-point t, called return-point, during the stimulus where the brain state re-visits the beginning of the stimulus (see black line in Figure 3). In the next subsection, we show that this choice return-point was reliable across the majority of parameter variations.

As a final step, we analyzed different features of the mapper graph along with the ground truth of task performance and response time obtained from HCP database.

We used TDAmapper package in R to obtain the mapper graphs. For reading and normalizing the data, we used Fieldtrip package in MATLAB. The codes are available in the Supplementary Materials.

2.4. Parameter Selection
As explained in Section 2.2, Mapper algorithm has four parameters and, for the distance parameter, we selected the Euclidian metric. In this section, we discuss how to select the remaining parameters: the number of intervals (Int), the overlapping percentage (Ovr), and the number of bins of the clustering algorithm (Bin).

First, we defined a grid G with 18 points where Int∈{5,6,7}, Ovr∈{50,60,70}, and Bin∈{5,10}. A sample point in this grid is a triple (5,50,10) where the first component is the number of intervals, the second component is the overlapping percentage, and the third component is the number of bins. We used the notation (Int−Ovr−Bin) to represent a generic point in G.

Then, we ran the Mapper algorithm with each point in G. The resulting Mapper graphs are visualized as in Figure 4.

We recorded the time-point marking the return to the beginning of the stimulus for every subject and point in G for both memory tests. For some points in G, the subjects may not have a return point. In these cases, the mapper graphs appear as in Figure 5.

If a subject does not have a return-point for at least half of the points in G, we excluded them from the data. If a subject does not have a return-point for fewer than half of the points in G, we complete those missing return-points for that subject using the mean of the existing return-points.

To complete cleaning our data, we chose subjects common in both tests. As a result, 70 subjects were left in both tests.

The cleaned dataset has seven columns. The column Subject represents the subject number. The columns Mapper0B and Mapper2B represent the return-points obtained from the mapper graphs with the selected parameters of the 0-back and 2-back tests, respectively. The columns 0B Median Reaction and 2B Median Reaction represent the median reaction time of the subjects from the tests 0-back and 2-back, respectively. Reaction time is the time from the onset of the image to the response in milliseconds. Hence, for a subject, 0B Median Reaction is the median of the reaction times of that subject to the 0-back tasks, and similarly for the 2B Median Reaction. The columns 0BAccuracy and 2BAccuracy represent the accuracy scores of the subjects obtained from the the tests 0-back and 2-back, respectively. Accuracy is the percentage of the correctly responded tasks.

Once the dataset was cleaned, we selected the parameters for the Mapper that are highly correlated with the accuracy scores.

2.5. Statistical Analysis
For both 0-back and 2-back tests, we sketched the return-time points against the accuracy and median reaction time against the accuracy.

In our statistical analysis, we investigated whether the combined effects of return-time points and the median reaction times can enhance correlation with the accuracy scores of the subjects observed in the plots in Figure 6.

3. Results
We determined the Mapper parameters based on the strength of the correlation between the parameters and the accuracy score.

3.1. Distinguishing 0-Back and 2-Back Memory Tasks
We statistically analyzed the results along with the ground truth of response time and performance of the participants (see Figure 7 and Supplementary Materials for the complete table). The Mapper graphs for all participants are available in the Supplementary Materials.

The return-point obtained from 0-back mapper graph is significantly lower than its 2-back counterpart (p = 2 ×−10) (see Figure 8).

3.2. Predicting Task Performance
We next compared the return-points obtained from 0-back (mapper0B) and 2-back (mapper2B) graphs of each participant with the accuracy and response time data from HCP (see the Supplementary Materials for the corresponding table and detailed statistical analysis).

Using linear regression, we compared the three models for both memory tests.

Model 1: Accuracy∼MedianReactionTime; and

Model 2: Accuracy∼ReturnTime+MedianReactionTime.

In case of 0-back test, we used the Mapper data with parameters (5−60−5) as they provide the strongest correlation with accuracy (see Figure 9). We obtained the following results for each one of the above models:


Models
	
RSE
	
R squared
	
p-value
	

	
	
	
	

1
	7.374	0.3863	5.64 × 10−9	

	
	
	
	

2
	7.311	0.3968	1.65 × 10−8	
For the 2-back test, we used parameters (7−70−10) and obtained the results below.


Models
	
RSE
	
R squared
	
p-value
	

	
	
	
	

1
	9.833	0.0612	2 × 10−2	

	
	
	
	

2
	9.627	0.1	0.1	
From these results, we observed that Model 2 is the best model for both tests as it had the highest R squared value and lowest RSE and p-values. Thus, we can conclude that return-point from the Mapper graphs is a useful feature in the description of the accuracy scores. However, it is also worth mentioning that the linear models were not the best models to describe the relation between these features as the RSE values were significantly high and R square values were significantly low. In a good linear model, these values should be close to 0 and 1, respectively.

3.3. Cluster Analysis
The resulting Mapper graphs for each participant shows the time evolution of the brain states. The clusters detect the consistency brain states. The big clusters seen during the middle of the stimulus were observed for most of the participants. These clusters show the similarity in the whole brain configuration when the brain was highly engaged in the memory task. On the other hand, smaller clusters at the beginning and the end with lower engagement disclose the lower similarity in the brain configuration (see Figure 10 for examples). Another noticeable cluster is the baseline before the stimulus.

A significant variability in the Mapper graph was also observed across subjects. For example, the start and end time of apparent big clusters differ between subjects.

4. Discussion
It is important to develop new mathematical methods and computational tools in order to investigate the role of the dynamic nature of the brain in cognition. Mapper, based on topology, is one of the unconventional candidates to extract meaningful information from high spatiotemporal dimensional neuroimaging data, such fMRI, MEG and EEG. It has already proven its power in different fields by stratifying the complex datasets to identify biomarkers of viral evolution, diabetes, and preclinical spinal cord injury [25,26,27]. Using this novel tool on fMRI datasets, the behavioral dynamics of the brain was previously studied by Saggar et al. [19]. Unlike with the common techniques [39,40], the resulting graph is obtained without spatially or temporally reducing the dimension of the data; hence, it provides significant insight about the temporal changes in the whole brain.

In this study, we unraveled brain dynamics further in time via a similar methodological pipeline at single-participant level. As the temporal resolution of fMRI is a limitation for this purpose, we resorted to high temporal resolution MEG data from working memory n-task. The characteristic that makes Mapper suitable for studying the high temporal dimensional MEG dataset is its scalability. It divides the complete set into small subsets that can be run in parallel and merges at the end to obtain final graph. This makes it good candidate over slower clustering algorithms already applied in neuroimaging data: hierarchical clustering [41], spectral clustering, k-means clustering, or fuzzy clustering [42].

Our approach has several contributions to the examination of the dynamics of electrophysiological data. First, the application of our method to MEG data detected a novel neuroimaging marker that explained the performance of the participants along with the ground truth of response time. The earlier work provides evidence to the fact that using graphs obtained from electrophysiological signals (i.e., EEG and MEG), it is possible to find online markers for the relationship between dynamic neural networks and task outcomes [43]. Following the suggestion in [38], we explored the Mapper graph visualizing the dynamic evolution of the brain states during the working memory task. Even though there is no correlation between the ground truth of response time and the return-point, where the brain state in the Mapper graph comes back or close to the baseline prior to the stimulus, these two measures together better explain the high performance of the participants. Our result are also consistent with the previous electrophysiological data studies, suggesting that the relationship between working memory capacity is more strongly reflected in large-scale brain dynamics than in spatially localized activity [44].

Secondly, TDA enabled us to distinguish two task-positive brain activations during 0-back and 2-back tasks, which is hard to detect with the other pipelines that require collapsing the data in the spatial and temporal domain. We demonstrated that the return-point of 0-back tasks are significantly smaller than the return-points of 2-back task providing a novel online marker to differ 0-back and 2-back tasks. This subtle marker might not be possible to obtain with a fMRI dataset because of the low temporal resolution. Similarly, more conventional methods such as the sliding window might fail as there is loss of high temporal resolution while choosing time-course intervals during implementation of these methods. Our approach is robust to parameter perturbation unlike the other methods for which the choice of the parameters is crucial to detect the characteristics of the dynamic evolution of the brain states.

Furthermore, the Mapper graphs of the individuals reveal one large group in the middle of the stimulus, detecting the high engagement in the brain with fine temporal resolution, which could contribute to increase spatiotemporal resolution with other imaging modalities. The resulting big clusters during the stimulus indicate the similarity in the whole brain configuration during a high engagement, while the size of the clusters gets smaller at the beginning and the end of the stimulus. This is in line with the earlier study using ICA based characterization of dynamic MEG networks during a working memory task. The transiently forming and dissolving networks in different time intervals detected and characterized in [6] are compactly indicated in a Mapper graph as large and small nodes that contain brain states sharing similar temporal profiles. As suggested in [19], by combining MEG (or EEG) and fMRI datasets using Mapper may enable the investigation of the brain dynamics in the highest spatiotemporal resolution, for which other conventional methods fail. Our result support this hypothesis by finding meaningful patterns in high temporal resolution MEG data.

It is also notable that the mapper graphs are highly variable across subject. This variation across subjects has been noticed in earlier static MEG connectivity studies [45,46]. As noted in [47], these variations across subjects may be due to identifiable intrinsic processes, which are subject specific.

As a future work, one can also investigate the MEG dataset that contains different tasks such as math-story, motor and working memory. Due to the high temporal resolution of MEG, such data are very high dimensional and require high computational power to apply Mapper algorithm, unless they are collapsed on the temporal scale. Alternatively, the algorithm can be run in parallel for every interval and the overlapping clusters can be connected in the next step. Another future direction is to analyze the Mapper clusters quantitatively using graph centrality scores. In that case, we expect that the main clusters (i.e., nodes of mapper graph) during stimulus will posses high centrality scores. We can also look for a better model than linear regression to describe accuracy in terms of return points and reaction time. Finally, other TDA methods such as persistent homology might give interesting insight on the dynamic features of brain imaging data. One possible approach for studying graph representations of time series of dynamical systems is suggested in [48].

Our approach can be later used to explore mental disorders such as autism and schizophrenia where cognitive impairment is common and unrelated brain regions are expected involve during the cognition. The certain characteristics of the Mapper graphs may differ between control and patient groups; hence, it might help to find the underlying neural reason for the cognitive impairment.

5. Data Availability
The MEG data used in this study are publicly available from the Human Connectome Project (HCP) consortium: http://db.humanconnectome.org.

6. Conclusions
In summary, our work demonstrates that TDA methods can be successfully applied to extract new perception from the complex brain dynamics associated with high temporal MEG data during a cognitive task. Unlike the standard techniques, it achieves these results without the need of temporally and spatially collapsing the data. It is also robust to parameter perturbation while the parameter choice is critical in the widely used methods such as the sliding window. Finally, it provides a compact and easily readable visual presentation of the data preserving the geometric structure.

Acknowledgments
The authors would like to express their appreciation to Linda Geerligs for the valuable discussions during the planning and development of this paper. A.N.D. and H.P. acknowledge King Fahd University of Petroleum and Minerals (KFUPM) for funding this work through project No. IN171044. Part of this research was conducted during a visit of A.E.T to Donders Institute, Netherlands.

Supplementary Materials
The following are available online at https://www.mdpi.com/2076-3425/9/6/144/s1.

Click here for additional data file.

 Author Contributions
Conceptualization, A.N.D., H.P. and A.E.T.; Funding acquisition, A.N.D. and H.P.; Investigation, A.N.D., H.P. and A.E.T.; Methodology, A.N.D.; Project administration, A.N.D.; Writing—original draft, A.N.D., H.P. and A.E.T.; Writing—review and editing, A.N.D., H.P. and A.E.T.

Funding
This research is funded by King Fahd University of Petroleum and Minerals (KFUPM) through project No. IN171044.

Conflicts of Interest
The authors declare no conflicts of interest.

Figure 1 Flowchart illustrating the steps used to construct the Mapper graph from magnetoencephalography (MEG) dataset.

Figure 2 The Mapper graph of subject No.156334 illustrating the clusters of the 91 time-points during the 0-back memory test. The size of the nodes are directly proportional to the number of time-points they contain.

Figure 3 Unconventional Mapper graph of subject No. 156334 with 97% accuracy in 0-back memory test. The graph shows the members (i.e., time-points) of the each node in the Mapper graph. The black straight line indicates the first time-point t=63 during the stimulus that returns to the beginning of the stimulus.

Figure 4 Mapper graphs of subject No. 175237 during the 0-back memory test. The graph on the left was obtained using parameters (5,50,10) and the one on the right with the parameters (7,70,5). The return to the beginning of the stimulus was at the time-point t=79 for the graph on the left and at t=83 for the graph on the right.

Figure 5 Subjects No. 353740 (left) and No. 917255 (right) without a return-point.

Figure 6 The blue lines represent the regression lines for the return point in the mapper graph 0-Back vs. accuracy in 0-back(upper left), the return point in the mapper graph 2-Back vs. accuracy in 2-back (lower left), accuracy in 0-back vs reaction-time in 0-back (upper right) and accuracy in 0-back vs reaction-time in 0-back (lower right). They all have negative slopes, meaning that both return-time points and median reaction times are negatively correlated with the accuracy.

Figure 7 A snapshot of the cleaned dataset showing the first 10 subjects.

Figure 8 The box plots of the return-points obtained from 0-back and 2-back mapper graphs. 0-back values are significantly lower than 2-back values. These box plots were obtained using the return-points from the parameters (7−70−10) as it had the most significant correlation score of −0.20065 (see Figure 9).

Figure 9 The table shows correlation scores between accuracy scores of each test and the points in G. We also recorded the column wise mean of the correlation scores as we selected the coefficient when we compared the two types of the memory test based on this mean. It is also worth noting that the scores on the table are consistent with the scatter plots in Figure 6.

Figure 10 Mapper graph of subject No. 1125525 (left) during the 2-back memory test on the left. Mapper graph of subject No. 149741 (right) during the 0-back memory test on the right. The big clusters in the middle of stimulation where subjects were highly engaged indicate the higher consistency between brain activity patterns. The smaller clusters at the beginning and the end of the stimulus where the subjects’ engagement was lower indicate low consistency.
==== Refs
References
1. Fallani F.D.V.  Astolfi L.  Cincotti F.  Mattia D.  Marciani M.G.  Salinari S.  Kurths J.  Gao S.  Cichocki A.  Colosimo A.    Cortical functional connectivity networks in normal and spinal cord injured patients: Evaluation by graph analysis Hum. Brain Mapp. 2007 28 1334 1346 10.1002/hbm.20353 17315225 
2. Meunier D.  Achard S.  Morcom A.  Bullmore E.   Age-related changes in modular organization of human brain functional networks NeuroImage 2009 44 715 723 10.1016/j.neuroimage.2008.09.062 19027073 
3. Stam C.  Jones B.  Scheltens P.  Nolte G.  Breakspear M.   Small-World Networks and Functional Connectivity in Alzheimer’s Disease Cereb. Cortex 2006 17 92 99 10.1093/cercor/bhj127 16452642 
4. Bastos A.M.  Schoffelen J.M.   A Tutorial Review of Functional Connectivity Analysis Methods and Their Interpretational Pitfalls Front. Syst. Neurosci. 2016 9 175 10.3389/fnsys.2015.00175 26778976 
5. Friston K.J.   Functional and Effective Connectivity: A Review Brain Connect. 2011 1 13 36 10.1089/brain.2011.0008 22432952 
6. O’Neill G.C.  Barratt E.L.  Hunt B.A.E.  Tewarie P.K.  Brookes M.J.   Measuring electrophysiological connectivity by power envelope correlation: A technical review on MEG methods Phys. Med. Biol. 2015 60 R271 R295 10.1088/0031-9155/60/21/R271 26447925 
7. Bassett D.S.  Wymbs N.F.  Porter M.A.  Mucha P.J.  Carlson J.M.  Grafton S.T.   Dynamic reconfiguration of human brain networks during learning Proc. Natl. Acad. Sci. USA 2011 108 7641 7646 10.1073/pnas.1018985108 21502525 
8. Fedorenko E.  Thompson-Schill S.L.   Reworking the language network Trends Cogn. Sci. 2014 18 120 126 10.1016/j.tics.2013.12.006 24440115 
9. Chang C.  Glover G.H.   Time–frequency dynamics of resting-state brain connectivity measured with fMRI NeuroImage 2010 50 81 98 10.1016/j.neuroimage.2009.12.011 20006716 
10. Handwerker D.A.  Roopchansingh V.  Gonzalez-Castillo J.  Bandettini P.A.   Periodic changes in fMRI connectivity NeuroImage 2012 63 1712 1719 10.1016/j.neuroimage.2012.06.078 22796990 
11. Tagliazucchi E.  Von Wegner F.  Morzelewski A.  Brodbeck V.  Laufs H.   Dynamic BOLD functional connectivity in humans and its electrophysiological correlates Front. Hum. Neurosci. 2012 6 339 10.3389/fnhum.2012.00339 23293596 
12. O’Neill G.C.  Tewarie P.  Vidaurre D.  Liuzzi L.  Woolrich M.W.  Brookes M.J.   Dynamics of large-scale electrophysiological networks: A technical review NeuroImage 2018 180 559 576 10.1016/j.neuroimage.2017.10.003 28988134 
13. Brovelli A.  Badier J.M.  Bonini F.  Bartolomei F.  Coulon O.  Auzias G.   Dynamic Reconfiguration of Visuomotor-Related Functional Connectivity Networks J. Neurosci. 2017 37 839 853 10.1523/JNEUROSCI.1672-16.2016 28123020 
14. Carbo E.W.S.  Hillebrand A.  van Dellen E.  Tewarie P.  de Witt Hamer P.C.  Baayen J.C.  Klein M.  Geurts J.J.G.  Reijneveld J.C.  Stam C.J.    Dynamic hub load predicts cognitive decline after resective neurosurgery Sci. Rep. 2017 7 42117 10.1038/srep42117 28169349 
15. Lee H.  Noh G.J.  Joo P.  Choi B.M.  Silverstein B.H.  Kim M.  Wang J.  Jung W.S.  Kim S.   Diversity of functional connectivity patterns is reduced in propofol-induced unconsciousness Hum. Brain Mapp. 2017 38 4980 4995 10.1002/hbm.23708 28670685 
16. Vidaurre D.  Hunt L.T.  Quinn A.J.  Hunt B.A.E.  Brookes M.J.  Nobre A.C.  Woolrich M.W.   Spontaneous cortical activity transiently organises into frequency specific phase-coupling networks Nat. Commun. 2018 9 2987 10.1038/s41467-018-05316-z 30061566 
17. Vidaurre D.  Quinn A.J.  Baker A.P.  Dupret D.  Tejero-Cantero A.  Woolrich M.W.   Spectrally resolved fast transient brain states in electrophysiological data NeuroImage 2016 126 81 95 10.1016/j.neuroimage.2015.11.047 26631815 
18. Lackner C.L.  Marshall W.J.  Santesso D.L.  Dywan J.  Wade T.  Segalowitz S.J.   Adolescent anxiety and aggression can be differentially predicted by electrocortical phase reset variables Brain Cogn. 2014 89 90 98 10.1016/j.bandc.2013.10.004 24220095 
19. Saggar M.  Sporns O.  Gonzalez-Castillo J.  Bandettini P.A.  Carlsson G.  Glover G.  Reiss A.L.   Towards a new approach to reveal dynamical organization of the brain using topological data analysis Nat. Commun. 2018 9 1399 10.1038/s41467-018-03664-4 29643350 
20. Giusti C.  Pastalkova E.  Curto C.  Itskov V.   Clique topology reveals intrinsic geometric structure in neural correlations Proc. Natl. Acad. Sci. USA 2015 112 13455 10.1073/pnas.1506407112 26487684 
21. Dabaghian Y.  Mémoli F.  Frank L.  Carlsson G.   A Topological Paradigm for Hippocampal Spatial Map Formation Using Persistent Homology PLoS Comput. Biol. 2012 8 e1002581 10.1371/journal.pcbi.1002581 22912564 
22. Stolz B.   Computational Topology in Neuroscience University of Oxford Oxford, UK 2014 
23. Calhoun V.D.  Eichele T.  Adalı T.  Allen E.A.   Decomposing the brain: Components and modes, networks and nodes Trends Cogn. Sci. 2012 16 255 256 10.1016/j.tics.2012.03.008 22487186 
24. Fair D.A.  Bathula D.  Nikolas M.A.  Nigg J.T.   Distinct neuropsychological subgroups in typically developing youth inform heterogeneity in children with ADHD Proc. Natl. Acad. Sci. USA 2012 109 6769 6774 10.1073/pnas.1115365109 22474392 
25. Chan J.M.  Carlsson G.  Rabadan R.   Topology of viral evolution Proc. Natl. Acad. Sci. USA 2013 110 18566 18571 10.1073/pnas.1313480110 24170857 
26. Nielson J.L.  Paquette J.  Liu A.W.  Guandique C.F.  Tovar C.A.  Inoue T.  Irvine K.A.  Gensel J.C.  Kloke J.  Petrossian T.C.    Topological data analysis for discovery in preclinical spinal cord injury and traumatic brain injury Nat. Commun. 2015 6 8581 10.1038/ncomms9581 26466022 
27. Li L.  Cheng W.Y.  Glicksberg B.S.  Gottesman O.  Tamler R.  Chen R.  Bottinger E.P.  Dudley J.T.   Identification of type 2 diabetes subgroups through topological analysis of patient similarity Sci. Transl. Med. 2015 7 311ra174 10.1126/scitranslmed.aaa9364 
28. Romano D.  Nicolau M.  Quintin E.M.  Mazaika P.K.  Lightbody A.A.  Cody Hazlett H.  Piven J.  Carlsson G.  Reiss A.L.   Topological methods reveal high and low functioning neuro-phenotypes within fragile X syndrome Hum. Brain Mapp. 2014 35 4904 4915 10.1002/hbm.22521 24737721 
29. Nielson J.L.  Cooper S.R.  Yue J.K.  Sorani M.D.  Inoue T.  Yuh E.L.  Mukherjee P.  Petrossian T.C.  Paquette J.  Lum P.Y.    Uncovering precision phenotype-biomarker associations in traumatic brain injury using topological data analysis PLoS ONE 2017 12 e0169490 10.1371/journal.pone.0169490 28257413 
30. Kyeong S.  Kim J.J.  Kim E.   Novel subgroups of attention-deficit/hyperactivity disorder identified by topological data analysis and their functional network modular organizations PLoS ONE 2017 12 e0182603 10.1371/journal.pone.0182603 28829775 
31. Allen E.A.  Damaraju E.  Plis S.M.  Erhardt E.B.  Eichele T.  Calhoun V.D.   Tracking Whole-Brain Connectivity Dynamics in the Resting State Cereb. Cortex 2012 24 663 676 10.1093/cercor/bhs352 23146964 
32. Larson-Prior L.  Oostenveld R.  Della Penna S.  Michalareas G.  Prior F.  Babajani-Feremi A.  Schoffelen J.  Marzetti L.  de Pasquale F.  Di Pompeo F.    Adding dynamics to the Human Connectome Project with MEG NeuroImage 2013 80 190 201 10.1016/j.neuroimage.2013.05.056 23702419 
33. Thomas Yeo B.T.  Krienen F.M.  Sepulcre J.  Sabuncu M.R.  Lashkari D.  Hollinshead M.  Roffman J.L.  Smoller J.W.  Zöllei L.  Polimeni J.R.    The organization of the human cerebral cortex estimated by intrinsic functional connectivity J. Neurophysiol. 2011 106 1125 1165 10.1152/jn.00338.2011 21653723 
34. Carlsson G.   Topological pattern recognition for point cloud data Acta Numer. 2014 23 289 368 10.1017/S0962492914000051 
35. Lum P.Y.  Singh G.  Lehman A.  Ishkanov T.  Vejdemo-Johansson M.  Alagappan M.  Carlsson J.  Carlsson G.   Extracting insights from the shape of complex data using topology Sci. Rep. 2013 3 1236 10.1038/srep01236 23393618 
36. Singh G.  Mémoli F.  Carlsson G.E.   Topological Methods for the Analysis of High Dimensional Data Sets and 3D Object Recognition SPBG Zurich, Switzerland 2007 
37. Bray S.  Chang C.  Hoeft F.   Applications of multivariate pattern classification analyses in developmental neuroimaging of healthy and clinical populations Front. Hum. Neurosci. 2009 3 32 10.3389/neuro.09.032.2009 19893761 
38. Khambhati A.N.  Sizemore A.E.  Betzel R.F.  Bassett D.S.   Modeling and interpreting mesoscale network dynamics NeuroImage 2018 180 337 349 10.1016/j.neuroimage.2017.06.029 28645844 
39. Preti M.G.  Bolton T.A.  Ville D.V.D.   The dynamic functional connectome: State-of-the-art and perspectives NeuroImage 2017 160 41 54 10.1016/j.neuroimage.2016.12.061 28034766 
40. Gonzalez-Castillo J.  Bandettini P.A.   Task-based dynamic functional connectivity: Recent findings and open questions NeuroImage 2018 180 526 533 10.1016/j.neuroimage.2017.08.006 28780401 
41. Cordes D.  Haughton V.  Carew J.D.  Arfanakis K.  Maravilla K.   Hierarchical clustering to measure connectivity in fMRI resting-state data Magn. Reson. Imaging 2002 20 305 317 10.1016/S0730-725X(02)00503-9 12165349 
42. Fadili M.J.  Ruan S.  Bloyet D.  Mazoyer B.   A multistep Unsupervised Fuzzy Clustering Analysis of fMRI time series Hum. Brain Mapp. 2000 10 160 178 10.1002/1097-0193(200008)10:4<160::AID-HBM20>3.0.CO;2-U 10949054 
43. Miraglia F.  Vecchio F.  Lacidogna G.  Ferreri F.  Rossini P.M.   Pre-stimulus interhemispheric coupling of brain rhythms predicts cognitive-motor performance in healthy humans Clin. Neurophysiol. 2015 126 e2 e3 10.1016/j.clinph.2014.10.027 
44. Gulbinaite R.  van Rijn H.  Cohen M.X.   Fronto-parietal network oscillations reveal relationship between working memory capacity and cognitive control Front. Hum. Neurosci. 2014 8 761 10.3389/fnhum.2014.00761 25324759 
45. Colclough G.L.  Woolrich M.W.  Tewarie P.K.  Brookes M.J.  Quinn A.J.  Smith S.M.   How reliable are MEG resting-state connectivity metrics? NeuroImage 2016 138 284 293 10.1016/j.neuroimage.2016.05.070 27262239 
46. Tewarie P.  Bright M.G.  Hillebrand A.  Robson S.E.  Gascoyne L.E.  Morris P.G.  Meier J.  Van Mieghem P.  Brookes M.J.   Predicting haemodynamic networks using electrophysiology: The role of non-linear and cross-frequency interactions NeuroImage 2016 130 273 292 10.1016/j.neuroimage.2016.01.053 26827811 
47. Finn E.S.  Shen X.  Scheinost D.  Rosenberg M.D.  Huang J.  Chun M.M.  Papademetris X.  Constable R.T.   Functional connectome fingerprinting: Identifying individuals using patterns of brain connectivity Nat. Neurosci. 2015 18 1664 10.1038/nn.4135 26457551 
48. Myers A.  Munch E.  Khasawneh F.A.   Persistent Homology of Complex Networks for Dynamic State Detection arXiv 2019 1904.07403v1

