
==== Front
Neuroimage
Neuroimage
Neuroimage
1053-8119
1095-9572
Academic Press

S1053-8119(22)00135-5
10.1016/j.neuroimage.2022.119006
119006
Article
MEG cortical microstates: Spatiotemporal characteristics, dynamic functional connectivity and stimulus-evoked responses
Tait Luke l.tait@bham.ac.uk
⁎ab
Zhang Jiaxiang b
a Centre for Systems Modelling & Quantitative Biomedicine (SMQB), University of Birmingham, Birmingham, UK
b Cardiff University Brain Research Imaging Centre, Cardiff, UK
⁎ Corresponding author at: Centre for Systems Modelling & Quantitative Biomedicine (SMQB), University of Birmingham, Birmingham, UK. l.tait@bham.ac.uk
01 5 2022
01 5 2022
251 11900627 9 2021
29 1 2022
14 2 2022
© 2022 The Authors. Published by Elsevier Inc.
2022

https://creativecommons.org/licenses/by/4.0/ This is an open access article under the CC BY license (http://creativecommons.org/licenses/by/4.0/).
Highlights

• EEG microstate analysis is a method to study brain states in health and disease.

• We present a source-space microstate pipeline, giving additional anatomical insight.

• Simulations validate source-space microstates.

• We identify 10 resting microstates and their patterns of functional connectivity.

• Microstate activation likelihoods change in response to auditory stimulus.

EEG microstate analysis is an approach to study brain states and their fast transitions in healthy cognition and disease. A key limitation of conventional microstate analysis is that it must be performed at the sensor level, and therefore gives limited anatomical insight. Here, we generalise the microstate methodology to be applicable to source-reconstructed electrophysiological data. Using simulations of a neural-mass network model, we first established the validity and robustness of the proposed method. Using MEG resting-state data, we uncovered ten microstates with distinct spatial distributions of cortical activation. Multivariate pattern analysis demonstrated that source-level microstates were associated with distinct functional connectivity patterns. We further demonstrated that the occurrence probability of MEG microstates were altered by auditory stimuli, exhibiting a hyperactivity of the microstate including the auditory cortex. Our results support the use of source-level microstates as a method for investigating brain dynamic activity and connectivity at the millisecond scale.
==== Body
pmc1 Introduction

Whole-brain, non-invasive functional neuroimaging of the human brain is a useful tool for uncovering the mechanisms underpinning cognitive functions and neurological disease (Babiloni, Lizio, Marzano, Capotosto, Soricelli, Triggiani, Cordone, Gesualdo, Del Percio, 2016, Cohen, 2018, Douw, Schoonheim, Landi, van der, Geurts, Reijneveld, Klein, Stam, 2011, Lee, Moser, Ing, Doucet, Frangou, 2019, Michel, Koenig, 2018, van den Heuvel, Hulshoff Pol, 2010). In recent years, there has been much evidence that even at rest the activity of the human brain is highly dynamic, transitioning between a small number of functional brain-states with specific patterns of activation or synchrony across the cortex (Baker, Brookes, Smith, Behrens, Smith, Woolrich, 2014, Khanna, Pascual-Leone, Michel, Farzan, 2015, Michel, Koenig, 2018, O’Neill, Tewarie, Vidaurre, Liuzzi, Woolrich, Brookes, 2018, Smith, Fox, Miller, Glahn, Fox, Mackay, Filippini, Watkins, Toro, Laird, Beckmann, 2009, Taghia, Cai, Ryali, Kockalka, Nicholas, Chen, Vinod, 2018, Vidaurre, Hunt, Quinn, Hunt, Brooked, Nobre, Woolrich, 2018). These functional brain states have been associated with a range of cognitive domains and levels of consciousness (Britz, Hernàndez, Ro, Michel, 2014, Brodbeck, Kuhn, von Wegner, Morzelewski, Tagliazucchi, Borisov, Michel, Laufs, 2012, Liégeois, Li, Kong, Orban, Van De Ville, Ge, Sabuncu, Yeo, 2019, Milz, Faber, Lehmann, Koenig, Kochi, Pascual-Marqui, 2016, Seitzman, Abell, Bartley, Erickson, Bolbecker, Hetrick, 2017, Smith, Fox, Miller, Glahn, Fox, Mackay, Filippini, Watkins, Toro, Laird, Beckmann, 2009, Zappasodi, Perrucci, Saggino, Croce, Mercuri, Romanelli, Colom, Ebisch, 2019, Zhou, Zhang, Feng, Zac Lo, 2019), demonstrating that more advanced insight into the non-stationarity of brain stats and their dynamics may be crucial to understanding cognition and disease.

In functional MRI (fMRI) data, techniques to study functional brain-states have included independent component analysis (ICA) (Beckmann, DeLuca, Devlin, Smith, 2005, Smith, Fox, Miller, Glahn, Fox, Mackay, Filippini, Watkins, Toro, Laird, Beckmann, 2009) and sliding-window analysis (Allen et al., 2014), uncovering a small number of reproducible networks known as resting-state networks (RSNs) (Smith et al., 2009). Temporal resolution of fMRI is limited by the slow dynamics of the haemodynamic response function, meaning transitions between states on a sub-second scale are likely to be missed. ICA has also been used in EEG and MEG to recreate fMRI-RSNs (Brookes, Woolrich, Luckhoo, Price, Hale, Stephenson, Barnes, Smith, Morris, 2011, Liu, Farahibozorg, Porcaro, Wenderoth, Mantini, 2017), but to do so this is typically performed on a slower time scale matching those of fMRI through analysis of downsampled power envelopes, losing the high temporal resolution and oscillatory phase information gained from the use of EEG/MEG. It follows that alternative methods are required to uncover faster time-scale (on the order of milliseconds) dynamics in EEG/MEG data (O’Neill et al., 2018), and it is currently unclear the extent to which spatiotemporal properties of millisecond scale non-stationarity reflect those of slower RSNs.

Other methods for EEG/MEG analyses are available to examine to rapid changes in brain-state. One is to apply sliding window analysis to the EEG/MEG time courses (Brookes, O’Neill, Hall, Woolrich, Baker, Corner, Robson, Morris, Barnes, 2014, de Pasquale, Della Penna, Snyder, Lewis, Mantini, Marzetti, Belarinelli, Ciancetta, Pizzella, Romani, Corbetta, 2010, de Pasquale, Della Penna, Sporns, Romani, Corbetta, 2016, Lopes, Zhang, Krzemiński, Hamandi, Chen, Livi, Masuda, 2020, O’Neill, Bauer, Woolrich, Morris, Barnes, Brookes, 2015) and subsequently cluster functional networks across windows (Allen, Damaraju, Plis, Erhardt, Eichele, Calhoun, 2014, Hassan, Benquet, Biraben, Berrou, Dufor, Wendling, 2015, Mheich, Hassan, Khalil, Berrou, Wendling, 2015, O’Neill, Bauer, Woolrich, Morris, Barnes, Brookes, 2015). This approach has the limitation of the need for an arbitrary a priori selected window size: too short windows lead to results susceptible to noise, while too large windows result in non-stationarity at fast time scales being missed (O’Neill et al., 2018). Indeed, there is no consensus on optimal sliding window length and the literature has covered a wide range, from 25ms to 30s (O’Neill et al., 2018). A number of alternative approaches to sliding windows exist (O’Neill et al., 2018), including Hidden Markov Models (HMMs) (Baker, Brookes, Smith, Behrens, Smith, Woolrich, 2014, Vidaurre, Hunt, Quinn, Hunt, Brooked, Nobre, Woolrich, 2018). HMMs rely on assumptions about the underlying process of state transitions, both in a detailed generative model and Markovian transitioning between states. It is unclear whether these assumptions are always met by spontaneous transitions between brain states (Gschwind et al., 2015).

Another alternative approach to study dynamics of functional brain-states, the focus of the current study, is microstate analysis (Khanna, Pascual-Leone, Farzan, 2014, Michel, Koenig, 2018). Conventional EEG microstate analysis involves clustering the sensor-space spatial topographies using algorithms such as k-means or hierarchical clustering (Khanna, Pascual-Leone, Michel, Farzan, 2015, von Wegner, Knaut, Laufs, 2018). Microstate analysis therefore does not require an arbitrarily chosen window length, and has minimal assumptions about the underlying generative process. Resting-state EEG microstates are robust and highly reproducible (Michel and Koenig, 2018), and have been associated with fMRI resting-state networks (Abreu, Jorge, Leal, Koenig, Figueiredo, 2020, Britz, Van De Ville, Michel, 2010, Musso, Brinkmeyer, Mobascher, Warbrick, Winterer, 2010, Schumacher, Peraza, Firbank, Thomas, Kaiser, Gallagher, O’Brien, Blamire, Taylor, 2019, Xu, Pan, Zhou, Zou, Liu, Su, Zou, Gao, 2020, Yuan, Zotev, Phillpis, Drevets, Bodurka, 2012, Zoubi, Misaki, Tsuchiyagaito, Mayeli, Zotev, Investigators, Refai, Paulus, Bodurka, 2020) and cognitive domains (Britz, Hernàndez, Ro, Michel, 2014, Brodbeck, Kuhn, von Wegner, Morzelewski, Tagliazucchi, Borisov, Michel, Laufs, 2012, Milz, Faber, Lehmann, Koenig, Kochi, Pascual-Marqui, 2016, Seitzman, Abell, Bartley, Erickson, Bolbecker, Hetrick, 2017, Zappasodi, Perrucci, Saggino, Croce, Mercuri, Romanelli, Colom, Ebisch, 2019), earning EEG microstates the nickname the ‘atoms of thought’ (Lehmann, 1990). EEG microstates have also been demonstrated to be a potentially useful clinical tool for understanding and diagnosing neurological diseases such as Alzheimer’s disease and other dementias (Musaeus, Nielsen, Høgh, 2019, Nishida, Morishima, Yoshimura, Isotani, Irisawa, Jann, Dierks, Strik, Kinoshita, Koenig, 2013, Schumacher, Peraza, Firbank, Thomas, Kaiser, Gallagher, O’Brien, Blamire, Taylor, 2019, Smailovic, Koenig, Laukka, Kalpouzos, Andersson, Winblad, Jelic, 2019, Tait, Tamagnini, Stothart, Barvas, Monaldini, Frusciante, Volpini, Guttmann, Coulthard, Brown, Kazanina, Goodfellow, 2020), schizophrenia (Andreou, Faber, Leicht, Schoettle, Polomac, Hanganu-Opatz, Lehmann, Mulert, 2014, Lehmann, Faber, Galderisi, Herrmann, Kinoshita, Koukkou, Mucci, Pascual-Marqui, Saito, Wackermann, Winterer, Koenig, 2005, Tomescu, Rihs, Becker, Britz, Custo, Grouiller, Schneider, Debbané, Eliez, Michel, 2014), and a range of other disorders (Khanna et al., 2014).

However, a key limitation of sensor-space microstate analysis is anatomical interpretation. A number studies have attempted to reconstruct the electrophysiological sources underpinning microstates maps by combining sensor-space microstate analysis with subsequent source reconstruction (Custo, Van De Ville, Wells, Tomescu, Brunet, Michel, 2017, Custo, Vulliemoz, Grouiller, Van De Ville, Michel, 2014, Milz, Faber, Lehmann, Koenig, Kochi, Pascual-Marqui, 2016, Milz, Pascual-Marqui, Achermann, Kochi, Faber, 2017, Pascual-Marqui, Legmann, Faber, Milz, Kochi, Yoshimura, Nishida, Isotani, Kinoshita, 2014, Tait, Tamagnini, Stothart, Barvas, Monaldini, Frusciante, Volpini, Guttmann, Coulthard, Brown, Kazanina, Goodfellow, 2020). However, this approach may be limiting insight into functional brain states for a number of reasons. Firstly, since the inverse problem is not unique, it is possible that different spatial patterns of brain activation may give rise to similar topographical maps, and therefore each sensor-level microstate may be associated with more than one active network. Secondly, due to the spatial blurring in EEG as a result of volume conduction through tissues of different conductivities, EEG microstate topographies have low spatial resolution and potentially cannot differentiate between finer differences between maps; indeed, EEG microstate topographies are reliable with as few as eight electrodes (Khanna et al., 2014), suggesting the topographies do not contain much spatial detail. Finally, since alpha band occipital sources dominate the sensor-space eyes-closed resting-state EEG (Kropotov, 2009) likely due to head shape and the forward model resulting in high signal-to-noise ratio for these regions (Goldenholz et al., 2009), it is likely that these same sources predominantly determine the microstate topographies (Milz et al., 2017), therefore suggesting the sensor-space EEG microstate maps may be under-weighting the importance of non-occipital or non-alpha-band networks.

Instead of performing microstate analysis in sensor space and then subsequently projecting to source space, here we propose first projecting M/EEG data to source space and subsequently clustering the source dynamics. Unfortunately, some steps of the EEG microstate pipeline means it is not directly applicable to source-reconstructed recordings, such as relying the requirement to re-reference to average and being unable to account (at the group level) for arbitrary source flipping. Here we adapt methodology and study microstates in MEG source space at rest and during task. We hypothesise that each microstate is associated with distinct patterns of functional connectivity across the cortex and use machine learning to test this hypothesis. Finally, we demonstrate that source-space microstate features are dependent of cognitive state and examine the microstate response to auditory stimuli.

2 Methods

2.1 A source-space microstate pipeline

The source-space microstate segmentation pipeline used here is based upon the widely used EEG sensor-space k-means pipeline presented by Pascual-Marqui et al. (1995), Koenig et al. (1999), and is outlined in Table 1.Table 1 The microstate pipeline, generalized for different recording modalities. Details and justification of these steps are given in Section 2.1.

Table 1	Algorithm: Source-space microstate pipeline	
1	Source reconstruct sensor data, band-pass filter, and parcellate	
2	Extract activity patterns (maps) at GFP peaks	
3	Run k-means clustering on transformed (absolute value) maps.	
4	Backfit cluster centroids to data	
5	Calculate microstate statistics.	

However, there are a number of steps in the sensor-EEG microstate pipeline which limit application to source-space data. One such limitation is the requirement to re-reference to average; while the EEG data itself does not necessarily have to be referenced to average, the pipeline relies on metrics such as standard deviation of the signal across sensors (global-field power, GFP) and correlation between spatial topographies, both of which involve subtracting the mean of the map (i.e. common average re-referencing). The pipeline presented here is modified, treating a topographic map x∈RN×1 (where N is the number of ROIs) as an N-dimensional vector and representing GFP, σ(t), as the length (i.e. vector norm) of the vector:(1) σ(t)=1N−1∥x(t)∥=1N−1∑n=1Nxn(t)2

and map similarity of two maps x and y as the cosine of the angle between the vectors:(2) R(x,y)=cosθ(x,y)=xT·yxT·xyT·y.

These metrics are equivalent to standard deviation and correlation respectively in the case of zero mean data, and hence the methodology presented here is a generalization of the sensor-EEG pipeline which may be used on reference-free data such as source data or sensor MEG, while exactly preserving the EEG-microstate pipeline is under the requirement that data is first re-referenced to common average.

A second issue for source reconstructed data is that of source flipping. At the voxel level, any dipole can arbitrarily be ‘flipped’ by changing the sign of both the dipole orientation and time course. While in this study we work on the level of ROIs as opposed to individual dipoles, if parcellation is performed via a single voxel with maximal variance dipole flipping is still an issue. Another common method of parcellation (used in this study) is to take the first principal component of all dipoles within an ROI, in which case the sign of both the time course and spatial topography of the first principal component may be flipped to obtain an identical result. This source flipping is not problematic for analysis of a single M/EEG scan, but for group level analyses different participants may have different spatial patterns of source flipping. For N ROIs, source flipping can result in 2N−1 possible combinations. For 230 ROIs, used in this study, source flipping could result in a number of possible topographies of the order 1068 for a single microstate. Therefore applying traditional EEG microstate analysis to source signals may result in an overestimate of the true number of clusters in group level analysis. To confound this issue, one may use either the amplitude envelope or take the (element-wise) absolute value of the samples. The former requires a narrow band signal and rejects phase information, while the latter can be applied to broadband data and mostly maintains phase information (excluding phase differences of π). Recent work has highlighted that phase information is likely crucial for encoding microstate sequences (von Wegner et al., 2021). For these reasons, and based on the results of simulations (Section 3.1), throughout this manuscript we use the absolute value of source estimates during clustering and map fitting.

A description of the source microstate pipeline are given in the following sections. While these sections give an overview the source-space pipeline, mathematical details and a generalized description of the pipeline for different modalities based appropriate modality-specific spatial transformation of the data (e.g. re-reference to average for sensor-EEG, in which case the traditional sensor-EEG microstate pipeline is recovered exactly) are given in Supplementary Text S1.

2.1.1 Source-reconstruction and parcellation

The aim of this manuscript is to present a pipeline for source-spaced M/EEG microstate analysis. The first step of the pipeline is therefore source reconstruction of the M/EEG data. A range of methodologies for source reconstruction are currently available and the choice of methodology chosen should be data specific (Tait et al., 2021). Here, eLORETA (Pascual-Marqui, Pascual-Marqui, 2009) was used for source-reconstruction. Full details of the pipeline for source-reconstruction in this study are given in Section 2.5.3. Since distributed source reconstruction methodologies typically reconstruct a large number of dipoles (several thousand), a key step following source reconstruction is spatial downsampling to increase tractability for spatial clustering. This was done through parcellation of source time courses into regions of interest. Here, the HCP230 atlas (Tait et al., 2021), a version of the Human Connectome Project’s multimodal parcellation (Glasser et al., 2016) optimized for resting-state MEG, was chosen to reduce the source data from approximately 10,000 voxels to 230 ROI time courses. Source-reconstructed data was band-pass filtered 1–30 Hz in line with sensor-EEG microstate studies (Michel and Koenig, 2018).

2.1.2 Extraction of GFP peaks

Subsequently, samples with optimal signal-to-noise ratio (SNR) and topographic stability were chosen for clustering. These samples correspond to those with peaks in the global field power (GFP) (Supplementary Figure S4; Michel et al., 2009; Koenig and Brandeis, 2016). In sensor-EEG microstate analysis, the GFP at a time sample t is defined as the standard deviation of the electric potential across sensors. For source-reconstructed data, the GFP is given by the vector norm of the signal across ROIs and hence is the total deviation from zero current source density (which is equivalent to the standard deviation in the case of zero mean).

Due to the 1–30 Hz bandpass fitler, the GFP time course is temporally smooth, and hence local maxima of the GFP (i.e. GFP peaks) can be found using a peak-finding algorithm. Here, Matlab’s findpeaks function was used to identify GFP peaks.

For group level analysis in this study, we randomly sampled and concatenated 5000 GFP peaks per participant. For each condition (rest/task), two MEG scans were available for each participant (n=30) recorded on different dates (see Section 2.5), and here we only extracted the 5000 GFP peaks from the first scan (allowing the second scan to be used for validation purposes). Hence, across participants we extracted 150,000 GFP peaks. Spatial maps at each GFP peak were submitted for k-means clustering.

2.1.3 k-means clustering

The next step of the pipeline is to cluster the submitted maps. For a given number of states, k, the algorithm for k-means clustering is outlined in Table 2, while a clear graphical representation is given in Koenig et al. (1999), Michel et al. (2009).Table 2 Outline of the k-means algorithm.

Table 2	Algorithm: k-means clustering	
1	Select k maps as initial centroids	
	While not converged:	
2	 Calculate distance between maps and centroids	
3	 Cluster each map based on nearest centroid	
4	 Calculate new centroids from all maps in cluster	
5	 Test for convergence (no change in clusters)	
	end while	

Firstly, k maps are chosen as the initial cluster centroids. Here, the k-means++ algorithm was used for selection of initial maps (Arthur and Vassilvitskii, 2007). In the k-means algorithm, the distance between each submitted map and each centroid is calculated using the cosine distance. In the case of zero mean (e.g. such as average re-referenced EEG instead of source data), the cosine distance is equal to one minus correlation, which is the metric used in the sensor-EEG k-means algorithm. Each map is subsequently labelled as belonging to the state with the closest centroid. In sensor-EEG, new cluster centroids are calculated as the first principal component of all maps within the cluster (Pascual-Marqui et al., 1995). In source-space, new cluster centroids are calculated as the eigenvector corresponding to the largest eigenvalue of the matrix Yj·YjT, where rows of the matrix Yj are the maps within cluster j. This eigenvector is equal to the first principal component in the case of zero mean. Using the new centroids, the procedure of calculating cluster labels and updating cluster centroids is iterated until convergence is reached. Due to random initial seeding, the k-means algorithm was repeated 20 times and the repetition with highest global explained variance (GEV) (Murray et al., 2008) was chosen for further analysis (Koenig et al., 1999).

The choice of number of states k is a free parameter. In this study, we used the kneedle algorithm (Satopää et al., 2011) to determine the optimum number of states. As the number of clusters k increases, so does the GEV. However, increasing k above the true number of states will only give marginal increases to GEV, and therefore the plot of GEV vs k has a characteristic ‘knee’ shape. The kneedle algorithm aims to find the number of clusters in the dataset by finding the value of k for which this knee occurs.

2.1.4 Backfitting to source time courses

After identifying the microstate maps from the sample of 150,000 GFP peaks, each sample of the full scan was assigned a microstate label. This backfitting was performed using previously described methods (Koenig, Lehmann, Merlo, Kochi, Hell, Koukkou, 1999, Michel, Koenig, Brandeis, 2009). Each GFP peak in the full dataset was labelled as a state based on the microstate centroid map with minimum distance. All other samples were given the same state label as their nearest GFP peak.

For each condition (rest/task), the microstate maps were extracted only from the first MEG scan, but were backfit to both scans to provide validation of microstate statistics across recording sesisons.

2.2 Microstate statistics

We studied a number of spatiotemporal statistics of the resulting source MEG microstate sequences. Global statistics of the microstate sequences include GEV (Murray et al., 2008), mean duration of microstates (Koenig et al., 2002), Hurst exponent of the sequences (Van De Ville et al., 2010), and microstate complexity (Tait et al., 2020). Microstate complexity values were normalized against its theoretical asymptotic upper bound (Lempel, Ziv, 1976, Xiaoku, Chunlai, Zheng, Yi, Xiaoming, Qi, Wencheng, Xia, Jun, Ruofan, Jiang, Haitao, 2016, Zhang, Wei, Di Maria, Liu, 2016), to result in a measure ∈(0,1]. Class-specific statistics included mean duration of the microstates within a particular class (Koenig, Prichep, Lehmann, Valdes Sosa, Braeker, Kleinlogel, Isenhart, John, 2002, Lehmann, Faber, Galderisi, Herrmann, Kinoshita, Koukkou, Mucci, Pascual-Marqui, Saito, Wackermann, Winterer, Koenig, 2005), coverage of a class (the percentage of time spent within a class) (Lehmann et al., 2005), and occurrences of the class (number of times the state appears per second) (Lehmann et al., 2005). We also calculated the Markov and syntax matrices (with and without self-transitions respectively) (Lehmann, Faber, Galderisi, Herrmann, Kinoshita, Koukkou, Mucci, Pascual-Marqui, Saito, Wackermann, Winterer, Koenig, 2005, Nishida, Morishima, Yoshimura, Isotani, Irisawa, Jann, Dierks, Strik, Kinoshita, Koenig, 2013, von Wegner, Tagliazucchi, Laufs, 2017), the information-theoretical zeroth and first order Markov statistics and their p-values (von Wegner et al., 2017), and tested for non-random microstate syntax  (Lehmann, Faber, Galderisi, Herrmann, Kinoshita, Koukkou, Mucci, Pascual-Marqui, Saito, Wackermann, Winterer, Koenig, 2005, Nishida, Morishima, Yoshimura, Isotani, Irisawa, Jann, Dierks, Strik, Kinoshita, Koenig, 2013). Details and results of analysis to quantify non-stationary, i.e. by comparing microstate statistics against random fluctuations in a stationary process, are given in Supplementary Text S2.2.

2.3 Testing for associations between microstates and functional connectivity

To derive functional connectivity for a given microstate, we adapt the EEG microstate segmented phase locking method of Hatz, Hardmeier, Benz, Ehrensperger, Gschwandtner, Rüegg, Schindler, Monsch, Fuhr, 2015, Hatz, Hardmeier, Bousleiman, Rüegg, Schindler, Fuhr, 2016. The method is described in detail in Supplementary Text S1.4, and a visual overview of the pipeline is given in Supplementary Figure S1. Microstate analysis was first performed on broadband (1–30 Hz) data. We subsequently filtered the data into one of three narrow bands (theta 4–8 Hz, alpha 8–13 Hz, beta 13–30 Hz), and calculated the Hilbert transform. For a given microstate, all samples of the analytic signal within this microstate class were concatenated. Under the assumption that microstates are associated with specific patterns of phase synchronization (i.e. the hypothesis we wish to test), we subsequently epoched these concatenated samples into non-overlapping windows of 1280 samples (equivalent to 5-seconds), and calculated phase synchronization for each window using the weighted phase lag index (wPLI) (Colclough, Woolrich, Tewarie, Brookes, Quinn, Smith, 2016, Vinck, Oostenveld, van Wingerden, Battaglia, Pennartz, 2011). wPLI was chosen because it is invariant to instantaneous pairwise phase synchrony (although may still exhibit ghost interactions Palva et al., 2018). This is advantageous in our study for two reasons. Firstly, our networks will not be influenced by leakage in the inverse algorithm. Secondly, since microstate analysis involves topographic clustering of the instantaneous patterns of activation, by studying only phase-lagged connectivity we are not simply quantifying the same effect as microstate analysis using a different method. This method was repeated for each microstate class, to obtain functional connectivity patterns for each class.

This methodology assumes that microstates are associated with a unique pattern of phase synchronization, and therefore it is meaningful to calculate a single functional network for all samples in a given class. However, validating or rejecting this assumption is not trivial, since phase synchronization (wPLI) studies lagged connectivity while microstates study instantaneous connectivity and hence are quantifying different phenomena (Koenig and Valdés-Sosa, 2018). Hence, the aim of this analysis is to test the hypothesis that there is a significant association between microstates and functional connectivity. To test this hypothesis, we applied multi-variate pattern analysis (MVPA) using the MVPA-Light toolbox (Treder, 2020). Across all participants, resting-state scans, 1280-sample segments, and microstate classes there were 5413 networks per frequency, each associated with a single microstate class. The weighted degree distributions were used as features in a multi-class classifier for microstate label. Results were 5-fold cross-validated. Statistically significant classification accuracy (via permutation testing) is strongly suggestive that microstates are associated with unique patterns of phase synchronization, demonstrating that microstate class can be predicted given functional connectivity derived from any 1280 samples from that microstate class. Details on classification are given in Supplementary Text S1.4.

2.4 Analysis of task microstates

To compare microstates derived from resting-state and task conditions, we separately performed microstate analysis on data recorded from each condition and aligned microstates across conditions using a template matching algorithm. Microstate statistics were averaged over all data sets available within a condition for a participant. Microstate statistics between conditions were compared using paired Wilcoxon sign-rank tests.

To assess whether specific states were associated with auditory stimuli, we calculated an expected probability of all states under the null hypothesis of no association between state likelihood and stimuli by calculating the coverage of each state over samples in the pre-stimulus periods (up to 100 ms prior to the stimuli) across all task scans and all participants. For a given latency in the range 0–350 ms following the stimulus, we calculated an observed count of states by calculating the number of occurrences of each state over all stimuli and all participants. A χ2 test was used to compare the observed count with the expected count (equal to expected probability multiplied by total number of stimuli). To post-hoc test for deviations of the count of each microstate class from the expected count, we used the Pearson residual (Agresti, 2012), calculated as(3) ei=(Oi−Ei)Ei,

where ei are the residuals, and Oi and Ei and the observed and expected counts of microstate i respectively. The normalization by Ei standardizes these scores to be distributed as the standard normal distribution under the null hypothesis. The χ2 statistics can be written as χ2=∑iei2, and hence microstates with large magnitude of ei contribute to larger values of χ2.

2.5 Participants and data

2.5.1 Participants

Thirty healthy participants (16 female, 9 male) were recruited from Cardiff University School of Psychology participant panel (age range 17–28 years, median age 20 years). All participants had normal or corrected-to-normal vision, and none reported a history of neurological or psychiatric illness. Written consent was obtained from all participants. The study was approved by the Cardiff University School of Psychology Research Ethics Committee.

2.5.2 MEG Acquisition and preprocessing

Whole-head MEG recordings were made using a 275-channel CTF radial gradiometer system (CTF Systems, Canada) at a sampling rate of 1200 Hz. An additional 29 reference channels were recorded for noise cancellation purposes and the primary sensors were analysed as synthetic third-order gradiometers (Vrba and Robinson, 2001). One sensor was turned off during recording due to excessive sensor noise (i.e., Nx=274 gradiometers). Horizontal and vertical electro-oculograms (EOG) were recorded to monitor blinks and eye movements. The horizontal electrodes were placed on temples, and vertical ones, above and below the eye. For MEG/MRI co-registration, the head shape with the position of the coils was digitised using a Polhemus FASTRAK (Colchester, Vermont).

MEG was recorded over two sessions, recorded on separate days (1–24 days between sessions). In each session, eight minutes of continuous resting-state was recorded, for which participants were instructed to sit comfortably in the MEG chair while their head was supported with a chin rest and with eyes open focus on a fixation point on a grey background. Additionally, ten minutes of passive task activity was recorded in each session, for which participants were instructed to watch an emotionally neutral movie while periodic auditory stimuli (separated by 500 ms) were played through headphones. Half of the stimuli consisted of standard tones, while the other half were a mixture of duration, gap, direction, intensity, and frequency deviates.

For preprocessing, MEG data was imported to Fieldtrip (Oostenveld et al., 2011), bandpass filtered at 1–100 Hz (4th order two-pass Butterworth filter), notch filtered at 50 and 100 Hz to remove line noise, and downsampled to 256 Hz. Visual and cardiac artifacts were removed using ICA decomposition (aided by EOG recordings), using the ‘fastica’ algorithm (Hyvarinen, 1999). For both task and resting-state data, between 2 and 6 components were removed per scan (median 4 for rest, 3.5 for task).

2.5.3 Source reconstruction

All participants also underwent a whole-brain MRI scan on a Siemens 3T Connectom MRI scanner and a 32-channel receiver head coil (Siemens Medical Systems). We used a T1-weighted magnetization prepared rapid gradient echo sequence (MPRAGE; echo time: 3.06 ms; repetition time: 2250 ms sequence, flip angle: 9∘, field-of-view: = 256 × 256 mm, acquisition matrix: 256 × 256, voxel size: 1 × 1 × 1 mm).

From the T1-weighted MRI image, extraction of the scalp, brain, and cortical surfaces was performed with Freesurfer (Dale et al., 1999). Vertices of the cortical surface were labelled according to the HCP230 atlas optimized for MEG studies (Tait et al., 2021). The scalp surface was used to align the structural data with the MEG digitizers. A single shell volume conduction model (Nolte, 2003) was constructed in Fieldtrip using the brain surface (downsampled to 500 vertices). The cortical mesh was downsampled to approximately 10,000 vertices to generate a set of dipole locations using the ‘iso2mesh’ software (Fang and Boas, 2009), and dipoles were oriented normal to the cortical surface (Dale, Liu, Fischl, Buckner, Belliveau, Lewine, Halgren, 2000, Hillebrand, Barnes, 2003).

Source reconstruction used the eLORETA algorithm (Pascual-Marqui, Pascual-Marqui, 2009) implemented in Fieldtrip. eLORETA was chosen based on a systematic evaluation of source-reconstruction of resting-state MEG demonstrating high performance in a range of metrics, particularly in the case of parcellated data as in this study (Tait et al., 2021). We note that beamformers such as the unit-noise-gain LCMV beamformer also performed well in this evaluation, but was deemed less appropriate for microstate analysis than eLORETA due to the assumption of uncorrelated sources and suppression of correlated sources (Sekihara et al., 2002) and lower global spatial resolution resulting in mislocalization of ROIs on a high-resolution atlas (Tait et al., 2021). Source data was parcellated using the HCP230 atlas labels (Tait et al., 2021) by taking the time course of the first principal component of all voxels with an ROI. Source time courses were bandpass filtered in the 1–30 Hz frequency band, and head localization coils were used for offline head motion correction (Stolk et al., 2013).

2.6 Simulations

Simulations were performed to test the ability of the microstate methodology to estimate a ground truth microstate sequence and spatial maps. Details of the simulations are given in Supplementary Text S1.3. Artificial generative sequences were generated using a random walk decision tree approach, detailed in Supplementary Text S1.3, which reverse engineers a method to transform microstates to random walks (Van De Ville, Britz, Michel, 2010, von Wegner, Knaut, Laufs, 2018, von Wegner, Tagliazucchi, Brodbeck, Laufs, 2016). Neural dynamics were then generated by assigning each microstate a Wilson-Cowan neural mass model of resting-state dynamics (Abeysuriya, Hadida, Sotiropoulos, Jbabdi, Becker, Hunt, Brookes, Woolrich, 2018, Deco, Jirsa, McIntosh, Sporns, Kötter, 2009), and stimulating the oscillator associated to the active state. Finally, the states were assigned spatial maps of the same spatial dimensionality as our data, i.e. 230 ROIs. The choice of spatial map is arbitrary, so to increase neurophysiological realism we used open access resting-state networks derived from fMRI (Smith et al., 2009) aligned to our brain atlas. ROI time series were generated as a combination of a linear projection of each microstate’s neural dynamics onto the microstate maps and pink noise with SNR=1. Twenty repetitions of the simulations were performed, and simulations were repeated for k=4 and k=10 states. Four statistics were used to assess the quality of the microstate estimation against the ground truth, namely GEV, map similarity, temporal mutual information (MI) the ground truth and estimated sequence, and the normalized mutual information only at the GFP peaks (MIg).

It should be highlighted that these simulations do not aim to reproduce biophysical mechanisms of microstate generation as currently these mechanisms are not well understood. Due to this, some key properties of true microstate sequences such as spontaneous transitioning and associations between GFP and state stability (Koenig and Brandeis, 2016) are not recreated by our model. However, this should not crucially alter the outcome of our results, since the aim of the simulations was to generate artificial data with few underlying model assumptions and known ground truth maps/sequences.

3 Results

3.1 Simulations

We used a neural-mass model to generate synthetic time courses of electrophysiological data with a known number of microstates. The simulations were then used to test the source-space microstate algorithm against the ground truth. Fig. 1 shows the simulation pipeline and results of analysing the simulated datasets. Clustering in both amplitude envelope and raw time courses were able to accurately reproduce ground truth maps and sequences (Fig. 1H-J). Amplitude envelope microstates outperformed raw time-course microstates in terms of GEV (Fig. 1D). However, GEV is a purely data-driven approach of quantifying goodness of fit, so we subsequently compared estimated maps and sequences to the ground-truth (Fig. 1E-G). When compared to the ground-truth, raw time-course clustering was superior in terms of map similarity for 4 states and mutual information for 4–10 states. Amplitude envelopes marginally outperformed raw time-courses in terms of map similarity for 10 states. These results demonstrate that the source-microstate pipeline can accurately reproduce known microstates, and validate our choice to focus on raw time-course data in subsequent analyses.Fig. 1 Simulating microstates. (A–C) Methodology for simulating microstates. Detailed description is given in Supplementary Text S1.3. (A) Generative sequences are simulated using a decision tree, the state at a given time is decided by a set of random-walks and a decision tree. The left branch is chosen if the walk is increasing, the right branch is chosen if the walk is decreasing. Each sample is assigned a state using this procedure. (B) Neural dynamics of microstates are simulated by assigning each state a neural mass model (NMM). The NMMs receive constant input (P) at all times, and the NMM corresponding to the current active state receives additional input (Pms). The bottom shows simulated state time series, with background colour corresponding to active state. (C) Each state is assigned a spatial map and the time courses are linearly mixed according to this map to generate simulated MEG/EEG/source data. Pink noise is added to this data. (D-G) Assessment of microstate sequences estimated from simulated data vs ground truth. (D) GEV, (E) map similarity between estimated maps and ground truth maps, (F-G) mutual information between estimated sequences and ground truth sequences at all samples/GFP peaks respectively. (H–J) Results of analysing an example simulation. Estimated maps in source data (H) and amplitude data (I) are shown. (J) Shows ground truth and estimated sequences for the first 10s of simulated data.

Fig. 1

3.2 Resting-state microstate maps

We source-reconstructed MEG resting-state data from 30 participants. Across all participants, microstates in resting-state data were calculated from a sample of 150,000 GFP peaks using the k-means clustering algorithm. Figure 2A shows the GEV across these 150,000 peaks as k is varied from 2 to 40 states. The kneedle algorithm indicated that 10 states were optimum, and hence we proceeded to back-fit the results of the 10-state clustering to the full MEG scans. Fig. 2B shows the GEV in the full datasets. In the first set of scans, from which the GFP peaks were sampled to estimate microstates, 10 states had a GEV of 63.97±0.64%. To ensure the states were generalizable and reproducible, we also back-fit the maps to a second independent scan from each participant, which was performed on a separate day and not used in the clustering analysis. There was a significant but small decrease in GEV in the second scan (62.13±0.39%, p=0.0082, Wilcoxon sign-rank test), as expected in cross-validation. Furthermore, multiple runs of the algorithm demonstrated high reproducibility (Supplementary Text S2.1).Fig. 2 Resting-state microstates. (A) GEV vs number of states (k) for resting-state data. Here, GEV is calculated across the 150,000 peaks used for clustering. The kneedle algorithm found that k=10 states was optimum, marked by a red ‘+’. (B) GEV across the full MEG scans, for k=10. Distributions are shown across participants. Only GFP peaks from scan 1 for each participant were used for clustering, and hence scan 2 can be viewed as a replication/validation cohort. There is a small but significant decrease in GEV for scan 2. (C) Resting-state microstate maps derived from the k-means clustering algorithm for k=10 states.

Fig. 2

Figure 2 C shows the spatial map of each empirical MEG source-level microstate. Four bilateral maps were identified, including the frontal cortices, the fronto-temporal network, the visual cortex, and the orbital cortex. The remaining six maps could be grouped into three pairs of lateralized networks including medial/superior parietal, temporal poles, and sensorimotor networks.

3.3 Statistics of resting-state microstate sequences

We subsequently analysed the statistics of the estimated microstate sequences, reported in full in Supplementary Table S3. Microstates had a mean duration (MD) across all classes of 59.86±1.09 ms (Supplementary Table S3). This was significantly longer than could be explained by random fluctuations in a stationary Gaussian process with the same power spectra, cross-spectra (and covariances), and distribution of data (Supplementary Text S2.2), suggestive of non-stationarity and the existence of stable microstates in empirical resting-state MEG. Durations of each state individually are shown in Fig. 3.Fig. 3 Syntax of resting-state microstates. (A) The average syntax matrix from resting-state data. (B-D) Coverage, duration, and occurrence of each of the ten resting-state microstate maps.

Fig. 3

Of the 10 microstates, the frontal and frontotemporal states had the highest coverage and highest number of occurrences per second (Fig. 3). This can be observed in the group-level syntax matrix (Fig. 3A), in which almost all states tend to transition most predominantly to the frontotemporal state, which in turn is most likely to transition to the frontal state. However, random sampling of states with heterogeneous occurrences per second is not sufficient to explain the syntax matrix, as the syntax permutation test (Lehmann et al., 2005) demonstrated significant differences between the group level matrix and the matrix expected due to state probability (p=4×10−4). Similarly, when accounting for duration and coverage (i.e. including self transitions in the Markov matrix), information theoretical analysis still demonstrated that the zero’th order Markov (G0) property was, for all participants, far greater than expected under the null hypothesis of random sampling based on coverage of states (Supplementary Table S3). The transitioning matrix could also not be explained by a first order Markov process, as demonstrated by the Markov G1 information theoretical analysis (Supplementary Table S3). Combined, these results suggest structured and non-Markovian transitioning in the microstate sequence.

The structured, non-stationary and non-Markovian nature of microstate transitions was additionally supported by global statistics. The Hurst exponent (H) was approximately 0.68±0.01, suggestive of long range temporal correlations. The normalized microstate complexity (C) was 0.60±0.01, suggesting a complex sequence which strikes a balance between highly repetitive and ordered (C approaching zero) and random sampling (C approaching one). These global statistics were significantly different than expected from random fluctuations in a stationary process (Supplementary Text S2.2), further evidencing the non-stationary nature of resting-state MEG.

3.4 Microstate-specific functional connectivity

Our next aim was to test the hypothesis that different microstate classes are associated with distinct patterns of functional connectivity in the brain, and reflect the rapid transitioning in dynamic phase synchronization patterns. To do so, we used multi-class MVPA to test whether microstates could be predicted from microstate-segmented wPLI connectivity matrices (see Section 2.3). Table 3 shows the classification accuracy and permutation testing p-values for each frequency band, while Fig. 4A shows the confusion matrices for this classification.Table 3 MVPA classification statistics for microstate-segmented connectivity. Accuracy is given as a mean and standard error across five repetitions.

Table 3Band	Accuracy	p-value	
Theta	0.2068±0.0084	<10−3	
Alpha	0.3281±0.0120	<10−3	
Beta	0.3083±0.0112	<10−3	

Fig. 4 Microstates are associated with specific patterns of phase synchronization. (A) Confusion matrices for the MVPA analysis, for three frequency bands used for functional connectivity calculation. Cell i,j corresponds to the probability the classifier would predict class j given a microstate label i. (B) Functional connectivity patterns. Node colours show degree distributions (used for classification in the MVPA analysis), while edges show the top 1% of edges that deviate from static background connectivity (see Supplementary Text S1.4 for details).

Fig. 4

The classification accuracy was significantly above the chance level of 10% (p<10−3, 1000 permutation tests from 1000 surrogates), suggesting distinct functional connectivity patterns among microstates. The confusion matrices demonstrate interesting patterns. In the alpha and beta bands, the visual microstate is the one most accurately predicted by the connectivity matrix, while in theta the temporal microstates were more accurate. Unsurprisingly because of their overlap, frontal, frontotemporal, and orbital networks had reasonable degrees of confusion in all bands. In the alpha band, the frontal network was also sometimes confused with bilateral sensorimotor networks.

Furthermore, lateralized microstates were regularly confused with their counterparts in the opposite hemisphere, suggesting that while activation patterns in these states may be lateralized, the states are parts of a larger interhemispherical network. Indeed, Fig. 4B shows the alpha band network structures, and it is clear that the functional connectivity structure for both lateralized parietal and temporal microstates demonstrated many interhemispherical connections.

3.5 Microstate response to auditory stimulus

Finally, we aimed to test whether source-level MEG microstates vary between rest and task. To do so, we re-ran the microstate clustering analysis on MEG data during a passive auditory task. The optimum number of microstates in the task data was k=9. This was one fewer than at rest, yet there were no significant differences in the GEV between nine states in task and ten states at rest (Fig. 5A-B; p=0.9099).Fig. 5 Auditory task microstates. (A) GEV vs number of states (k) for resting-state data. Here, GEV is calculated across the 150,000 peaks used for clustering. The kneedle algorithm found that k=10 states was optimum, marked by a red ‘+’. (B) GEV across the full MEG scans, for k=10. Distributions are shown across participants. Only GFP peaks from scan 1 for each participant were used for clustering, and hence scan 2 can be viewed as a replication/validation cohort. There is a small but significant decrease in GEV for scan 2. (C) Resting-state microstate maps derived from the k-means clustering algorithm for k=10 states.

Fig. 5

Maps for the nine states derived from the task data are shown in Fig. 5C. The task-based states closely corresponded to those from rest. The two lateralized medial parietal states in the resting-state data were represented by a single medial parietal state in the task data, explaining the presence of one fewer state. The frontal and visual states demonstrated differences between conditions, with the frontal state appearing more right lateralized and the visual state having greater spatial extent. All other states closely recreated their resting-state counterparts. There were no significant differences in global statistics of the microstate sequences between rest and task, including mean duration (p=0.5170), Hurst exponent (p=0.2452), or complexity (p=0.8774). Although microstate analysis was performed on rest and task data separately, the similarities between paradigms is to be expected, since microstate analysis in both cases was performed on continuous (as opposed to trial averaged) data. Hence, in the task data we have not ‘averaged out’ the background (resting) activity or its associated microstates.

To uncover whether any states were time-locked to auditory stimuli, we used χ2 tests to compare pre-stimulus and post-stimulus coverage of each state. The time evolution of χ2 is shown in Fig. 6A. There is a significant difference in the observed and expected microstate counts between 70 and 280 ms following the stimulus, peaking at 113 ms. This is in line with the auditory N100 evoked response. The differences in microstate count are largely driven by a significantly increased coverage of the frontotemporal state, with resulting decreased coverage of several other microstates including a significantly decreased coverage of the medial parietal state (Fig. 6B). Since the frontotemporal state includes the auditory network (Fig. 5C), these results are in line with increased activation of the auditory network as a response to an auditory stimulus.Fig. 6 Microstate response to auditory stimuli. (A) χ2 distance (top) and Pearson residuals (bottom) between observed and expected counts of each microstate vs time after stimulus. The peak response was 113 ms after the stimulus. In the top panel, the shaded regions for samples with Bonferroni corrected p<0.05 (above the dotted red line) represent the state with largest Pearson residual (i.e. most active in comparison to pre-stimulus periods). (B) Pearson residuals for each state. For large sample sizes, under the null hypothesis the Pearson residual is approximately normally distributed. Here, Pearson residuals are averaged across all samples around the peak with a value of χ2 greater than one-half the peak value. For both plots, dotted red lines show the Bonferroni corrected 95% significance level. Hence, these results suggest that between 70–280 ms following the stimulus the microstate response is significantly different that expected, due to a significantly increased likelihood of the frontotemporal state (inlaid, demonstrating activation of auditory cortex) and decreased likelihood of the parietal state.

Fig. 6

4 Discussion

Understanding the mechanisms underpinning discrete brain state generation is currently a leading question in the field of neuroscience, which may aid with understanding behaviour and cognition (Cohen, 2018) and neurological diseases (Khanna et al., 2015). One approach to do this in sensor EEG is microstate analysis (Michel and Koenig, 2018), but this approach cannot be directly applied to source data. In this study, we have presented a modified source-space microstate pipeline and demonstrated the validity and robustness of source-space MEG microstates. Using a k-means clustering algorithm, we showed that 10 microstates can be reliably estimated from resting-state MEG data, and their spatial distributions are similar to those quantified from task-based data. Source-space MEG microstates vary in their statistics such as coverage and occurrence probabilities, and are associated with distinct functional connectivity signatures. These results support the use of MEG microstates to understand dynamic functional connectivity during rest and task.

Interestingly, in resting-state data we observed the optimum number of states to be 10, explaining approximately 63% of the variance of the data. In resting-state sensor EEG, only four microstates have repeatedly been reproduced and observed to be the optimum, explaining approximate 60–85% of variance in the data (Michel and Koenig, 2018). There are a number of potential explanations for the differences between these results. One possible explanation is that EEG usually has lower spatial resolution than MEG, due to (typically) fewer sensors and a blurring of the electric field by the skull tissue. In a study with high-density EEG (204 electrodes), seven maps were optimum (Custo et al., 2017), supporting the hypothesis of higher spatial resolution potentially increasing the optimum number of maps. Another possible explanation is the criterion used for selecting the optimum number of maps, as many criteria are available in the literature (Michel and Koenig, 2018). Discussion of this point, including motivation for our choice of criterion, are given in Supplementary Text S1.2. The larger number of states in this study may also be due to performing clustering in source space as opposed to sensor space. There is a non-uniform distribution of signal-to-noise ratio (SNR) in the forward projection of the source dynamics to sensor space, and hence it is possible that states originating from low-SNR areas of the cortex or may be under-represented in the sensor space maps. Additionally, due to finite spatial sampling of M/EEG sensors, multiple source topographies may result in non-unique maps, and therefore multiple source-space states may appear similar at the sensor level. Both of these effects potentially result in under-estimation of the number of states at the sensor level. In HMM studies of source-reconstructed resting-state MEG, Baker et al. (2014) studied eight states while Vidaurre et al. (2018) found twelve to be optimum, while fMRI results have suggested ten reproducible resting-state networks (Smith et al., 2009) or 7–8 states based on k-means clustering of dynamic resting-state functional connectivity patterns (Allen et al., 2014), in line with our results demonstrating greater than four states at the cortical level.

The ten resting-state microstates included four bilateral networks and three pairs of symmetric lateralized networks (Fig. 2). The cognitive relevance of these microstates should be a focus of future work. One approach to uncover the associations between microstates and cognition is to quantitatively compare microstate statistics between cognitive states. Such approaches have widely been performed in the sensor-space EEG microstate literature to gain insight into the functional significance of brain microstates (Britz, Hernàndez, Ro, Michel, 2014, Brodbeck, Kuhn, von Wegner, Morzelewski, Tagliazucchi, Borisov, Michel, Laufs, 2012, Milz, Faber, Lehmann, Koenig, Kochi, Pascual-Marqui, 2016, Seitzman, Abell, Bartley, Erickson, Bolbecker, Hetrick, 2017, Zappasodi, Perrucci, Saggino, Croce, Mercuri, Romanelli, Colom, Ebisch, 2019), and the work presented here opens new pathways to gain deeper anatomical insight at the cortical level. Here, we demonstrated that statistics of our source-space cortical microstates differed between rest and a passive auditory mismatch paradigm (Fig. 5-6). We found hyperactivity of the frontotemporal microstate, which includes the auditory cortex, approximately 100ms following an auditory stimulus. Interestingly, the well-studied auditory evoked response has been localized to the auditory cortex and first peaks around 100ms following the stimulus (Picton, 2010), known as the N100 response, in line with our microstate results. An alternative approach to study states associated with a stimulus in greater temporal detail involves averaging over trials and performing microstate analysis on the grand average evoked response (Murray et al., 2008), an approach which is possible in source-space using our generalized microstate algorithm (Tait and Zhang, 2021). The states derived in such an approach would, by definition, be associated with the response elicited from the stimulus and allow for plotting a group-level time course of states along the evoked response, but would likely represent very different states to those from resting-state activity. Hence, such an approach is useful for segmenting the evoked response into stable segments and potentially give insight into phenomena such as mismatch negativity (Tait and Zhang, 2021), while the approach presented here is useful for understanding how resting microstates vary with cognitive state. Future work should build upon these approaches to examine the functional significance of these states.

A complementary approach is to uncover associations between microstates and the well studied resting-state networks (RSNs) widely studied in fMRI, which have been associated with cognitive domains in large cohort studies (Smith et al., 2009). In sensor-space EEG, studies have demonstrated associations between microstates and fMRI-RSNS through convolution of the microstate time courses with a haemodynamic response function and general linear modelling (Abreu, Jorge, Leal, Koenig, Figueiredo, 2020, Britz, Van De Ville, Michel, 2010, Musso, Brinkmeyer, Mobascher, Warbrick, Winterer, 2010, Van De Ville, Britz, Michel, 2010, Xu, Pan, Zhou, Zou, Liu, Su, Zou, Gao, 2020, Yuan, Zotev, Phillpis, Drevets, Bodurka, 2012, Zoubi, Misaki, Tsuchiyagaito, Mayeli, Zotev, Investigators, Refai, Paulus, Bodurka, 2020), or through correlations between RSNs and microstate statistics (Schumacher et al., 2019). An advantage of working in source space for this purpose is that spatial patterns of microstate activations can be associated with RSNs when directly comparable brain atlases are used for parcellation of the brain dynamics in the M/EEG and fMRI data.

While the activation patterns of our microstates did not directly correspond to the well known resting-state networks (RSNs) often reported in fMRI studies (Smith et al., 2009), interesting insight into this relationship could be gained by studying spatial patterns of synchrony associated with each microstate. Through the use of machine learning - specifically MVPA (Treder, 2020) - we found a significant association between active microstate class and cortical patterns of phase synchronization (Fig. 4, Table 3). The spatial patterns of synchrony did not directly reflect the associated microstate maps, and the functional connectivity patterns identified here may give insight into the relationship between microstates and RSNs. A key example is the default mode network, which contains the medial/orbital frontal, medial parietal, and lateral parietal regions (Smith et al., 2009). No single microstate had an activation pattern containing all of these ROIs, yet phase-locking patterns indicted microstates demonstraing medial/orbital frontal to medial parietal connectivity and medial parietal to lateral parietal connectivity (Fig. 4B). Future work should involve simultaneous high-density source-reconstructed EEG and fMRI to study the relationship between source-space microstates and RSNs.

A typical approach for dynamic functional connectivity in the current literature is the use of a sliding window (Brookes, O’Neill, Hall, Woolrich, Baker, Corner, Robson, Morris, Barnes, 2014, de Pasquale, Della Penna, Snyder, Lewis, Mantini, Marzetti, Belarinelli, Ciancetta, Pizzella, Romani, Corbetta, 2010, de Pasquale, Della Penna, Sporns, Romani, Corbetta, 2016, Lopes, Zhang, Krzemiński, Hamandi, Chen, Livi, Masuda, 2020, O’Neill, Bauer, Woolrich, Morris, Barnes, Brookes, 2015), followed by clustering of networks (Allen, Damaraju, Plis, Erhardt, Eichele, Calhoun, 2014, Hassan, Benquet, Biraben, Berrou, Dufor, Wendling, 2015, Mheich, Hassan, Khalil, Berrou, Wendling, 2015, O’Neill, Bauer, Woolrich, Morris, Barnes, Brookes, 2015) or recurrence analysis (Lopes, Zhang, Krzemiński, Hamandi, Chen, Livi, Masuda, 2020, Tewarie, Liuzzi, O’Neill, Quinn, Griffa, Woolrich, Stam, Hillebrand, Brookes, 2019). These approaches are limited by the arbitrary choice of window size - short windows (or even instantaneous measures of connectivity Tewarie et al., 2019) will be predominantly driven by noise, while long windows may operate at a time scale slower than brain state transitions - meaning development of novel methods beyond the sliding window are crucial (O’Neill et al., 2018). Our MVPA analysis indicated that windowing via microstate labelling and concatenation of samples within a state (i.e. microstate-segmented functional connectivity Hatz, Hardmeier, Benz, Ehrensperger, Gschwandtner, Rüegg, Schindler, Monsch, Fuhr, 2015, Hatz, Hardmeier, Bousleiman, Rüegg, Schindler, Fuhr, 2016) is a powerful option for the study of dynamic functional connectivity states at a fast time scale without setting an a priori window length. However, this approach differs in interpretation. Clustering sliding window networks will define brain states based on functional connectivity structure, and each state will have a unique pattern of functional connectivity. In contrast, microstate analysis defines brain states based on instantaneous co-activation, and each state will have unique patterns of activation. One can subsequently calculate the connectivity associated with a given microstate, but the existence of these ‘microstate-segmented networks’ is not trivial (Koenig and Valdés-Sosa, 2018) and may not be unique. For example, while our MVPA classification was significant for all frequency bands, accuracy was not perfect and there may be overlaps between functional connectivity patterns of lateralized states (Fig. 4). Hence, when studying microstate-segmented dynamic networks, one should always test for significant associations using methods such as MVPA (Treder, 2020) and be aware that states are not defined in terms of network structure.

In recent years several alternative methodologies have been proposed which may be applied to source-space brain state estimation, such as Hidden Markov Models (HMMs) (Baker, Brookes, Smith, Behrens, Smith, Woolrich, 2014, Gärtner, Brodbeck, Laufs, Schneider, 2015, Taghia, Cai, Ryali, Kockalka, Nicholas, Chen, Vinod, 2018, Vidaurre, Hunt, Quinn, Hunt, Brooked, Nobre, Woolrich, 2018, Vidaurre, Quinn, Baker, Dupret, Tejero-Cantero, Woolrich, 2016) or component analysis such as independent or principal component analysis (von Wegner et al., 2018). Here, we briefly discuss differences between these methods and source-space microstates. Microstates are defined in terms of patterns of instantaneous activation across the cortex and are estimated using k-means clustering (or other methods such as hierarchical clustering), with resulting state time-courses mutually exclusive across the estimated states. PCA and ICA are similarly defined in terms of patterns of instantaneous activation, but are estimated via a linear mixing (outer product) model which results in state mixing, i.e. state activations are not mutually exclusive. Discrete state time-courses can be achieved through a winner-takes-all approach. HMMs, when applied to M/EEG, are typically defined in terms of cross-region interactions in the form of a covariance matrix (amplitude envelopes, Baker et al., 2014) or time-delay embeddings which additionally provide access to state-specific spectral information (raw time-courses, Vidaurre et al., 2018). HMMs are estimated using parameter optimization techniques such as variational Bayes, resulting in a probability of state membership for each time point which is typically decoded to a discrete time-course of mutually exclusive states.

In our simulated data (Fig. 1) - in which states were mutually exclusive and defined in terms of instantaneous co-activation of maps - the overall ranking in terms of performance of the algorithms was microstates performing best, followed by PCA and ICA techniques, while HMMs performed very poorly (Supplementary Text S2.3). This is unsurprising, since the assumptions of the model most strongly matched those of the microstate model, and least closely matched those of the HMMs. Furthermore, the added complexity of HMMs typically means more data is required for accurate state estimation and HMMs are usually applied to several minutes of data at the group level, while our simulations were performed on individual 60s trials. In an additional set of simulations (Supplementary Text S1.3.2) in which states had identical spatial patterns of activation but different spectra and coherence structures and states were estimated at the group-level over 20 trials of 5 min, microstates, PCA, and ICA were all unable to recreate state time courses while HMMs performed well (Supplementary Text S2.3). Hence, different methods contain complementary information, and resulting states using different pipelines must be interpreted differently. Future work should include simulations under a range of models and assumptions and a deeper analysis of various real task-related data sets in order to perform a more detailed comparison between state estimation approaches and identify the circumstances under which each approach is most appropriate, as well as validation of robustness of approaches in a large cohort.

4.1 Conclusions

We have presented a source-space microstate pipeline for estimating electrophysiological brain states. We uncovered ten resting microstates which were associated with distinct patterns of activation and phase synchrony across the cortex, and demonstrated these microstates were the result of stable non-stationary states arising as opposed to random fluctuations in a stationary process. The microstates were associated with cognitive state; in particular the resulting microstate probabilities were altered as a response to auditory stimulus, driven by hyperactivity of the frontotemporal microstate. Our results suggest the methodology presented here is a powerful tool for studying anatomically interpretable brain states and dynamic functional connectivity at the millisecond scale.

Data and code availability statement

Data preprocessing and source reconstruction used Fieldtrip version 2019-07-16 (Oostenveld et al., 2011). Code for performing microstate analysis in sensor- or source-space MEG/EEG, simulations as described in this manuscript, statistics and visualisation have been compiled in the +microstate toolbox (Tait and Zhang, 2021) (https://plus-microstate.github.io), a freely-available open-source toolbox written in MATLAB R2017b. Codes for running the analyses presented in this script are available at https://github.com/plus-microstate/manuscript_codes/tree/main/MEG-cortical-microstates. Data used in this study are freely available at the open science framework (Tait, 2021).

CRediT authorship contribution statement

Luke Tait: Conceptualization, Methodology, Software, Formal analysis, Writing – original draft, Visualization. Jiaxiang Zhang: Conceptualization, Writing – review & editing, Supervision, Funding acquisition.

Appendix A Supplementary materials

Supplementary Data S1

Supplementary Raw Research Data. This is open data under the CC BY license http://creativecommons.org/licenses/by/4.0/

Supplementary Data S1

Acknowledgements

This study was supported by 10.13039/501100000781 European Research Council [grant number 716321].

Supplementary material associated with this article can be found, in the online version, at doi:10.1016/j.neuroimage.2022.119006.
==== Refs
References

Abeysuriya R.G. Hadida J. Sotiropoulos S.N. Jbabdi S. Becker R. Hunt B.A.E. Brookes M.J. Woolrich M.W. A biophysical model of dynamic balancing of excitation and inhibition in fast oscillatory large-scale networks PLoS Comput. Biol. 14 2 2018 e1006007 10.1371/journal.pcbi.1006007 29474352
Abreu R. Jorge J. Leal A. Koenig T. Figueiredo P. EEG microstates predict concurrent fMRI dynamic functional connectivity states Brain Topogr. 2020 10.1007/s10548-020-00805-1
Agresti A. Categorical Data Analysis 2012 John Wiley & Sons
Allen E.A. Damaraju E. Plis S.M. Erhardt E.B. Eichele T. Calhoun V.D. Tracking whole-brain connectivity dynamics in the resting state Cereb. Cortex 24 3 2014 663 676 10.1093/cercor/bhs352 23146964
Andreou C. Faber P.L. Leicht G. Schoettle D. Polomac N. Hanganu-Opatz I.L. Lehmann D. Mulert C. Resting-state connectivity in the prodromal phase of schizophrenia: insights from eeg microstates Schizophr. Res. 152 2–3 2014 513 520 10.1016/j.schres.2013.12.008 24389056
Arthur D. Vassilvitskii S. K-means++: the advantages of careful seeding Discrete Algorithms: SODA-07 Proceedings of the Eighteenth Annual ACM-SIAM Symposium 2007 1027 1035
Babiloni C. Lizio R. Marzano N. Capotosto P. Soricelli A. Triggiani A.I. Cordone S. Gesualdo L. Del Percio C. Brain neural synchronization and functional coupling in Alzheimer’s disease as revealed by resting state EEG rhythms Int. J. Psychophysiol. 103 2016 88 102 10.1016/j.ijpsycho.2015.02.008 25660305
Baker A.P. Brookes M.J. Smith S.M. Behrens T. Smith P.J. Woolrich M. Fast transient networks in spontaneous human brain activity Probert. eLife 3 2014 e01867 10.7554/eLife.01867
Beckmann C.F. DeLuca M. Devlin J.T. Smith S.M. Investigations into resting-state connectivity using independent component analysis Phil. Trans. R. Soc. B 360 2005 1001 1013 10.1098/rstb.2005.1634 16087444
Britz J. Van De Ville D. Michel C.M. BOLD correlates of EEG topography reveal rapid resting-state network dynamics Neuroimage 52 4 2010 1162 1170 10.1016/j.neuroimage.2010.02.052 20188188
Britz J. Hernàndez L.D. Ro T. Michel C.M. EEG-microstate dependent emergence of perceptual awareness Front. Behav. Neurosci. 8 2014 163 10.3389/fnbeh.2014.00163 24860450
Brodbeck V. Kuhn A. von Wegner F. Morzelewski A. Tagliazucchi E. Borisov S. Michel C.M. Laufs H. EEG microstates of wakefulness and NREM sleep Neuroimage 62 3 2012 2129 2139 10.1016/j.neuroimage.2012.05.060 22658975
Brookes M.J. O’Neill G.C. Hall E.L. Woolrich M.W. Baker A. Corner S.P. Robson S.E. Morris P.G. Barnes G.R. Measuring temporal, spectral and spatial changes in electrophysiological brain network connectivity Neuroimage 91 2014 282 299 10.1016/j.neuroimage.2013.12.066 24418505
Brookes M.J. Woolrich M. Luckhoo H. Price D. Hale J.R. Stephenson M.C. Barnes G.R. Smith S.M. Morris P.G. Investigating the electrophysiological basis of resting state networks using magnetoenceopalography Proc. Natl. Acad. Sci. 108 40 2011 16783 16788 10.1073/pnas.1112685108 21930901
Cohen J.R. The behavioural and cognitive relevance of time-varying, dynamic changes in functional connectivity Neuroimage 180 2018 515 525 10.1016/j.neuroimage.2017.09.036 28942061
Colclough G.L. Woolrich M.W. Tewarie P.K. Brookes M.J. Quinn A.J. Smith S.M. How reliable are MEG resting-state connectivity metrics? Neuroimage 138 2016 284 293 10.1016/j.neuroimage.2016.05.070 27262239
Custo A. Van De Ville D. Wells W.M. Tomescu M.I. Brunet D. Michel C.M. Electroencephalographic resting-state networks: source localization of microstates Brain Conn. 7 10 2017 671 682 10.1089/brain.2016.0476
Custo A. Vulliemoz S. Grouiller F. Van De Ville D. Michel C. EEG source imaging of brain states using spatiotemporal regression Neuroimage 96 2014 106 116 10.1016/j.neuroimage.2014.04.002
Dale A.M. Fischl B. Sereno M.I. Cortical surface-based analysis. I. Segmentation and surface reconstruction Neuroimage 9 2 1999 179 194 10.1006/nimg.1998.0395 9931268
Dale A.M. Liu A.K. Fischl B.R. Buckner R.L. Belliveau J.W. Lewine J.D. Halgren E. Dynamic statistical parametric mapping: combining fMRI and MEG for high-resolution imaging of cortical activity Neuron 26 1 2000 55 67 10.1016/S0896-6273(00)81138-1 10798392
de Pasquale F. Della Penna S. Snyder A.Z. Lewis C. Mantini D. Marzetti L. Belarinelli P. Ciancetta L. Pizzella V. Romani G.L. Corbetta M. Temporal dynamics of spontaneous MEG activity in brain networks Proc. Natl. Acad Sci. U.S.A. 107 13 2010 6040 6045 10.1073/pnas.0913863107 20304792
de Pasquale F. Della Penna S. Sporns O. Romani G.L. Corbetta M. A dynamic core network and global efficiency in the resting human brain Cereb. Cortex 26 10 2016 4015 4033 10.1093/cercor/bhv185 26347485
Deco G. Jirsa V. McIntosh A.R. Sporns O. Kötter R. Key role of coupling, delay, and noise in resting brain fluctuations Proc. Natl. Acad Sci. U.S.A. 106 25 2009 10302 10307 10.1073/pnas.0901831106 19497858
Douw L. Schoonheim M.M. Landi D. van der M.M.L. Geurts J.J.G. Reijneveld J.C. Klein M. Stam C.J. Cognition is related to resting-state small-world network topology: an megnetoencephalographic study Neuroscience 175 2011 169 177 10.1016/j.neuroscience.2010.11.039 21130847
Fang Q. Boas D.A. Tetrahedral mesh generation from volumetric binary and grayscale images IEEE International Symposium on Biomedical Imaging: From Nano to Macro, 2009 ISBI 2009 1142 1145 10.1109/ISBI.2009.5193259
Gärtner M. Brodbeck V. Laufs H. Schneider G. A stochastic model for eeg microstate sequence analysis Neuroimage 104 2015 199 208 10.1016/j.neuroimage.2014.10.014 25451473
Glasser M.F. Coalson T.S. Robinson E.C. Hacker C.D. Harwell J. Yacoub E. Ugurbil K. Andersson J. Beckmann C.F. Jenkinson M. Smith S.M. Van Essen D.C. A multi-modal parcellation of human cerebral cortex Nature 536 7615 2016 171 178 10.1038/nature18933 27437579
Goldenholz D.M. Ahlfors S.P. Hämäläinen M.S. Sharon D. Ishitobi M. Vaina L.M. Stufflebeam S.M. Mapping the signal-to-noise-ratios of cortical sources in magnetioenceopahlography and electroencephalography Hum. Brain Mapp. 30 3 2009 1077 1086 10.1002/hbm.20571 18465745
Gschwind M. Michel C.M. Van De Ville D. Long-range dependencies make the difference - comment on “A stochastic model for EEG microstate sequence analysis” Neuroimage 117 2015 449 455 10.1016/j.neuroimage.2015.05.062 26032884
Hassan M. Benquet P. Biraben A. Berrou C. Dufor O. Wendling F. Dynamic reorganization of functional brain networks during picture naming Cortex 74 2015 276 288 10.1016/j.cortex.2015.08.019
Hatz F. Hardmeier M. Benz N. Ehrensperger M. Gschwandtner U. Rüegg S. Schindler C. Monsch A.U. Fuhr P. Microstate connectivity alterations in patients with early Alzheimer’s disease Alz. Res. Therapy 7 2015 78 10.1186/s13195-015-0163-9
Hatz F. Hardmeier M. Bousleiman H. Rüegg S. Schindler C. Fuhr P. Reliability of functional connectivity of electroencephalography applying microstate-segmented versus classical calculation of phase lag index Brain Conn. 6 6 2016 461 469 10.1089/brain.2015.0368
Hillebrand A. Barnes G.R. The use of anatomical constraints with MEG beamformers Neuroimage 20 4 2003 2302 2313 10.1016/j.neuroimage.2003.07.031 14683731
Hyvarinen A. Fast and robust fixed-point algorithms for independent component analysis IEEE Trans. Neural Net. 10 3 1999 626 634 10.1109/72.761722
Khanna A. Pascual-Leone A. Farzan F. Reliability of resting-state microstate features in electroencephalography PLoS ONE 9 12 2014 e114163 10.1371/journal.pone.0114163 25479614
Khanna A. Pascual-Leone A. Michel C.M. Farzan F. Microstates in resting-state EEG: current status and future directions Neurosci. Biobehav. Rev. 49 2015 105 113 10.1016/j.neubiorev.2014.12.010 25526823
Koenig T. Brandeis D. Inappropriate assumptions about EEG state changes and their impact on the quantification of EEG state dynamics Neuroimage 125 2016 1104 1106 10.1016/j.neuroimage.2015.06.035 26091853
Koenig T. Lehmann D. Merlo M.C.G. Kochi K. Hell D. Koukkou M. A deviant EEG brain microstate in acute, neuroleptic-naive schizophrenics at rest Eur. Arch. Psychiatry Clin. Neurosci. 249 1999 205 211 10.1007/s004060050088 10449596
Koenig T. Prichep L. Lehmann D. Valdes Sosa P. Braeker E. Kleinlogel H. Isenhart R. John E.R. Millisecond by millisecond, year by year: normative EEG microstates and developmental stages Neuroimage 16 1 2002 41 48 10.1006/nimg.2002.1070 11969316
Koenig T. Valdés-Sosa P.A. Results obtained by combining different estimators of EEG connectivity become uninterpretable if the underlying models are incompatible Brain Connect. 8 2 2018 57 59 10.1089/brain.2017.0555 29212344
Kropotov J.D. Alpha rhythms Kropotov J.D. Quantitative EEG, Event-Related Potentials and Neurotherapy 2009 Academic Press San Diego 29 58 10.1016/B978-0-12-374512-5.00002-5
ISBN 978-0-12-374512-5.

Lee W.H. Moser D.A. Ing G.E. Doucet A. Frangou S. Behavioural and health correlates of resting-state metastability in the human connectome project Brain Topogr. 32 2019 80 86 10.1007/s10548-018-0672-5 30136050
Lehmann, D., 1990. Brain electric microstates and cognition: the atoms of thought. 10.1007/978-1-4757-1083-0_10
Lehmann D. Faber P.L. Galderisi S. Herrmann W.M. Kinoshita T. Koukkou M. Mucci A. Pascual-Marqui R.D. Saito N. Wackermann J. Winterer G. Koenig T. EEG microstate duration and syntax in acute, medication-naïve, first-episode schizophrenia: a multi-center study Psychiatry Res. Neuroimaging 138 2 2005 141 156 10.1016/j.pscychresns.2004.05.007
Lempel A. Ziv J. On the complexity of finite sequences IEEE Trans. Inf. Theory 22 1976 75 81 10.1109/TIT.1976.1055501
Liégeois R. Li J. Kong R. Orban C. Van De Ville D. Ge T. Sabuncu M.R. Yeo B.T.T. Resting brain dynamics at different timescales capture distinct aspects of human behaviour Nat. Commun. 10 2019 2317 10.1038/s41467-019-10317-7 31127095
Liu Q. Farahibozorg S. Porcaro C. Wenderoth N. Mantini D. Detecting large-scale networks in the human brain using high-density electroencephalography Hum. Brain Mapp. 38 2017 4631 4643 10.1002/hbm.23688 28631281
Lopes M.A. Zhang J. Krzemiński D. Hamandi K. Chen Q. Livi L. Masuda N. Recurrence quantification analysis of dynamic brain networks Eur. J. Neurosci. 2020 10.1111/ejn.14960
Mheich A. Hassan M. Khalil M. Berrou C. Wendling F. A new algorithm for spatiotemporal analysis of brain functional connectivity J. Neurosci. Methods 242 2015 77 81 10.1016/j.jneumeth.2015.01.002 25583381
Michel C.M. Koenig T. EEG microstates as a tool for studying the temporal dynamics of whole-brain neuronal networks: a review Neuroimage 180 B 2018 577 593 10.1016/j.neuroimage.2017.11.062 29196270
Michel C.M. Koenig T. Brandeis D. Electrical neuroimaging in the time domain Michel C.M. Koenig T. Brandeis D. Gianotti L.R.R. Wackermann J. Electrical Neuroimaging 2009 Cambridge University Press 111 143
Milz P. Faber P.L. Lehmann D. Koenig T. Kochi K. Pascual-Marqui R.D. The functional significance of EEG microstates - associations with modalities of thinking Neuroimage 125 2016 643 656 10.1016/j.neuroimage.2015.08.023 26285079
Milz P. Pascual-Marqui R.D. Achermann P. Kochi K. Faber P.L. The EEG microstate topography is predominantly determined by intracortical sources in the alpha band Neuroimage 162 2017 353 361 10.1016/j.neuroimage.2017.08.058 28847493
Murray M.M. Brunet D. Michel C.M. Topographic ERP analyses: a step-by-step tutorial review Brain Topogr. 20 2008 249 264 10.1007/s10548-008-0054-5 18347966
Musaeus C.S. Nielsen M.S. Høgh P. Microstates as disease and progression markers in patients with mild cognitive impairment Front. Neurosci. 13 2019 563 10.3389/fnins.2019.00563 31263397
Musso F. Brinkmeyer J. Mobascher A. Warbrick T. Winterer G. Spontaneous brain activity and EEG microstates. a novel EEG/fMRI analysis approach to explore resting-state networks Neuroimage 52 2010 1149 1161 10.1016/j.neuroimage.2010.01.093 20139014
Nishida K. Morishima Y. Yoshimura M. Isotani T. Irisawa S. Jann J. Dierks T. Strik W. Kinoshita T. Koenig T. EEG microstates associated with salience and frontoparietal networks in frontotemporal dementia, schizophrenia and Alzheimer’s disease Clin. Neurophysiol. 124 6 2013 1106 1114 10.1016/j.clinph.2013.01.005 23403263
Nolte G. The magnetic lead field theorem in the quasi-static approximation and its use for magnetoencephalography forward calculation in realistic volume conductors Phys. Med. Biol. 48 22 2003 3637 3652 10.1099/0031-9155/48/22/002 14680264
O’Neill G.C. Bauer M. Woolrich M.W. Morris P.G. Barnes G.R. Brookes M.J. Dynamic recruitment of resting state sub-networks Neuroimage 115 2015 85 95 10.1016/j.neuroimage.2015.04.030 25899137
O’Neill G.C. Tewarie P. Vidaurre D. Liuzzi L. Woolrich M.W. Brookes M.J. Dynamics of large-scale electrophysiological networks: a technical review Neuroimage 180 B 2018 559 576 10.1016/j.neuroimage.2017.10.003 28988134
Oostenveld R. Fries P. Maris E. Schoffelen J.M. Fieldtrip: open source software for advanced analysis of MEG, EEG, and invasive electrophysiological data Comput. Intell. Neurosci. 2011 2011 156869 10.1155/2011/156869 21253357
Palva J.M. Wang S.H. Palva S. Zhigalov A. Monto S. Brookes M.J. Schoffelen J.M. Jerbi K. Ghost interactions in MEG/EEG source space: anote of caution on inter-areal coupling measures Neuroimage 173 2018 632 643 10.1016/j.neuroimage.2018.02.032 29477441
Pascual-Marqui, R. D., 2007. Discrete, 3D distributed, linear imaging methods of electric neuronal activity. Part 1: exact, zero error localization. arXiv:0710.3341 [math-ph]URL http://arxiv.org/pdf/0710.3341.
Pascual-Marqui R.D. Theory of the EEG inverse problem Tong S. Thakor N. Quantitative EEG analysis: methods and clinical applications 2009 Artech House, Boston 121 140
Pascual-Marqui R.D. Legmann D. Faber P. Milz P. Kochi K. Yoshimura M. Nishida K. Isotani T. Kinoshita T. The resting microstate networks (RMN): cortical distributions, dynamics, and frequency specific information flow arXiv 2014 1411 1949
Pascual-Marqui R.D. Michel C.M. Lehmann D. Segmentation of brain electrical activity into microstates: model estimation and validation IEEE Trans. Biomed. Eng. 42 7 1995 658 665 10.1109/10.391164 7622149
Picton T.W. Human Auditory Evoked Potentials 2010 Plural Publishing, Inc. San Diego
Satopää V. Albrecht J. Irwin D. Raghavan B. Finding a “Kneedle” in a haystack: detecting knee points in system behavior 2011 31st International Conference on Distributed Computing Systems Workshops 2011 166 171 10.1109/ICDCSW.2011.20
Schumacher J. Peraza L.R. Firbank M. Thomas A.J. Kaiser M. Gallagher P. O’Brien J.T. Blamire A.M. Taylor J.P. Dysfunctional brain dynamics and their origin in Lewy body dementia Brain 142 6 2019 1767 1782 10.1093/brain/awz069 30938426
Seitzman B.A. Abell M. Bartley S.C. Erickson M.A. Bolbecker A.R. Hetrick W.P. Cognitive manipulation of brain electric microstates Neuroimage 146 2017 533 543 10.1016/j.neuroimage.2016.10.002 27742598
Sekihara K. Nagarajan S.S. Peoppel D. Marantz A. Performance of an MEG adaptive-beamformer technique in the presence of correlated neural activities: effects on signal intensity and time-course estimates IEEE Trans. Biomed. Eng. 49 2 2002 1534 1546 10.1109/TBME.2002.805485 12549735
Smailovic U. Koenig T. Laukka E.J. Kalpouzos G. Andersson T. Winblad B. Jelic V. EEG time signature in Alzheimer’s disease: functional brain networks falling apart Neuroimage Clin. 24 2019 102046 10.1016/j.nicl.2019.102046 31795039
Smith S.M. Fox P.T. Miller K.L. Glahn D.C. Fox P.M. Mackay C.E. Filippini N. Watkins K.E. Toro R. Laird A.R. Beckmann C.F. Correspondence of the brain’s functional architecture during activation and rest Proc. Natl. Acad Sci. U.S.A. 106 31 2009 13040 13045 10.1073/pnas.0905267106 19620724
Stolk A. Todorovic A. Schoffelen J.M. Oostenveld R. Online and offline tools for head movement compensation in MEG Neuroimage 68 2013 38 48 10.1016/j.neuroimage.2012.11.047
Taghia J. Cai W. Ryali S. Kockalka J. Nicholas J. Chen T. Vinod M. Uncovering hidden brain state dynamics that regulate performance and decision making during cognition Nat. Commun. 9 2018 2505 10.1038/s41467-018-04723-6 29950686
Tait L. Source reconstructed MEG - rest and auditory OSF 2021 10.17605/OSF.IO/DB9U4
Tait L. Tamagnini F. Stothart G. Barvas E. Monaldini C. Frusciante R. Volpini M. Guttmann S. Coulthard E. Brown J.T. Kazanina N. Goodfellow M. EEG microstate complexity for aiding early diagnosis of Alzheimer’s disease Sci. Rep. 10 2020 17627 10.1038/s41598-020-74790-7 33077823
Tait L. Zhang J. +microstate: A MATLAB toolbox for brain microstate analysis in sensor and cortical EEG/MEG bioRxiv 07 13 2021 452193 10.1101/2021.07.13.452193
Tait L. Özkan A. Szul M.J. Zhang J. A systematic evaluation of source reconstruction of resting MEG of the human brain with a new high-resolution atlas: performance, precision, and parcellation Hum. Brain Mapp. 42 14 2021 4685 4707 10.1002/hbm.25578 34219311
Tewarie P. Liuzzi L. O’Neill G.C. Quinn A.J. Griffa A. Woolrich M.W. Stam C.J. Hillebrand A. Brookes M.J. Tracking dynamic brain networks using high temporal resolution MEG measures of functional connectivity Neuroimage 200 2019 38 50 10.1016/j.neuroimage.2019.06.006 31207339
Tomescu M.I. Rihs T.A. Becker R. Britz J. Custo A. Grouiller F. Schneider M. Debbané M. Eliez S. Michel C.M. Deviant dynamics of EEG resting state pattern in 22q11.2 deletion syndrome adolescents: a vulnerability marker of schizophrenia? Schizophr. Res. 157 1–3 2014 175 181 10.1016/j.schres.2014.05.036 24962438
Treder M.S. MVPA-light: a classification and regression toolbox for multi-dimensional data Front. Neurosci. 14 289 2020 10.3389/fnins.2020.00289
Van De Ville D. Britz J. Michel C.M. EEG microstate sequences in healthy humans at rest reveal scale-free dynamics Proc. Natl. Acad Sci. U.S.A. 107 42 2010 18179 18184 10.1073/pnas.1007841107 20921381
van den Heuvel M.P. Hulshoff Pol H.E. Exploring the brain network: a review on resting state fMRI functional connectivity Eur. Neuropsychopharmacol. 20 8 2010 519 534 20471808
Vidaurre D. Hunt L.T. Quinn A.J. Hunt B.A.E. Brooked M.J. Nobre A.C. Woolrich M.W. Spontaneous cortical activity transiently organises into frequency specific phase-coupling networks Nat. Commun. 9 2018 2987 10.1038/s41467-018-05316-z 30061566
Vidaurre D. Quinn A.J. Baker A.P. Dupret D. Tejero-Cantero A. Woolrich M.W. Spectrally resolved fast transient brain states in electrophysiological data Neuroimage 126 2016 81 95 10.1016/j.neuroimage.2015.11.047 26631815
Vinck M. Oostenveld R. van Wingerden M. Battaglia F. Pennartz C.M.A. An improved index of phase-synchronization for electrophysiological data in the presence of volume-conduction, noise and sample-size bias Neuroimage 55 4 2011 1548 1565 10.1016/j.neuroimage.2011.01.055 21276857
Vrba J. Robinson S.E. Signal processing in magnetoencephalography Methods 25 2 2001 249 271 10.1006/meth.2001.1238 11812209
von Wegner F. Bauer S. Rosenow F. Triesch J. Laufs H. EEG microstate periodicity explained by rotating phase patterns of resting-state alpha oscillations Neuroimage 224 2021 117372 10.1016/j.neuroimage.2020.117372 32979526
von Wegner F. Knaut P. Laufs H. EEG microstate sequences from different clustering algorithms are information-theoretically invariant Front. Comput. Neurosci. 12 70 2018 10.3389/fncom.2018.00070
von Wegner F. Tagliazucchi E. Brodbeck V. Laufs H. Analytical and empirical fluctuation functions of the EEG microstate random walk - short-range vs. long-range correlations Neuroimage 141 2016 442 451 10.1016/j.neuroimage.2016.07.050 27485754
von Wegner F. Tagliazucchi E. Laufs H. Information-theoretical analysis of resting state EEG microstate sequences - non-Markovianity, non-stationarity and periodicities Neuroimage 158 2017 99 111 10.1016/j.neuroimage.2017.06.062 28673879
Xiaoku L. Chunlai Z. Zheng J. Yi M. Xiaoming S. Qi Z. Wencheng Z. Xia L. Jun G. Ruofan W. Jiang W. Haitao Y. Multiple characteristics analysis of Alzheimer’s electroencephalogram by power spectral density and Lempel-Ziv complexity Cogn. Neurodyn. 10 2016 121 133 10.1007/s11571-015-9367-8 27066150
Xu J. Pan Y. Zhou S. Zou G. Liu J. Su Z. Zou Q. Gao J.H. EEG microstates are correlated with brain functional networks during slow-wave sleep Neuroimage 215 2020 116786 10.1016/j.neuroimage.2020.116786 32276057
Yuan H. Zotev V. Phillpis R. Drevets W.C. Bodurka J. Spatiotemporal dynamics of the brain at rest - exploring EEG microstates as electrophysiological signatures of BOLD resting state networks Neuroimage 60 2012 2062 2072 10.1016/j.neuroimage.2012.02.031 22381593
Zappasodi F. Perrucci M.G. Saggino A. Croce P. Mercuri P. Romanelli R. Colom R. Ebisch S.J.H. EEG microstates distinguish between cognitive components of fluid reasoning Neuroimage 189 2019 560 573 10.1016/j.neuroimage.2019.01.067 30710677
Zhang Y. Wei S. Di Maria C. Liu C. Using Lempel-Ziv complexity to assess ECG signal quality J. Med. Biol. Eng. 36 2016 625 634 10.1007/s40846-016-0165-5 27853413
Zhou Q. Zhang L. Feng J. Zac Lo C.Y. Tracking the main states of dynamic functional connectivity in resting state Front. Neurosci. 13 2019 685 10.3389/fnins.2019.00685 31338016
Zoubi O.A. Misaki M. Tsuchiyagaito A. Mayeli A. Zotev V. Investigators T. Refai H. Paulus M. Bodurka J. Canonical EEG microstate dynamic properties and their associations with fMRI signals at resting brain bioRxiv 08 14 2020 251066 10.1101/2020.08.14.251066

