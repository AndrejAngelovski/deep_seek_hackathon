
==== Front
Nat Commun
Nat Commun
Nature Communications
2041-1723
Nature Publishing Group UK London

26704
10.1038/s41467-021-26704-y
Article
Sensory-motor cortices shape functional connectivity dynamics in the human brain
Kong Xiaolu 123
Kong Ru 123
http://orcid.org/0000-0001-9133-3561
Orban Csaba 123
http://orcid.org/0000-0002-3609-7954
Wang Peng 4
http://orcid.org/0000-0002-6352-9150
Zhang Shaoshi 1235
http://orcid.org/0000-0002-9446-7386
Anderson Kevin 6
http://orcid.org/0000-0001-6583-803X
Holmes Avram 78
http://orcid.org/0000-0003-4115-8181
Murray John D. 8
http://orcid.org/0000-0002-8995-7583
Deco Gustavo 910
van den Heuvel Martijn 11
http://orcid.org/0000-0002-0119-3276
Yeo B. T. Thomas thomas.yeo@nus.edu.sg

123512
1 grid.4280.e 0000 0001 2180 6431 Department of Electrical and Computer Engineering, National University of Singapore, Singapore, Singapore
2 grid.4280.e 0000 0001 2180 6431 Centre for Sleep & Cognition & Centre for Translational Magnetic Resonance Research, Yong Loo Lin School of Medicine, Singapore, Singapore
3 grid.4280.e 0000 0001 2180 6431 N.1 Institute for Health & Institute for Digital Medicine, National University of Singapore, Singapore, Singapore
4 grid.419524.f 0000 0001 0041 5028 Max Planck Institute for Human Cognitive and Brain Sciences, Leipzig, Germany
5 grid.4280.e 0000 0001 2180 6431 Integrative Sciences and Engineering Programme (ISEP), National University of Singapore, Singapore, Singapore
6 grid.38142.3c 000000041936754X Department of Psychology, Center for Brain Science, Harvard University, Cambridge, MA USA
7 grid.47100.32 0000000419368710 Department of Psychology, Yale University, New Haven, CT USA
8 grid.47100.32 0000000419368710 Department of Psychiatry, Yale University, New Haven, CT USA
9 grid.5612.0 0000 0001 2172 2676 Center for Brain and Cognition, Department of Technology and Information, Universitat Pompeu Fabra, Barcelona, Spain
10 grid.5841.8 0000 0004 1937 0247 Institució Catalana de la Recerca i Estudis Avançats, Universitat Barcelona, Barcelona, Spain
11 grid.509540.d 0000 0004 6880 3010 Department of Complex Trait Genetics, Amsterdam University Medical Center, Amsterdam, The Netherlands
12 grid.32224.35 0000 0004 0386 9924 Athinoula A. Martinos Center for Biomedical Imaging, Massachusetts General Hospital, Charlestown, MA USA
4 11 2021
4 11 2021
2021
12 637328 2 2021
7 10 2021
© The Author(s) 2021
https://creativecommons.org/licenses/by/4.0/ Open Access This article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons license, and indicate if changes were made. The images or other third party material in this article are included in the article’s Creative Commons license, unless indicated otherwise in a credit line to the material. If material is not included in the article’s Creative Commons license and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this license, visit http://creativecommons.org/licenses/by/4.0/.
Large-scale biophysical circuit models provide mechanistic insights into the micro-scale and macro-scale properties of brain organization that shape complex patterns of spontaneous brain activity. We developed a spatially heterogeneous large-scale dynamical circuit model that allowed for variation in local synaptic properties across the human cortex. Here we show that parameterizing local circuit properties with both anatomical and functional gradients generates more realistic static and dynamic resting-state functional connectivity (FC). Furthermore, empirical and simulated FC dynamics demonstrates remarkably similar sharp transitions in FC patterns, suggesting the existence of multiple attractors. Time-varying regional fMRI amplitude may track multi-stability in FC dynamics. Causal manipulation of the large-scale circuit model suggests that sensory-motor regions are a driver of FC dynamics. Finally, the spatial distribution of sensory-motor drivers matches the principal gradient of gene expression that encompasses certain interneuron classes, suggesting that heterogeneity in excitation-inhibition balance might shape multi-stability in FC dynamics.

Spontaneous fluctuations in brain activity exhibit complex spatiotemporal patterns across animal species. Here the authors show that sensory-motor regions and spatial heterogeneity in excitation-inhibition balance might shape multi-stability in brain dynamics.

Subject terms

Cognitive neuroscience
Network models
https://doi.org/10.13039/501100001381 National Research Foundation Singapore (National Research Foundation-Prime Minister’s office, Republic of Singapore) Class of 2017 Yeo B. T. Thomas National University of Singapore Yong Loo Lin School of Medicine (NUHSRO/2020/124/TMR/LOA)issue-copyright-statement© The Author(s) 2021
==== Body
pmcIntroduction

Spontaneous fluctuations in large-scale brain activity exhibit complex spatiotemporal patterns across animal species1–4. Inter-regional synchrony of resting-state brain activity averaged over several minutes (i.e., time-averaged static functional connectivity) has informed our understanding of brain network organization5–7, individual differences in behavior8,9, and mental disorders10,11. Recent studies have shown that additional important insights can be gained from studying moment-to-moment variation in inter-regional synchrony, i.e., time-varying dynamic functional connectivity12–16. However, it is currently unclear how spatial heterogeneity in local circuit properties contributes to both time-averaged and time-varying properties of large-scale brain dynamics.

Large-scale spontaneous brain activity is thought to arise from the reverberation of intrinsic dynamics of local circuits interacting across long-range anatomical connections17,18. Simulations of large-scale biophysically plausible models of coupled brain regions have provided mechanistic insights into spontaneous brain activity19–22. However, most previous large-scale circuit models assumed that local circuit properties (e.g., local synaptic strength, etc.) are identical across brain regions, which is not biologically plausible. Recent studies in both humans and macaques23–25 have demonstrated that allowing local circuit properties to vary along the brain’s hierarchical axis yielded significantly more realistic static functional connectivity (FC). However, these heterogeneous models have not been shown to recapitulate time-varying FC dynamics.

In this study, we developed a spatially heterogeneous mean-field model (MFM) to realistically capture time-varying FC dynamics. Local circuit heterogeneity can be informed by in-vivo structural and functional neuroimaging measures. For example, T1-weighted/T2-weighted (T1w/T2w) MRI estimates of intracortical myelin and the principal resting-state FC gradient have been shown to index anatomical26 and functional27 hierarchies, respectively. Parameterization of local circuit properties with T1w/T2w maps led to more realistic static FC than a spatially homogeneous mean-field model24. However, local circuit properties might be more strongly associated with the principal FC gradient than the T1w/T2w map25. Thus, we hypothesized that parameterizing local circuit properties with both the T1w/T2w map and the principal FC gradient might lead to a more realistic computational model, which we will refer to as the parametric mean-field model (pMFM). Using data from the Human Connectome Project (HCP), we demonstrated that pMFM achieved markedly more realistic static FC and FC dynamics in new out-of-sample participants.

Both empirical and pMFM-simulated FC dynamics demonstrated remarkably similar sharp transitions in FC patterns, suggesting the existence of multiple FC states or attractors. Previous studies have suggested that multi-stability in nonlinear brain systems might arise from noise-driven transitions between dynamic states or attractors22,28,29. These noise-driven transitions might be reflected in the amplitude of regional brain activity. Therefore, we further investigated the relationship between the amplitude of regional fMRI signals and transitions in functional connectivity dynamics in both empirical and pMFM-simulated data. We also performed causal perturbations of the large-scale circuit model to better understand the origins of FC multi-stability. Finally, the amplitude of regional fMRI signals has been linked with the gene expression markers of parvalbumin (PVALB) and somatostatin (SST) inhibitory interneurons30, in line with rodent studies suggesting that differential interneuron abundance may underlie regional variability in local cortical function31. Thus, we also investigated the spatial relationship among FC dynamics, fMRI signal amplitude, and gene expression patterns from the Allen Human Brain Atlas (AHBA).

The contributions of this study are multi-fold. First, we showed that heterogeneous local circuit properties, parameterized by both anatomical and functional gradients, are important for generating realistic models of static FC and FC dynamics. Second, in both pMFM simulations and empirical fMRI data, the regional fMRI amplitude of sensory-motor regions tracked state transitions in FCD. Causal perturbations of the pMFM provided further evidence that sensory-motor regions might be drivers of FCD. Finally, the spatial distribution of sensory-motor drivers appeared to match the differential expression of PVALB and SST, as well as the first principal component of brain-specific genes. Overall, this suggests a potential link between FC dynamics and heterogeneity in excitation/inhibition balance across the cortex.

Results

Optimization of the parametric mean-field model (pMFM)

1052 participants from the HCP S1200 release were randomly divided into training (N = 351), validation (N = 350), and test (N = 351) sets. The Desikan–Killiany anatomical parcellation32 with 68 cortical regions of interest (ROIs) was used to generate group-averaged structural connectivity (SC) and static functional connectivity (FC) matrices from the training, validation, and test sets separately. Analyses with a functional parcellation yielded similar conclusions (see “Control analyses” section). For each rs-fMRI run, time-varying functional connectivity was computed using the sliding window approach12,33. Briefly, for each rs-fMRI run, a 68 × 68 FC matrix was computed for each of 1118 sliding windows. Each window comprised 83 time points (or 59.76 s). The 68 × 68 FC matrices were then correlated across the windows, yielding a 1118 × 1118 functional connectivity dynamics (FCD) matrix for each run22,33.

The dynamic mean-field model (MFM) was used to simulate neural dynamics of the 68 cortical ROIs34. Based on the simulated neural activity at each ROI, the hemodynamic model35,36 was then used to simulate blood oxygen level-dependent (BOLD) fMRI. Details of the model can be found in the Methods section. Here we highlight the intuitions behind the MFM. In the MFM, the neural dynamics of each ROI are driven by four components: (1) recurrent (intra-regional) input, (2) inter-regional inputs, (3) external input (potentially from subcortical relays), and (4) neuronal noise. There are “free” parameters associated with each component. First, a larger recurrent connection strength w corresponds to a stronger recurrent input current. Second, the inter-regional inputs depend on the neural activities of other cortical ROIs and the connectional strength between ROIs. The inter-regional connectional strength is parameterized by the SC matrices, scaled by a global scaling constant G. Third, I is the external input current. Fourth, the neuronal noise is assumed to be Gaussian with a standard deviation σ.

In the current study, the recurrent connectional strength w, external input current I, and noise amplitude σ are each parameterized as a linear combination of the principal resting-state FC gradient27 and T1w/T2w myelin estimate37, resulting in 10 unknown linear coefficients. Both FC gradient and T1w/T2w map were estimated from the training set. We refer to the resulting model as parametric MFM (pMFM). The 10 unknown linear coefficients were automatically estimated by minimizing disagreement between the empirical and simulated BOLD signal (Fig. 1A).Fig. 1 Schematic of parametric mean-field model (pMFM) optimization.

A The pMFM comprised ordinary differential equations (ODEs) at each cortical region coupled by a structural connectivity (SC) matrix. The circuit-level parameters were allowed to vary across cortical regions, parameterized by a linear combination of resting-state functional connectivity (FC) gradient and T1w/T2w spatial maps. The pMFM was used to generate simulated static FC and functional connectivity dynamics (FCD). The Covariance Matrix Adaptation Evolution Strategy (CMA-ES) was used to estimate the pMFM by minimizing a cost function of disagreement with empirically observed FC and FCD. B The CMA-ES algorithm was applied to the Human Connectome Project (HCP) training set (N = 351) to generate 5000 candidate parameter sets. The top 10 candidate parameter sets were then selected from the 5000 candidate sets based on the model fit in the validation set (N = 350). Finally, these top 10 candidate sets were evaluated in the HCP test set (N = 351). Comparison of the pMFM with other parametrizations (Fig. 3 and Supplementary Fig. S3) utilized the same training-validation-test procedure.

More specifically, the simulated fMRI was used to compute a 68 × 68 static FC matrix and a 1118 × 1118 FCD matrix. The agreement between the simulated and empirical static FC matrices was defined as the Pearson’s correlation (r) between the z-transformed upper triangular entries of the two matrices. Larger r indicated more similar static FC. The disagreement between the simulated and empirical FCD matrices was defined as the Kolmogorov–Smirnov (KS) distance between the upper triangular entries of the two matrices22. A smaller KS distance indicated a more similar FCD. To optimize both static FC and FCD, an overall cost was defined as (1 − r) + KS and minimized in the training set. We considered three different minimization algorithms, each generating 5000 candidate sets of model parameters from the training set. Covariance matrix adaptation evolution strategy (CMA-ES38) performed the best in the validation set (Supplementary Fig. S1), so the 10 best CMA-ES parameter sets from the validation set were evaluated in the test set. The pMFM was compared with other parametrizations using the same training-validation-test procedure.

The pMFM yielded highly realistic functional connectivity dynamics

Figure 2A shows a representative empirical FCD from a participant in the test set. Figure 2B shows a simulated FCD generated by the pMFM using the best model parameters (from the validation set) using SC from the test set. Both empirical and simulated FCD exhibited red off-diagonal blocks representing recurring FC patterns. Across the 10 best candidate sets from the validation set, KS distance between empirical and simulated FCD was 0.12 ± 0.03 (mean ± std) in the test set.Fig. 2 Parametric mean-field model (pMFM) generates more realistic static functional connectivity (FC) and functional connectivity dynamics (FCD) than a previous spatially heterogeneous MFM25.

A Empirical FCD from a participant from the HCP test set. B Simulated FCD from the pMFM using the best model parameters from the validation set using structural connectivity (SC) from the test set. C Agreement (Pearson’s correlation) between empirically observed and pMFM-simulated static FC using the best model parameters from the validation set using structural connectivity (SC) from the test set. D Simulated FCD generated by the previously published spatially heterogeneous MFM25. Source data are provided as a Source Data file.

Across the 10 best candidate sets from the validation set, correlation between empirical and simulated static FC was 0.66 ± 0.03 in the test set. As a reference, the correlation between SC and static FC in the test set was 0.28. Figure 2C shows the correlation between empirical and pMFM-simulated static FC obtained from applying the best model parameters from the validation set to SC from the test set.

Figure 2D shows the simulated FCD using the MFM parameters from our previous study25. The almost constant values in off-diagonal elements suggest a lack of realistic FC dynamics. KS distance between empirical and simulated FCD was 0.88. Correlation between static empirical and simulated static FC was 0.48. Thus, the pMFM was able to generate much more realistic static FC and FCD than the MFM25.

Combining anatomical and functional gradients generated more realistic brain dynamics

In the previous section, we demonstrated that pMFM was able to generate realistic static FC and FCD. To explore what aspects of pMFM are important for generating realistic static FC and FCD, we performed a number of control analyses. First, we investigated the importance of utilizing both anatomical and functional gradients in generating realistic static FC and FCD. Most large-scale circuit model studies assume spatially homogeneous parameters. When recurrent connectional strength w, external input current I, and noise amplitude σ were optimized by CMA-ES, but constrained to be spatially homogeneous (Fig. 3), there was a substantially weaker agreement with empirical static FC (r = 0.55 ± 0.05) and FCD (KS = 0.50 ± 0.31) in the test set. Similarly, spatial heterogeneity for all three parameters (w, I, and σ) were necessary to generate the most realistic static FC and FCD in the test set (Supplementary Fig. S2A–C).Fig. 3 Importance of multiple spatial gradients for generating realistic static functional connectivity (FC) and functional connectivity dynamics (FCD).

A Simulated FCD from a mean-field model (MFM) optimized using the same algorithm as pMFM, but with model parameters constrained to be the same across cortical regions. B Agreement between empirically observed and simulated static FC from MFM optimized using the same algorithm as pMFM, but with model parameters constrained to be the same across cortical regions. C Agreement (Pearson’s correlation) between simulated and empirically observed static FC, as well as disagreement (KS distance) between simulated and empirically observed FCD across different conditions in the test set. Each boxplot comprises 10 correlation values (left) or 10 KS statistic (right) based on the 10 best candidate sets from the validation set. The boxes show the inter-quartile range (IQR) and the median. Whiskers indicate 1.5 IQR. Black crosses represent outliers. The pMFM utilizing both anatomical and functional gradients (FC gradient and T1w/T2w spatial maps) performed the best, suggesting that T1w/T2w and FC gradient provided complementary contributions. * indicates statistical significance after correcting for multiple comparisons with a false discovery rate (FDR) of q < 0.05. All p values are reported in Supplementary Table S1. Source data are provided as a Source Data file.

Second, if recurrent connectional strength w, external input current I, and noise amplitude σ were parameterized with only T1w/T2w24 or only FC gradient, then the resulting static FC and FCD were less realistic in the test set (Fig. 3C). Furthermore, if recurrent connectional strength w, external input current I, and noise amplitude σ were allowed to be spatially heterogeneous across brain regions, but not constrained by T1w/T2w or FC gradient (i.e., non-parametric), then simulations could achieve realistic static FC, but not FCD in the test set (Supplementary Fig. S2D). One reason could be the large number of “free” parameters leading to overfitting in the training set.

Supplementary Table S1 provides summary statistics of the two metrics (FC correlation and FCD KS statistic) in the training, validation, and test sets. The pMFM was statistically better than the spatially homogeneous MFM for both metrics in the test set. Compared with other alternative parameterizations, pMFM was statistically better in one metric and statistically comparable in the other metric.

Finally, instead of fitting to both static FC and FCD in the training set, we also tried fitting only to static FC. Not surprisingly, the resulting model yielded unrealistic functional connectivity dynamics (Supplementary Fig. S3; KS = 0.88 ± 0.01). On the other hand, correlation between static empirical and simulated static FC was 0.73 ± 0.01, which was only slightly better than when optimizing both static FC and FCD (Fig. 2C). This suggests that the goals of generating realistic static FC and FCD were not necessarily contradictory.

Overall, these results suggest the importance of parameterizing recurrent connectional strength w, external input current I, and noise amplitude σ with spatial gradients that smoothly varied from sensory-motor to association cortex. Furthermore, T1w/T2w and FC gradient are complementary in the sense that combining the two spatial maps led to more realistic static FC and FCD (Fig. 3).

Technical considerations and interpretations

It is worth emphasizing that the different parameterizations were compared with the same training-validation-testing procedure (Fig. 1B), which automatically controls for model complexity or degrees of freedom. A more complex model will generally fit the training data better but might not perform well in the test set. For example, when recurrent connectional strength w, external input current I, and noise amplitude σ were allowed to be spatially heterogeneous across brain regions, but not constrained by T1w/T2w or FC gradient (i.e., non-parametric), then simulations could achieve realistic static FC, but not FCD in test set (Supplementary Table S1). This is an example, where a more flexible model (205 free parameters) yielded an excellent fit in the training and validation sets but a significantly worse fit in the test set.

In all the previous analyses, the overall cost was defined as (1 − r) + KS, which placed equal weights on fitting FC and FCD. When the relative weights of FC and FCD were altered, combining both T1w/T2w map and FC gradient still yielded better test set performance than either T1w/T2w map or FC gradient alone (Supplementary Fig. S4). Although the original analysis (Fig. 3) suggested that T1w/T2 map explained FCD better than FC gradient, this was no longer the case when the relative weights were altered (Supplementary Fig. S4). On the other hand, FC gradient was better than T1w/T2w map at explaining static FC across the three experiments (Figs. 3 and Supplementary Fig. S4), which made intuitive sense given that FC gradient was derived from static FC. However, we note that the analyses were not circular given that the FC gradient was derived from the training set and performance was evaluated on the test set.

Opposite gradient directions in recurrent connection strength, noise amplitude, and external input

Figure 4B–D illustrates the spatial distribution of recurrent connection strength w, external input current I, and noise amplitude σ based on the best parameter estimate from the validation set. The black lines indicate seven resting-state network boundaries (Fig. 3A39). While the resting-state network boundaries do not exactly align with the anatomically defined parcels, there was a striking correspondence between the resting-state networks and estimated pMFM parameters. Given the parameterization of pMFM by a linear combination of FC gradient27 and T1w/T2w spatial maps24, it was not surprising that the parameter estimates exhibited a hierarchical gradient of values monotonically changing from sensory-motor to association networks (right column of Fig. 4B–D).Fig. 4 Spatial distribution of recurrent connection strength w, external input current I, and noise amplitude σ, and their relationships with resting-state networks.

A Seven resting-state networks39. B Strength of recurrent connection w in 68 Desikan–Killiany cortical ROIs (left) and seven resting-state networks (right). C Strength of external input I in 68 Desikan–Killiany cortical ROIs (left) and seven resting-state networks (right). D Strength of noise amplitude σ in 68 Desikan–Killiany cortical ROIs (left) and seven resting-state networks (right). The boxplots comprised values obtained by “transferring” the parameter estimates from the 68 Desikan–Killiany parcels to all vertices (from the underlying cortical meshes) comprising each anatomical parcel. The vertex wise parameter values were then segregated based on the seven resting-state networks. Therefore, there were 3203, 2478, 1523, 1520, 1067, 1438, and 2886 values comprising the boxplots for somatomotor, visual, dorsal attention, ventral attention, limbic, control, and default networks, respectively. The boxes show the inter-quartile range (IQR) and the median. Whiskers indicate 1.5 IQR. Black crosses represent outliers. Recurrent connection strength and noise amplitude increased from sensory-motor to association (limbic, control, and default) networks. On the other hand, external input current was the highest in sensory-motor networks and decreased towards the default network. Source data are provided as a Source Data file.

However, the gradient directions were different across the three parameters. In particular, both recurrent connection strength and noise amplitude appeared to increase from sensory-motor to association (limbic, control, and default) networks. On the other hand, external input current was the highest in sensory-motor networks and decreased towards the default network. The directionalities of noise amplitude and external input current were consistent across all the top ten parameter estimates from the validation set. In the case of recurrent connection strength, one of the ten parameter sets exhibited the opposite direction (i.e., decrease from sensory-motor regions to association networks; Supplementary Fig. S5), suggesting potential degeneracy in the case of recurrent connection strength.

The previous analysis was “biased” to find degeneracy given that the top 10 parameter sets were selected to ensure diversity (see “Methods” section). To further explore the degeneracy issue, the recurrent connection strength map of the top parameter set (from the validation set) was correlated with the recurrent connection strength maps of the remaining 4999 candidate parameter sets (Supplementary Fig. S6). In general, parameter sets with good validation cost were strongly correlated with the top parameter estimate from the validation set. Similar conclusions were obtained for external input and noise amplitude, although external input appeared to be less stable than recurrent connection strength and noise amplitude.

Time-varying amplitude of regional fMRI time courses tracks time-varying functional connectivity

Given that the pMFM was able to generate realistic FCD, we now seek to use the pMFM to provide further insights into mechanisms underlying FCD. Previous studies have suggested that FCD might arise from switching between multi-stable states22,29. Indeed, a magnified portion of the FCD matrix from a HCP test participant (Fig. 5A) suggests the presence of at least two distinct states. In one state (white asterisk in Fig. 5A), the sliding window FC pattern appeared to be coherent over a time period. In a second state (black asterisk in Fig. 5A), the sliding window FC patterns were incoherent over another time period, so the high correlations within the block were restricted to the diagonals, and likely driven by autocorrelation in the fMRI signals and overlapping sliding windows. We hypothesized that fMRI signals might be dominated by large coherent amplitude fluctuations during the coherent state and dominated by noise during the incoherent state (right panel in Fig. 5A; see ref. 40 for a review of multi-stability). If our hypothesis were true, we would expect large regional fMRI signal amplitude during the coherent state and small regional fMRI signal amplitude during the incoherent state.Fig. 5 Correspondence between functional connectivity dynamics (FCD) and time-varying amplitude of regional fMRI time courses.

A Inspection of FCD from a HCP test participant suggests at least two states. The first state (white asterisk) exhibits coherent FC patterns over a period of time. The second state (black asterisk) exhibits incoherent FC patterns over a period of time. The right panel illustrates our hypothesis that the coherent state might be characterized by large coherent amplitude in regional fMRI signals, i.e., high standard deviation (STD), while the incoherent state might be characterized by noise in regional fMRI signals, i.e., low standard deviation (STD). B Top panel shows empirical FCD matrix of a HCP test participant. The middle panel shows the FCD mean time course obtained by averaging the rows of the FCD matrix from the top panel. The bottom panel shows the standard deviation of each regional fMRI time course within each sliding window (SW-STD). The color of the lines corresponds to the correlation between the first derivative of the FCD mean time course and the first derivative of the SW-STD time courses. Sharp transitions in SW-STD corresponded to sharp FCD transitions (red dashed lines). C Same as B, but simulated from pMFM using the best model parameters from the validation set and structural connectivity from the test set. D SW-STD during coherent (high FCD mean) and incoherent (low FCD mean) states. Boxplots illustrate the variation across HCP test participants. Coherent states were characterized by large amplitude (STD) in fMRI signals (p = 2.4e−168). The p-value was computed from a two-sided t-test and survived the false discovery rate (q < 0.05). E Same as D, but simulated from pMFM. There are 349 and 1000 independent samples for the boxplots in D and E, respectively. The boxes show the inter-quartile range (IQR) and the median. Whiskers indicate 1.5 IQR. Red crosses represent outliers. Source data are provided as a Source Data file.

To test our hypothesis, the standard deviation of the average fMRI signal of each cortical ROI within each sliding window was computed. Figure 5B (top panel) shows the FCD matrix of a single participant from the HCP test set. Figure 5C (top panel) shows the simulated FCD matrix from the pMFM using the best model parameters from the validation set and structural connectivity (SC) from the test set. The middle panels of Fig. 5B, C show the FCD mean time course obtained by averaging the rows of the FCD matrices from the top panels. Sharp transitions in the FCD mean time course reflected sharp transitions in the FCD matrix. The bottom panel shows the sliding window standard deviation (SW-STD) of empirical and simulated fMRI signals. There was striking correspondence between sharp transitions in the FCD mean time course and SW-STD time courses in both empirical and simulated data (red dashed lines in Fig. 5B, C).

Consistent with our hypothesis, there was a large signal amplitude during the coherent state and low signal amplitude during the incoherent state (Fig. 5B). To quantify this phenomenon, for each run of each participant in the HCP test set, we fitted a mixture of two Gaussian distributions to the histogram of the FCD mean28. The cross-over point of the two Gaussian distributions was used to threshold the FCD mean. Time points with FCD mean greater than the threshold were designated as the coherent state (high FCD mean), while time points with FCD mean lower than the threshold were designated as the incoherent state (low FCD mean). The SW-STD was then averaged across all cortical regions and all runs of each participant. As shown in Fig. 5D, the SW-STD was significantly higher during the coherent state than the incoherent state (p = 6.9e–150). Similar results were obtained for the pMFM simulations (Fig. 5E). The dwell time distributions of the two states were also similar between the empirical and simulated data (Supplementary Fig. S7). The two distributions appeared to follow an exponential distribution (as opposed to a Gamma distribution), suggesting the presence of multi-stability rather than meta-stability40.

Sensory-motor regions drive switching behavior in functional connectivity dynamics

In the previous section, we found a striking correspondence between the FCD mean time course and the regional SW-STD time courses (Fig. 5B, C). We note that the FCD mean time course reflected cortex-wide fluctuations in FC patterns, while SW-STD time courses were region-specific. Therefore, to investigate regional heterogeneity of FCD-STD correspondence (Fig. 5) across the cortex, the correlation between the first derivative of the FCD mean time course and the first derivative of the SW-STD time course was computed for each cortical region. In the case of empirical observations, the FCD-STD correlations were averaged across all runs of all participants in the test set yielding a final FCD-STD correlational spatial map (Fig. 6A). In the case of pMFM simulations, the correlations were averaged across 1000 random simulations using the best model parameters from the validation set using structural connectivity (SC) from the test set, yielding a final FCD-STD correlational spatial map (Fig. 6B).Fig. 6 Sensory-motor regions drive sharp transitions in functional connectivity dynamics (FCD).

A FCD-STD correlations obtained by correlating the first derivative of the FCD mean time course and the first derivative of the SW-STD time course of each cortical region. These correlations were performed for each HCP test participant and averaged across all runs and participants. B Same as A but simulated from pMFM using the best model parameters from the validation set and structural connectivity from the test set. The correlations were averaged across 1000 random simulations. C Correlation between empirical and simulated FCD-STD correlation spatial maps from B and C, showing strong correspondence between empirical and simulated results. D Casual perturbation of top 5 FCD-STD correlated regions (B) during the incoherent state (low FCD mean) led to a transition into the coherent state (high FCD mean). As a control analysis, perturbation of the bottom 5 FCD-STD correlated regions (B) during the incoherent state (low FCD mean) did not lead to a state change (FCD mean remains low). There are 297 independent samples for each boxplot in D. The boxes show the inter-quartile range (IQR) and the median. Whiskers indicate 1.5 IQR. Red crosses represent outliers. E Example FCD from the perturbation experiments. (Left) original incoherent state. (Middle) perturbation of top 5 FCD-STD correlated regions (sensory-motor drivers). (Right) perturbation of bottom 5 FCD-STD correlated regions. Source data are provided as a Source Data file.

Statistical significance was established using a permutation test (see “Methods” section). Almost all cortical regions were significant after correcting for multiple comparisons (FDR q < 0.05; Fig. S8). Across both pMFM simulations and empirically observed data, FCD-STD correlations were the highest in sensory-motor regions and lowest in the association cortex. There was strong spatial correspondence between simulated and empirical results (r = 0.87; Fig. 6C). We note that the pMFM was optimized to yield realistic FCD with no regard for spatial correspondence, so the high level of spatial correspondence suggests that the pMFM was able to generalize to new unseen properties of FCD.

To explore the causal relationship between sensory-motor regions and FCD, we tested whether perturbation of sensory-motor regions could “kick” the system from an incoherent FCD state to a coherent FCD state. Among 1000 random simulations of pMFM, time segments in the incoherent state (low FCD mean) lasting for at least 200 contiguous fMRI time points were selected. The neural signals of the top five FCD-STD regions (sensory-motor drivers; Fig. 6B) were then perturbed to increase their amplitude. The perturbation led to the successful transition of the FCD into a more coherent state with a higher FCD mean (p = 6e–14; Fig. 6D). Perturbation of the bottom five FCD-STD regions (Fig. 6B) did not lead to an increase in FCD mean. Figure 6E illustrates the example results of the perturbation experiment. Similar results were obtained if we perturbed the top 10 and bottom 10 regions. Overall, this suggests that sensory-motor regions were a driver of switching behavior in FCD.

Parvalbumin–somatostatin and first genetic principal component correlate with sensory-motor drivers of time-varying functional connectivity dynamics

Results from the previous sections suggest that time-varying amplitude of sensory-motor regions tracks switching behavior in time-varying functional connectivity. A recent study30 demonstrated that the difference in the spatial distribution of molecular markers of parvalbumin and somatostatin interneurons (PVALB-SST) is linked with the amplitude of regional fMRI signals (Fig. 7A). This intriguing finding is in line with data in rodents documenting the importance of these interneuron classes in local cortical circuit function31. Inspection of the cortical distribution of PVALB-SST transcripts from the Allen Human Brain Atlas (AHBA) dataset (Fig. 7A) suggests a strong similarity with the FCD-STD correlational spatial maps (Fig. 6).Fig. 7 Correlations between the spatial distribution of sensory-motor drivers (FCD-STD correlational spatial maps) and gene expression spatial maps.

A Difference in normalized expressions of parvalbumin and somatostatin (PVALB-SST) from the Allen Human Brain Atlas (AHBA). Panel is a re-rendering of ref. 30. B Correlation between empirical FCD-STD correlational map (Fig. 6B) and PVALB-SST gene expression map. C Correlation between simulated FCD-STD correlational map (Fig. 6C) and PVALB/SST gene expression map. D Table of correlations between FCD-STD correlational spatial maps and two gene expression maps: PVALB-SST and first principal component of gene expression26,43. The “spin test” tested the significance of the correlations while controlling for spatial autocorrelation. The “random gene pair” tested for the specificity of PVALB-SST by randomly sampling pairs of brain-specific genes. P-values that survived the false discovery rate (q < 0.05) are bolded. Standard deviations reported in the table were obtained by bootstrapping. Source data are provided as a Source Data file.

PVALB-SST (Fig. 7A) was averaged within each cortical ROI and correlated with the FCD-STD correlational spatial maps (Fig. 6). The correlations were 0.72 and 0.65 for the empirical (Fig. 7B) and simulated (Fig. 7C) data, respectively. As shown in Fig. 7D, both correlations were significant based on spin-tests preserving spatial autocorrelation41,42. To test for specificity of PVALB-SST, a null distribution was also generated based on random pairs of brain-specific genes. Both correlations were again significant (Fig. 7D). Overall, this suggests that the spatial distribution of sensory-motor drivers was associated with the differential expression of PVALB and SST

Given that previous studies have suggested the existence of multiple similar gene expression gradients, the first principal component of AHBA brain-specific gene expression data26,43 was correlated with the FCD-STD correlational spatial maps (Fig. 6). The first gene expression principal component was also correlated with both empirical and simulated FCD-STD spatial maps, although the correlations were slightly weaker than the correlations with the PVALB-SST gene expression map (Fig. 7D).

The recurrent connection strength w and noise amplitude σ were also correlated with the PVALB-SST gene expression map under the spin-test, but not the random-gene-pair tests. This suggests a lack of specificity to PVALB-SST (Fig. 7D). The external input I was not correlated with any gene expression pattern.

Specificity of T1w/T2w map and FC gradient

We have shown that combining T1w/T2w map and FC gradient led to more realistic brain dynamics than using either no gradient or only one gradient (Fig. 3). To further explore the specificity of the parameterization, we repeated the training-validation-test procedure (Fig. 1B) using randomly rotated versions of T1w/T2w map and/or FC gradient. Despite having the same degrees of freedom as the original pMFM, the rotated parameterizations led to a worse fit to static FC and/or FCD in the test set (Supplementary Fig. S9).

We also repeated the training-validation-test procedure with alternate gradient maps, including the second FC gradient27, inter-subject functional connectivity variability map44, first structural covariance gradient45, and the first genetic principal component (Supplementary Fig. S10). To provide additional context, Supplementary Fig. S10 shows the correlations among the different gradient maps and the top estimated model parameters (w, I, σ) from the original pMFM (Fig. 4).

The estimated model parameters were most strongly correlated with the first principal gradient, although we note that the first principal gradient alone did not lead to the best performance in the test set (Supplementary Fig. S10). Instead, the best single parameterization was the T1w/T2w map. Combining T1w/T2w map with the first FC gradient (i.e., original pMFM) led to the best performance in the test set, but the improvement was not statistically significant when the T1w/T2w map was replaced with inter-subject FC variability, the first genetic principal component or second FC gradient. However, we note that in these cases, the resulting FCD-STD correlation maps remained highly similar to the original FCD-STD map (Fig. 6B) with correlations >0.9, suggesting that these cortical features may index similar underlying mechanisms.

Control analyses

To ensure the robustness of results, we performed several control analyses. First, we note that the simulation of pMFM utilized 10 ms time step. To ensure that this time step was sufficiently small, the best model parameters from the validation set were applied to the test set using 1 ms time step. KS distance between empirical and simulated FCD in the test set was 0.11 ± 0.05. The correlation between empirical and simulated static FC was 0.66 ± 0.03.

Second, the previous analyses utilized a sliding window comprising 83 time points for computing FCD. To ensure the model parameters generalized to different window lengths, empirical and simulated FCD was computed in the test set using window lengths of 43 and 125. KS distance between empirical and simulated FCD in the test set was 0.15 ± 0.07 and 0.14 ± 0.04 for window lengths 43 and 125, respectively.

Third, we investigated whether the FCD-STD correlation maps (Fig. 6) might be influenced by global signal fluctuation. We repeated the analysis by restricting to 50 test participants with the lowest global signal fluctuation. The resulting FCD-STD correlation map was very similar to the original results (r = 0.82).

Fourth, although time-varying FC was represented using the FCD matrix (Fig. 2A), other representations could be possible. Zalesky and colleagues explored time-varying FC by computing time-varying network efficiency for each sliding window13. They found high and low-efficiency states, which appeared to correspond to the high and low coherent states in the FCD matrix (Supplementary Fig. S12A). The pMFM also captured these high and low-efficiency states in test set (Supplementary Fig. S12B). On the other hand, the spatially homogeneous MFM could generate high and low-efficiency states in the training set, but not the test set (Supplementary Fig. S12C, D).

Fifth, we replicated our results with a higher resolution parcellation with 100 cortical ROIs46. Consistent with our main results, we found that pMFM yielded more realistic simulated FC and FCD in the test set (Supplementary Fig. S13) compared with our previous study25. Across all 10 best parameter sets from the validation set, noise amplitude increased from sensory-motor to association (limbic, control, and default) networks, while external input exhibited the opposite direction. In 8 of the 10 best parameter sets, recurrent connect strength increased from sensory-motor to association (limbic, control, and default) networks, thus again suggesting potential degeneracy (Supplementary Fig. S14).

In the Schaefer parcellation, time-varying amplitude of sensory-motor time courses tracks switching behavior in time-varying functional connectivity (Supplementary Figs. S15 and S16). Causal perturbation analysis also confirmed that sensory-motor regions appeared to drive transitions in FCD (Supplementary Fig. S16). Both simulated and empirical FCD-STD correlation maps were correlated with PVALB-SST gene expression maps (Supplementary Table S2). Both correlations were significant under the spin-test and random gene-pair tests. The simulated, but not the empirical, FCD-STD correlation maps were correlated with the first principal component of gene expression.

Finally, to explore the possibility of individual-level pMFMs, we considered 12 participants from the HCP test-retest dataset that overlapped with our test set. There were four MRI sessions for each participant. The first two sessions and the last two sessions were on average 3.8 ± 1.5 months apart. Similar to previous analyses, the pMFM was optimized using group-level FC gradient and group-level T1w/T2w map from the training set. The main difference is that the model was optimized using group-level SC from the test set, as well as static FC and FCD from the first two sessions of individual participants. The top 10 parameter sets from the first two sessions were then evaluated in the remaining two sessions. We found that combining T1w/T2w map and FC gradient yielded more realistic static FC and FCD than using T1w/T2w map or FC gradient alone at the individual level (Fig. 8). Future studies will explore whether individual-level FC gradient, T1w/T2w map, and SC could bring further benefits to individual-level MFMs.Fig. 8 At the individual-level, pMFM parameterized by both group-level FC gradient and T1w/T2w map yielded more realistic static FC and FCD than FC gradient or T1w/T2w map alone.

A Agreement (Pearson’s correlation) between simulated and empirically observed static FC in the test sessions of individual participants. B Disagreement (KS distance) between simulated and empirically observed FCD in the test sessions of individual participants. C Total cost in the test sessions of individual participants. Each boxplot comprises 12 FC correlation values, 12 FCD KS or 12 total cost values of the 12 individual participants. The boxes show the inter-quartile range (IQR) and the median. Whiskers indicate 1.5 IQR. Black crosses represent outliers. *Indicates statistical significance after correcting for multiple comparisons with a false discovery rate of q < 0.05. Source data are provided as a Source Data file.

Discussion

By incorporating anatomical and functional gradients into the parameterization of local circuit properties, the resulting large-scale circuit model generated realistic time-averaged (static) and time-varying (dynamic) properties of large-scale spontaneous brain activity. Both empirical and simulated fMRI data exhibited multi-stable properties, in which there was spontaneous switching between a high coherent state and a low coherent state. The multi-stability was tracked by the time-varying amplitude of regional fMRI signals. By performing causal perturbations of the large-scale circuit model, we demonstrated that spontaneous amplitude fluctuations of sensory-motor regions were a driver of the observed switching behavior. Furthermore, the relationship between regional fMRI amplitude and functional connectivity dynamics was also associated with PVALB-SST and the first principal component of gene expression, suggesting that heterogeneity in excitation-inhibition balance might shape multi-stability in FC dynamics.

Anatomical and functional gradients contribute to spontaneous brain dynamics

Previous studies have proposed a dominant gradient of cortical organization with sensory-motor and association regions at opposing ends47. Supporting this idea of a dominant axis, many studies have emphasized similarities among gradients estimated from diverse sources, including resting-state FC principal gradient, T1w/T2w myelin estimate, gene expression data, functional task activation, and computational modeling25–27,48,49. Yet, there are clear differences among the gradients and a growing number of studies have suggested dissociations among multiple spatially similar gradients45,50,51. Here, we showed that by parameterizing local circuit parameters with both anatomical (T1w/T2w) and functional (FC) gradients, the resulting mean-field model was able to generate dramatically more realistic static FC and FC dynamics than either gradient alone (Fig. 3).

Our control analysis with alternate gradient maps suggests that combining the T1w/T2w map with the first FC gradient led to the best performance, but T1w/T2w could be replaced with inter-subject FC variability, first genetic principal component, or second FC gradient without statistically significant loss in performance. Furthermore, while it made intuitive sense that utilizing the resting-state FC gradient would help to explain resting-fMRI dynamics, the training-validation-test scheme ensured the analysis was not circular.

The optimized mean-field model exhibited opposing gradient directions across local circuit parameters (Fig. 4). Across all top ten parameter sets, noise amplitude increased from sensory-motor to association cortex, while external input decreased from sensory-motor to association cortex. The higher external input in sensory-motor regions might reflect the flow of sensory information from the external environment via subcortical relays. In the case of the recurrent connection strength, nine of the ten best parameter sets exhibited increasing values from sensory-motor to association cortex, but one parameter set exhibited the opposite direction. Thus, recurrent connection strength might exhibit potential degeneracies in mean-field models, thus explaining contradictions in the literature24,25.

Multi-stability in spontaneous brain dynamics

The spontaneous ebb and flow observed in FC dynamics is an intriguing property that has fascinated the field12,14,22,33,52,53. As shown in Fig. 5A, there are periods of brain activity with strong coherent FC and periods with incoherent FC. We found that the coherent FC state was characterized by larger fMRI signal amplitude across brain regions, while the incoherent FC state was characterized by smaller fMRI signal amplitude (Fig. 5). Intriguingly, transitions in the regional amplitude of sensory-motor regions appeared to track switching behavior in FC dynamics (Fig. 6). Perturbations of the mean-field model suggest that this relationship might be causal.

Regional fMRI amplitude has been previously linked with the differential expression of PVALB and SST across the cortex30. PVALB and SST interneurons preferentially target perisomatic regions and dendrites of pyramidal cells, respectively, and are thought to regulate synaptic outputs and inputs, respectively54. Thus the spatially heterogeneous distribution of PVALB and SST interneurons31 might modulate regional neural signal amplitude30. Here, we found that PVALB-SST gene expression map correlates with the spatial distribution of sensory-motor drivers whose time-varying amplitude tracks functional connectivity dynamics (Fig. 7).

However, we note that this association cannot be solely attributed to PVALB-SST given that the gradients of PVALB-SST expression are embedded within a broader pattern of gene expression variation across the cortex26,43. Indeed, the spatial distribution of sensory-motor drivers was also correlated with the first principal component of cortical genes (Fig. 7). The first gene principal component has been shown to strongly correlate with the spatial distribution of genes coding for different excitatory and inhibitory neurons26, which might reflect spatial heterogeneity in excitation-inhibition balance55. Overall, this suggests a potential link between FC dynamics and heterogeneity in excitation/inhibition balance across the cortex.

Methods

Data

We considered 1052 participants from the Human Connectome Project (HCP) S1200 release56. All participants were scanned on a customized Siemens 3T Skyra using a multi-band sequence. Four resting-state fMRI (rs-fMRI) runs were collected for each participant in two sessions on two different days. Each rs-fMRI run was acquired with a repetition time (TR) of 0.72 s at 2 mm isotropic resolution and lasted for 14.4 min. The diffusion imaging consisted of 6 runs, each lasting ~9 min and 50 s. Diffusion weighting consisted of 3 shells of b = 1000, 2000, and 3000 s/mm2 with an approximately equal number of weighting directions on each shell. Details of the data collection can be found elsewhere56. The 1052 subjects were randomly divided into training (N = 351), validation (N = 350) and test (N = 351) sets.

Data collection was approved by a consortium of institutions institutional review boards (IRBs) in the United States and Europe, led by Washington University (St Louis) and the University of Minnesota (WU-Minn HCP Consortium). The current study was approved by the IRB of the National University of Singapore.

Preprocessing

Details of the HCP preprocessing can be found in the HCP S1200 manual. We utilized rs-fMRI data, which had already been projected to fsLR surface space, denoised with ICA-FIX and smoothed by 2 mm. For each run of each participant, the fMRI data were averaged within each Desikan–Killiany32 ROI to generate a 68 × 1200 matrix. Each 68 × 1200 matrix was used to compute 68 × 68 FC matrix by correlating the time courses among all pairs of time courses. The FC matrices were then averaged across runs of participants within the training (or validation or test) set, resulting in a group-averaged training (or validation or test) FC matrix.

Functional connectivity dynamics (FCD) was computed as follows. For each run of each participant, FC was computed within each of 1118 sliding windows. The length of each sliding window was 83 time points (60 s) as recommended by previous studies33,57. We note that our results were robust to window length (see “Control analysis” in the Results section). Each sliding window FC matrix was then vectorized by only considering the upper triangular entries. The vectorized FCs were correlated with each other generating a 1118 × 1118 FCD matrix.

In the case of diffusion MRI, generalized Q-sampling imaging (GQI) was used to reconstruct the white matter pathways, allowing for complex diffusion fiber configurations and streamline tractography58. A 68 × 68 structural connectivity (SC) matrix was generated for each subject, where each entry corresponded to the number of streamlines between two ROIs. To generate a group-level SC matrix, a thresholding procedure was employed to remove false positives. More specifically, if <50% of participants had a non-zero value in a particular entry in the SC matrix, then the entry is set to zero in all individual-level SC matrices. For each SC entry, the number of streamlines was averaged across participants with non-zero streamlines. Separate group-level SC matrices were computed for the training, validation, and test sets.

Dynamic mean-field model (MFM)

The MFM was derived by the mean-field reduction of a detailed spiking neuronal network model34. For each cortical ROI, the neural activity obeys the following nonlinear stochastic differential equations:1 S˙i=−Siτs+r(1−Si)H(xi)+σvi(t)

2 H(xi)=axi−b1−exp(−d(axi−b))

3 xi=wJSi+GJ∑jCijSj+I,

where Si,H(xi), and xi denote the average synaptic gating variable, population firing rate, and total input current of the ith cortical ROI. The total input current xi is the superposition of three inputs. The first input, the intra-regional input, is controlled by the recurrent connection strength w. The second input, the inter-regional input, is controlled by the SC matrix (Cij is the SC between regions i and j), as well as a global scaling factor G. The third input is the external input current I, which might include inputs from subcortical relays. Following previous studies25,34, the synaptic coupling J was set to 0.2609(nA). The parameter values of the input-output function H(xi) were set to a=270(n/C), b=108(Hz), and d=0.154(s). The kinetic parameters for synaptic activity were set to r=0.641 and τs=0.1(s). vi(t) is uncorrelated standard Gaussian noise and the noise amplitude is controlled by σ.

The simulated neural activities Si were fed to the Balloon–Windkessel hemodynamic model35,36 to simulate the fMRI BOLD signals for each ROI. The equations and parameters were exactly the same as our previous study25. More specifically, the MFM and hemodynamic model were simulated using Euler’s integration with a time step of 10 ms. The starting values of Si in the MFM were randomly initialized. Simulation length for the fMRI signals was 16.4 min. The first 2 min of the fMRI signals were discarded and the time series were downsampled to 0.72 s to have the same temporal resolution as the empirical fMRI signals in the HCP. The simulated fMRI signals could then be used to generate simulated FC and FCD matrices.

Parametric mean-field model (pMFM)

In our previous study25, the recurrent connection strength w, external input current I, global constant G and noise amplitude σ were optimized by fitting to static FC. The recurrent connection strength w and external input current I were allowed to vary independently across cortical ROIs, while G and σ were assumed to be constant. On the other hand24, parameterized the recurrent connection strengths with the T1w/T2w myelin map.

In this study, recurrent connection strength w, external input current I and noise amplitude σ were allowed to vary across brain regions, while G was kept as a constant. Instead of allowing w, I and σ to vary independently25, we parameterized w, I and σ as linear combinations of group-level T1w/T2w myelin maps37 and the first principal gradient of functional connectivity27:4 wi=awMyei+bwGradi+cw

5 Ii=aIMyei+bIGradi+cI

6 σi=aσMyei+bσGradi+cσ,

where wi, Ii, and σi denoted the recurrent connection strength, external input current, and noise amplitude, respectively, of the ith cortical region. Myei and Gradi were the average values of the T1w/T2w myelin map and the first FC principal gradient within the ith cortical ROI. Both T1w/T2w myelin maps and first principal gradient of functional connectivity were computed from the HCP training set. Therefore, there are a total of 10 unknown parameters: G and linear coefficients (aw,bw,cw,aI,bI,cI,aσ,bσ,cσ). These unknown parameters were be estimated from the HCP training set (see next section).

Cost function to minimize disagreement with empirical static FC and FCD

The 10 unknown parameters in the pMFM were estimated by maximizing fit to static FC and FCD in the HCP training set. For a particular set of parameters, the pMFM could be used to generate simulated FC and FCD matrices. The agreement between the simulated and empirical static FC matrices was defined as the Pearson’s correlation (r) between the z-transformed upper triangular entries of the two matrices. Larger r indicated more similar static FC. Pearson’s correlation was chosen given its popularity in the literature. However, we note that Pearson’s correlation ignored scale differences between empirical and simulated static FC, which led to pMFM-simulated static FC values being systematically larger than empirical FC values (Fig. 2C). In future studies, we will explore an additional cost term that penalizes absolute differences between empirical and static FC.

The disagreement between the simulated and empirical FCD matrices was defined as the Kolmogorov–Smirnov (KS) distance between the probability distribution functions (pdfs) constructed from the upper triangular entries of the two matrices22. The pdf of an FCD matrix was constructed by collapsing the upper triangular entries of the matrix into a histogram and normalized to have an area of one. A smaller KS distance indicated a more similar FCD. To optimize fit to both static FC and FCD, an overall cost was defined as (1 − r) + KS. Thus lower cost implies a better fit to static FC and FCD.

To minimize the cost function in the training set, we seek to compute an “average” FCD matrix. We note that FCD matrices could not be directly averaged across rs-fMRI runs and participants because there was no temporal correspondence across runs during the resting-state. Because the goal here was to compute the KS distance, we simply averaged the pdfs from the FCD matrices all the runs of all participants within the training set, which we referred to as average FCD pdf. When evaluating KS distance in the validation and test sets, average FCD pdfs were also computed using the same approach.

Optimization procedure

To optimize the cost function, we considered three algorithms: covariance matrix adaptation evolution strategy (CMA-ES38), self-organizing migrating algorithm (SOMA59) and hyperparameter optimization using radial basis functions and dynamic coordinate search (HORD60).

Given a particular random initialization of the 10 unknown parameters, the three algorithms (CMA-ES, SOMA, HORD) were applied to the HCP training set. Each algorithm was iterated 500 times, generating 500 candidate parameter sets. This procedure was repeated 10 times, yielding 5000 candidate parameter sets. For each algorithm, the 5000 candidate parameter sets were evaluated in the validation set to obtain the top 10 candidate parameter sets. To ensure diversity among the parameter sets, the procedure to select the top 10 parameter sets was as follows. First, the parameter set with the lowest validation cost was selected. Then, the parameter set with the lowest validation cost and whose parameter maps exhibited less than 0.98 correlation with the current selected parameter set(s) was selected. This procedure was repeated until 10 parameter sets were selected. Across the three algorithms, CMA-ES performed the best in the validation set (Supplementary Fig. S1), so this study focused on CMA-ES.

The top 10 candidate parameter sets from CMA-ES were then applied to the HCP test set SC. For each parameter set, 1000 simulations were performed, yielding 1000 simulated static FC and FCD matrices. The 1000 simulated FC and FCD pdfs were then averaged, yielding an average simulated FC and an average simulated FCD pdf. Pearson’s correlation was then computed between the average simulated FC and the average empirical FC from the HCP test set. Similarly, KS statistics was computed between the average simulated FCD pdf and the average empirical FCD pdf from the HCP test set.

We note that by collapsing the entries of the FCD matrix into a pdf, we were ignoring the recurrent structure in the FCD matrix. Supplementary Fig. S17 shows the FCD pdfs of empirical and simulated data. At the individual-level, the FCD pdf exhibited a bimodal distribution. Because the FCD pdfs were shifted across participants, the group-level FCD pdf was unimodal. Although the pMFM was fitted to the group-level FCD pdf, the resulting FCD distribution exhibited hints of bimodality and recurrent structure similar to empirical FCD (Fig. 2).

Statistical test of correlation between first derivatives of FCD mean and SW-STD

To quantify the correspondence between FCD mean and SW-STD (Fig. 5), the correlation between the first derivative of the FCD mean time course and the first derivative of the SW-STD time course was computed for each cortical region (Fig. 6). To compute the statistical significance of the correlations, fMRI runs were permuted across participants. For each ROI, the FCD-STD correlations were recomputed and averaged across runs and participants, yielding a single null correlation value. This permutation procedure was repeated 10,000 times, so that a null distribution of correlations was obtained for each ROI.

Causal perturbations of pMFM

To more directly link sensory-motor regions with FCD, we tested whether perturbation of sensory-motor regions can “kick” the system from an incoherent FCD state to a coherent FCD state. Among 1000 random simulations of the pMFM, time segments in the incoherent (low FCD mean) state lasting for at least 200 contiguous fMRI time points (TRs) were selected, yielding 300 time segments. Low FCD mean was defined as being <0.6.

Perturbation was applied to the neural signals (synaptic gating variable Si) of the top 5 regions whose SW-STD correlated with FCD (Fig. 6B). We note that during the incoherent state, the values of the synaptic gating variables could be low or high. To increase the amplitude of the neural signals, we would decrease (or increase) the synaptic gating variables if they were high (or low). More specifically, let Smax and Smin be the maximum and minimum synaptic gating variable values across all cortical regions. When the neural signal was low, we set St+δt=St+0.8(Smax−St), where δt corresponded to the resolution of the simulations, which is 0.01 s in the current study. When the neural signal was high, we set St+δt=St−0.8(St−Smin). The perturbations were applied for 72 iterations, corresponding to 1 TR in the simulated fMRI signal.

Gene expression analysis

Publicly available human gene expression data from six postmortem donors (1 female), aged 24–57 years (42.5 ± 13.4) were obtained from the Allen Institute61. Processing followed the pipeline from Anderson and colleagues30 (https://github.com/HolmesLab/2020_NatComm_interneurons_cortical_function_schizophrenia), yielding 17,448 brain-expressed genes and 1683 analyzable cortical samples. Our analyses in turn focused on 2413 brain-specific genes26,62. Z-normalized gene expression values of parvalbumin (PVALB) and somatostatin (SST) were averaged within each cortical region and the difference was computed. The FCD-STD correlation maps (Fig. 6) were correlated with the PVALB-SST spatial map (Fig. 7).

To establish statistical significance, we considered two approaches. First, we considered the spin test. The parcellations were randomly rotated. For each rotated parcellation, we recomputed the PVALB-SST difference and correlated the resulting gene expression maps with the FCD-STD correlation maps, yielding a single null correlation value. This was repeated 1000 times yielding a complete null distribution.

To test the specificity of PVALB-SST, we performed random-gene-pair tests. A random pair of genes were selected from the 2413 brain-specific genes26. Gene expression difference between the random gene pairs was computed and correlated with the STD-FCD correlation maps generating a null correlation value. This was repeated 10,000 times yielding a complete null distribution.

Reporting summary

Further information on research design is available in the Nature Research Reporting Summary linked to this article.

Supplementary information

Supplementary Information

Peer Review File

Reporting Summary

Source data

Source Data

Supplementary information

The online version contains supplementary material available at 10.1038/s41467-021-26704-y.

Acknowledgements

This work was supported by the Singapore National Research Foundation (NRF) Fellowship (Class of 2017), the NUS Yong Loo Lin School of Medicine (NUHSRO/2020/124/TMR/LOA), the Singapore National Medical Research Council (NMRC) LCG (OFLCG19May-0035), and the United States National Institutes of Health (R01MH120080). Any opinions, findings, and conclusions, or recommendations expressed in this material are those of the authors and do not reflect the views of the Singapore NRF or the Singapore NMRC. Our computational work was partially performed on resources of the National Supercomputing Centre, Singapore (https://www.nscc.sg). Data were in part provided by the Human Connectome Project, WU-Minn Consortium (Principal Investigators: David Van Essen and Kamil Ugurbil; 1U54MH091657) funded by the 16 NIH Institutes and Centers that support the NIH Blueprint for Neuroscience Research; and by the McDonnell Center for Systems Neuroscience at Washington University.

Author contributions

X.K., R.K., P.W., C.O., K.A., A.H., J.D.M., G.D., M.v.d.H. and B.T.T.Y. designed the research. X.K. conducted the research. X.K., R.K., C.O. and B.T.T.Y. analyzed and interpreted the results. X.K. and B.T.T.Y. wrote the manuscript and made figures. X.K. analyzed the data. X.K. and S.Z. reviewed and published the code. All authors provided analytic support. All authors edited the manuscripts.

Data availability

The group-level FC, SC, and FCD cumulative distribution functions used in this study have been deposited in the Zenodo63 database under accession code 5518257. The raw diffusion MRI, rs-fMRI, and T1w/T2w data are publicly available (https://www.humanconnectome.org/study/hcp-young-adult/document/1200-subjects-data-release). Source data are provided with this paper.

Code availability

The code used in this paper is deposited in Zenodo63 database under accession code 5518257. The code was reviewed by one co-author (S.Z.) to reduce the chance of coding errors. The software dependencies are MATLAB (2018b); Python (3.6); Pytorch (1.0.1). From time to time, the code might be updated. The most updated version of the code can be found on GitHub (https://github.com/ThomasYeoLab/CBIG/tree/master/stable_projects/fMRI_dynamics/Kong2021_pMFM).

Competing interests

The authors declare no competing interests.

Peer review information Nature Communications thanks Janine Bijsterbosch, Michael Breakspear and the other, anonymous, reviewer(s) for their contribution to the peer review of this work. Peer reviewer reports are available.

Publisher’s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

1. Hutchison RM Womelsdorf T Gati JS Everling S Menon RS Resting‐state networks show dynamic functional connectivity in awake humans and anesthetized macaques Hum. Brain Mapp. 2013 34 2154 2177 10.1002/hbm.22058 22438275
2. Gozzi A Schwarz AJ Large-scale functional connectivity networks in the rodent brain Neuroimage 2016 127 496 509 10.1016/j.neuroimage.2015.12.017 26706448
3. Ma Y Resting-state hemodynamics are spatiotemporally coupled to synchronized and symmetric neural activity in excitatory neurons Proc. Natl Acad. Sci. USA 2016 113 E8463 E8471 10.1073/pnas.1525369113 27974609
4. Betzel RF Organizing principles of whole-brain functional connectivity in zebrafish larvae Netw. Neurosci. 2020 4 234 256 10.1162/netn_a_00121 32166210
5. Damoiseaux JS Consistent resting-state networks across healthy subjects Proc. Natl Acad. Sci. USA 2006 103 13848 13853 10.1073/pnas.0601417103 16945915
6. Smith SM Correspondence of the brain’s functional architecture during activation and rest Proc. Natl Acad. Sci. USA 2009 106 13040 13045 10.1073/pnas.0905267106 19620724
7. Gratton C Functional brain networks are dominated by stable group and individual factors, not cognitive or daily variation Neuron 2018 98 439 452 e435 10.1016/j.neuron.2018.03.035 29673485
8. Finn ES Functional connectome fingerprinting: identifying individuals using patterns of brain connectivity Nat. Neurosci. 2015 18 1664 1671 10.1038/nn.4135 26457551
9. Kong R Spatial topography of individual-specific cortical networks predicts human cognition, personality, and emotion Cereb. Cortex 2019 29 2533 2551 10.1093/cercor/bhy123 29878084
10. Xia CH Linked dimensions of psychopathology and connectivity in functional brain networks Nat. Commun. 2018 9 3003 10.1038/s41467-018-05317-y 30068943
11. Kebets V Somatosensory-motor dysconnectivity spans multiple transdiagnostic dimensions of psychopathology Biol. Psychiatry 2019 86 779 791 10.1016/j.biopsych.2019.06.013 31515054
12. Allen EA Tracking whole-brain connectivity dynamics in the resting state Cereb. Cortex 2014 24 663 676 10.1093/cercor/bhs352 23146964
13. Zalesky A Fornito A Cocchi L Gollo LL Breakspear M Time-resolved resting-state brain networks Proc. Natl Acad. Sci. USA 2014 111 10341 10346 10.1073/pnas.1400181111 24982140
14. Vidaurre D Smith SM Woolrich MW Brain network dynamics are hierarchically organized in time Proc. Natl Acad. Sci. USA 2017 114 12827 12832 10.1073/pnas.1705120114 29087305
15. Liegeois R Resting brain dynamics at different timescales capture distinct aspects of human behavior Nat. Commun. 2019 10 2317 10.1038/s41467-019-10317-7 31127095
16. Lurie DJ Questions and controversies in the study of time-varying functional connectivity in resting fMRI Netw. Neurosci. 2020 4 30 69 10.1162/netn_a_00116 32043043
17. Deco G Jirsa VK McIntosh AR Emerging concepts for the dynamical organization of resting-state activity in the brain Nat. Rev. Neurosci. 2011 12 43 56 10.1038/nrn2961 21170073
18. Breakspear M Dynamic models of large-scale brain activity Nat. Neurosci. 2017 20 340 352 10.1038/nn.4497 28230845
19. Honey CJ Kotter R Breakspear M Sporns O Network structure of cerebral cortex shapes functional connectivity on multiple time scales Proc. Natl Acad. Sci. USA 2007 104 10240 10245 10.1073/pnas.0701519104 17548818
20. Ghosh A Rho Y McIntosh AR Kotter R Jirsa VK Noise during rest enables the exploration of the brain’s dynamic repertoire PLoS Comput. Biol. 2008 4 e1000196 10.1371/journal.pcbi.1000196 18846206
21. Deco G How local excitation-inhibition ratio impacts the whole brain dynamics J. Neurosci. 2014 34 7886 7898 10.1523/JNEUROSCI.5068-13.2014 24899711
22. Hansen EC Battaglia D Spiegler A Deco G Jirsa VK Functional connectivity dynamics: modeling the switching behavior of the resting state Neuroimage 2015 105 525 535 10.1016/j.neuroimage.2014.11.001 25462790
23. Chaudhuri R Knoblauch K Gariel MA Kennedy H Wang XJ A Large-scale circuit mechanism for hierarchical dynamical processing in the primate cortex Neuron 2015 88 419 431 10.1016/j.neuron.2015.09.008 26439530
24. Demirtas M Hierarchical heterogeneity across human cortex shapes large-scale neural dynamics Neuron 2019 101 1181 1194 e1113 10.1016/j.neuron.2019.01.017 30744986
25. Wang P Inversion of a large-scale circuit model reveals a cortical hierarchy in the dynamic resting human brain Sci. Adv. 2019 5 eaat7854 10.1126/sciadv.aat7854 30662942
26. Burt JB Hierarchy of transcriptomic specialization across human cortex captured by structural neuroimaging topography Nat. Neurosci. 2018 21 1251 1259 10.1038/s41593-018-0195-0 30082915
27. Margulies DS Situating the default-mode network along a principal gradient of macroscale cortical organization Proc. Natl Acad. Sci. USA 2016 113 12574 12579 10.1073/pnas.1608282113 27791099
28. Freyer F Roberts JA Ritter P Breakspear M A canonical model of multistability and scale-invariance in biological systems PLoS Comput. Biol. 2012 8 e1002634 10.1371/journal.pcbi.1002634 22912567
29. Deco G Kringelbach ML Jirsa VK Ritter P The dynamics of resting fluctuations in the brain: metastability and its dynamical cortical core Sci. Rep. 2017 7 3095 10.1038/s41598-017-03073-5 28596608
30. Anderson KM Transcriptional and imaging-genetic association of cortical interneurons, brain function, and schizophrenia risk Nat. Commun. 2020 11 2889 10.1038/s41467-020-16710-x 32514083
31. Kim Y Brain-wide maps reveal stereotyped cell-type-based cortical architecture and subcortical sexual dimorphism Cell 2017 171 456 469 e422 10.1016/j.cell.2017.09.020 28985566
32. Desikan RS An automated labeling system for subdividing the human cerebral cortex on MRI scans into gyral based regions of interest Neuroimage 2006 31 968 980 10.1016/j.neuroimage.2006.01.021 16530430
33. Liegeois R Laumann TO Snyder AZ Zhou J Yeo BTT Interpreting temporal fluctuations in resting-state functional connectivity MRI Neuroimage 2017 163 437 455 10.1016/j.neuroimage.2017.09.012 28916180
34. Deco G Resting-state functional connectivity emerges from structurally and dynamically shaped slow linear fluctuations J. Neurosci. 2013 33 11239 11252 10.1523/JNEUROSCI.1091-13.2013 23825427
35. Stephan KE Weiskopf N Drysdale PM Robinson PA Friston KJ Comparing hemodynamic models with DCM Neuroimage 2007 38 387 401 10.1016/j.neuroimage.2007.07.040 17884583
36. Heinzle J Koopmans PJ den Ouden HEM Raman S Stephan KE A hemodynamic model for layered BOLD signals Neuroimage 2016 125 556 570 10.1016/j.neuroimage.2015.10.025 26484827
37. Glasser MF Van Essen DC Mapping human cortical areas in vivo based on myelin content as revealed by T1- and T2-weighted MRI J. Neurosci. 2011 31 11597 11616 10.1523/JNEUROSCI.2180-11.2011 21832190
38. Hansen, N. In Towards a New Evolutionary Computation (eds. Lozano, J. A., Larrañga, P., Inza, I. & Bengoetxea, E.) 75–102 (2006).
39. Yeo BTT The organization of the human cerebral cortex estimated by intrinsic functional connectivity J. Neurophysiol. 2011 106 1125 1165 10.1152/jn.00338.2011 21653723
40. Cocchi L Gollo LL Zalesky A Breakspear M Criticality in the brain: a synthesis of neurobiology, models and cognition Prog. Neurobiol. 2017 158 132 152 10.1016/j.pneurobio.2017.07.002 28734836
41. Gordon EM Generation and evaluation of a cortical area parcellation from resting-state correlations Cereb. Cortex 2016 26 288 303 10.1093/cercor/bhu239 25316338
42. Alexander-Bloch AF On testing for spatial correspondence between maps of human brain structure and function Neuroimage 2018 178 540 551 10.1016/j.neuroimage.2018.05.070 29860082
43. Anderson KM Convergent molecular, cellular, and cortical neuroimaging signatures of major depressive disorder Proc. Natl Acad. Sci. USA 2020 117 25138 25149 10.1073/pnas.2008004117 32958675
44. Mueller S Individual variability in functional connectivity architecture of the human brain Neuron 2013 77 586 595 10.1016/j.neuron.2012.12.028 23395382
45. Valk SL Shaping brain structure: genetic and phylogenetic axes of macroscale organization of cortical thickness Sci. Adv. 2020 6 eabb3417 10.1126/sciadv.abb3417 32978162
46. Schaefer A Local-global parcellation of the human cerebral cortex from intrinsic functional connectivity MRI Cereb. Cortex 2018 28 3095 3114 10.1093/cercor/bhx179 28981612
47. Huntenburg JM Bazin PL Margulies DS Large-scale gradients in human cortical organization Trends Cogn. Sci. 2018 22 21 31 10.1016/j.tics.2017.11.002 29203085
48. Huntenburg JM A systematic relationship between functional connectivity and intracortical myelin in the human cerebral cortex Cereb. Cortex 2017 27 981 997 10.1093/cercor/bhx030 28184415
49. Gao R van den Brink RL Pfeffer T Voytek B Neuronal timescales are functionally dynamic and shaped by cortical microarchitecture Elife 2020 9 e61277 10.7554/eLife.61277 33226336
50. Paquola C Microstructural and functional gradients are increasingly dissociated in transmodal cortices PLoS Biol. 2019 17 e3000284 10.1371/journal.pbio.3000284 31107870
51. Shafiei, G. et al. Topographic gradients of intrinsic dynamics across neocortex. Elife 9, 10.7554/eLife.62116 (2020).
52. Reinen JM The human cortex possesses a reconfigurable dynamic network architecture that is disrupted in psychosis Nat. Commun. 2018 9 1 15 10.1038/s41467-018-03462-y 29317637
53. Wang C Ong JL Patanaik A Zhou J Chee MW Spontaneous eyelid closures link vigilance fluctuation with fMRI dynamic connectivity states Proc. Natl Acad. Sci. USA 2016 113 9653 9658 10.1073/pnas.1523980113 27512040
54. Wang X-J Tegnér J Constantinidis C Goldman-Rakic PS Division of labor among distinct subtypes of inhibitory neurons in a cortical microcircuit of working memory Proc. Natl Acad. Sci. USA 2004 101 1368 1373 10.1073/pnas.0305337101 14742867
55. Wang XJ Macroscopic gradients of synaptic excitation and inhibition in the neocortex Nat. Rev. Neurosci. 2020 21 169 178 10.1038/s41583-020-0262-x 32029928
56. Van Essen DC The WU-Minn Human Connectome Project: an overview Neuroimage 2013 80 62 79 10.1016/j.neuroimage.2013.05.041 23684880
57. Leonardi N Van De Ville D On spurious and real fluctuations of dynamic functional connectivity during rest Neuroimage 2015 104 430 436 10.1016/j.neuroimage.2014.09.007 25234118
58. van den Heuvel MP Sporns O Rich-club organization of the human connectome J. Neurosci. 2011 31 15775 15786 10.1523/JNEUROSCI.3539-11.2011 22049421
59. Davendra, D. & Zelinka, I. Self-Organizing Migrating Algorithm: Methodology and Implementation Vol. 626 (Springer, 2016).
60. Ilievski, I., Akhtar, T., Feng, J. & Shoemaker, C. in Proceedings of the AAAI Conference on Artificial Intelligence (2017).
61. Hawrylycz MJ An anatomically comprehensive atlas of the adult human brain transcriptome Nature 2012 489 391 399 10.1038/nature11405 22996553
62. Genovese G Increased burden of ultra-rare protein-altering variants among 4,877 individuals with schizophrenia Nat. Neurosci. 2016 19 1433 1441 10.1038/nn.4402 27694994
63. Kong, X. et al. ThomasYeoLab: sensory-motor cortices shape functional connectivity dynamics in the human brain. Zenodo10.5281/zenodo.5518257 (2021).

