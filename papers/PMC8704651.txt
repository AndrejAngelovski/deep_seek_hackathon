
==== Front
Sensors (Basel)
Sensors (Basel)
sensors
Sensors (Basel, Switzerland)
1424-8220
MDPI

10.3390/s21248305
sensors-21-08305
Communication
Multilayer Network Approach in EEG Motor Imagery with an Adaptive Threshold
https://orcid.org/0000-0002-8671-6549
Covantes-Osuna César
https://orcid.org/0000-0002-3733-9863
López Jhonatan B.
https://orcid.org/0000-0002-5382-6127
Paredes Omar
https://orcid.org/0000-0003-1319-8493
Vélez-Pérez Hugo
https://orcid.org/0000-0001-6459-8070
Romo-Vázquez Rebeca *
Tran Yvonne Academic Editor
Departamento de Bioingeniería Traslacional, CUCEI, Universidad de Guadalajara, Guadalajara 44430, Mexico; cesar.covantes@alumnos.udg.mx (C.C.-O.); jhonatan.lopez@alumnos.udg.mx (J.B.L.); omar.paredes@academicos.udg.mx (O.P.); hugo.velez@academicos.udg.mx (H.V.-P.)
* Correspondence: rebeca.romo@academicos.udg.mx
12 12 2021
12 2021
21 24 830502 10 2021
06 12 2021
© 2021 by the authors.
2021
https://creativecommons.org/licenses/by/4.0/ Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).
The brain has been understood as an interconnected neural network generally modeled as a graph to outline the functional topology and dynamics of brain processes. Classic graph modeling is based on single-layer models that constrain the traits conveyed to trace brain topologies. Multilayer modeling, in contrast, makes it possible to build whole-brain models by integrating features of various kinds. The aim of this work was to analyze EEG dynamics studies while gathering motor imagery data through single-layer and multilayer network modeling. The motor imagery database used consists of 18 EEG recordings of four motor imagery tasks: left hand, right hand, feet, and tongue. Brain connectivity was estimated by calculating the coherence adjacency matrices from each electrophysiological band (δ, θ, α and β) from brain areas and then embedding them by considering each band as a single-layer graph and a layer of the multilayer brain models. Constructing a reliable multilayer network topology requires a threshold that distinguishes effective connections from spurious ones. For this reason, two thresholds were implemented, the classic fixed (average) one and Otsu’s version. The latter is a new proposal for an adaptive threshold that offers reliable insight into brain topology and dynamics. Findings from the brain network models suggest that frontal and parietal brain regions are involved in motor imagery tasks.

adaptive threshold
coherence
functional connectivity
multilayer network
otsu
==== Body
pmc1. Introduction

The brain is a complex system with spatio-temporal dynamics that can be mapped by techniques that measure brain activity: electroencephalography (EEG), magnetoencephalography (MEG), and functional magnetic resonance imaging (fMRI) [1]. These techniques have been widely used to model brain networks that represent the structural and functional connectivity of the brain. Among all those techniques, EEG is an accessible, widespread method that measures the electrical activity of the brain on the scalp with a time resolution in milliseconds [2]. EEG analyses have divided brain waves into five major frequency bands: delta, δ (0.5–4 Hz); theta, θ (4–8 Hz); alpha, α (8–13 Hz); beta, β (13–30 Hz); and gamma, γ (30–128 Hz) [3]. Network models based on these frequency bands have revealed distinctive patterns and brain dynamics that have been used to study both normal and pathological mental states [4,5,6]. These network models can be analyzed using graphs built from an adjacency matrix that results from a brain connectivity analysis.

Brain connectivity analyses estimate the interaction strength among local information processing areas of the brain. Current state-of-the-art reports three types of connectivity: structural, based on the anatomical structure of the brain; functional, that measures the statistical dependence of different brain areas; and effective, which estimates causal relations among brain regions [7]. Concerning functional connectivity, literature describes various methods of estimation; including correlation (time domain dependence), and coherence (frequency domain dependence) [7]. Coherence measures the statistical relationship between two signals in the frequency domain [8] and it has been widely used in cerebral activity analyses involving memory [9], mathematical [5,6], and reasoning [10] task studies. It has also been applied to analyze differences at specific frequencies in patients with brain disorders [11], such as Parkinson’s [12] and Alzheimer’s diseases [13] and epilepsy [14]. In this work, adjacency matrices calculated from coherence between brain areas in electrophysiological bands were used to estimate functional connectivity.

Motor imagery is a cognitive-motor process widely studied by coherence analysis that has the potential to trigger and control actuators in brain-machine interface systems without any external motor action. Such systems aim to control a device through the brain activity of a user. Recent studies have focused on characterizing EEG through graph analysis to pinpoint not only brain areas but also interactions between them [15].

A graph is a mathematical tool used to describe the brain as a set of nodes (brain regions) and edges (connections) [16]. In Graph theory, there are different kinds of graphs, among which we can mention single-layer and multilayer ones. In single-layer networks, the edges represent the same type of connections between nodes. The associations between zones depend on a single character, which may be directed or undirected [17]. Some studies of brain connectivity have examined the brain as a single-layer graph linked by a single temporal or frequency property [18,19]. In cases where nodes can be linked based on multiple characters, associations are treated independently to build multiple single-layer networks that ignore the synergy between characters. Multilayer networks are suitable for these scenarios because they have the flexibility required to integrate multiple types of interactions in a single model.

The brain is currently considered a multilayer network [20]. As it was pointed out by [21], brain networks are intrinsically multilayers. There is not a single neuronal connectivity pattern able to fully represent brain functioning. Then, a multilayer framework is suitable for analyzing brain connectivity without either throwing away or combining different information. This focus improves understanding of brain complexity and interaction spectra with no need to discard electrophysiological data. This approach has proved to be a powerful tool in describing the complex organization and evolution of the human brain and its relationship to cognition [22]. Multilayer networks have been applied in brain analyses [23] using fMRI [24,25], MEG [4,26], gene expression [27] and EEG [20,21,28,29] techniques. The range of topological properties to be explored is, therefore, wider than in classic single-layer modeling [30]. Here, the efficiency of information flow results from multilayer interdependence within the network, rather than being an effect of each layer individually [31].

In the workflow of graph analysis, a common practice consists of thresholding networks to eliminate spurious connections [32]. That is because functional connectivity analysis, through measuring the statistical dependence among brain areas, yields a continuous weight range for interaction strength. Since some of these interactions should be labeled as spurious by the randomness of the signal, it is critical to exclude them from the brain connectivity analysis.

In this study, two thresholds were tested: the fixed (average) threshold, which is widely used in the literature, and a recently proposed threshold called Otsu. The fixed threshold method establishes a single, absolute threshold value over the entire network, typically fixed by averaging the adjacency matrices [33]. Values above this average are considered connections and are assigned a value of 1, while values below the average are discarded and receive a value of 0 that results in a binarized adjacency matrix. The main disadvantage of this approach is that a fixed threshold based on averages is conditioned by the weight distribution in the adjacency matrices, but this means that it will behave unreliably in the presence of outliers and non-normal distributions.

In contrast to the fixed threshold, Otsu’s approach involves optimizing the threshold value by evaluating how well the binarization process identifies two types of data (i.e., pixels, voxels, etc.) [34]. Some applications of Otsu’s methodology include structural segmentation in fMRI [35,36,37,38], and noise removal in EEG recordings using wavelet decomposition [39]. In our case, Otsu’s methodology was implemented for image segmentation and binarization [40]. To the best of our knowledge, and after an exhaustive literature search, Otsu’s method has not been applied to estimate the threshold of adjacency matrices in brain connectivity analyses. In this context, and considering the adjacency matrices as images that contain information about brain connectivity gathered from EEG recordings, this work proposes to apply Otsu’s threshold to these matrices to estimate an optimal threshold for brain connectivity analyses.

In light of the foregoing, this study aimed to analyze EEG dynamics by classical single-layer and multilayer network models for a motor imagery dataset. This was conducted to feature the movement and its dynamics, and thus pinpoint patterns capable of feeding a BCI system. The coherence adjacency matrices for each electrophysiological band (δ, θ, α and β) of the brain areas were analyzed individually on a single-layer approach, and then integrated, considering each band as a layer, to build a brain network model following the multilayer approach. Both approaches were built with fixed and Otsu’s thresholds.

Our results show that multigraph models cluster the four studied movements and lead to pinpointing the key electrodes for the motor imagery task that are located mainly on the frontal and parietal cortex. These brain zones coincide with the results presented in [15,41,42,43,44]. These works model brain connectivity with single-layer approach and a known threshold. However, our work explores a proof-of-concept EEG multilayer brain connectivity with an adaptative threshold. For this purpose, the paper is organized as follows: Section 2 addresses the material and methods, including the database description, the EEG signal preprocessing, and the connectivity estimation; in Section 3 the threshold, and single-layer and multilayer networks approaches are introduced, concluding with the results and discussion of the single-layer and the multilayer brain models with both thresholds in Section 4. The paper ends with the conclusions.

2. Materials and Methods

2.1. Database

In this study, the open access BNCI Horizon 2020 dataset (2a of BCI Competition IV) [45] was retrieved to pinpoint patterns of motor imagery. This dataset consists of 18 EEG recordings (Figure 1a) taken from 9 subjects (recorded in two sessions on different days) for four different motor imagery tasks (Figure 1b): left hand (class 1), right hand (class 2), feet (class 3), and tongue (class 4). The signals were recorded at a 250 Hz sampling rate and then band-pass filtered between 0.5–100 Hz. Electrodes were placed according to the 10–10 International System at Fz, Fc3, Fc1, Fcz, Fc2, Fc4, C5, C3, C1, Cz, C2, C4, C6, Cp3, Cp1, Cpz Cp2, Cp4, P1, Pz, P2, and POz.

The experimental paradigm for each trial is illustrated in Figure 1c [46]. On the trials, subjects began by focusing their eyes on a black screen (t = 0 s). After two seconds t = 2 s, an arrow image pointing left, right, down, or up (representing one of the four classes) appeared and remained on the screen for 1.25 s. Subjects then carried out the corresponding motor imagery task until the arrow image on the screen disappeared at t = 6 s, indicating a brief pause before the beginning the next trial. The time window corresponding to motor imagery (MI) onset) t = 3.5–5.5 s of the experimental paradigm was analyzed.

2.2. Preprocessing

Each EEG recording was composed of 6 runs (Figure 2a) separated by a short break. Each run consisted of 48 trials (12 for each class), resulting in 288 total trials of 2 s each (72 for each class).

To reduce the EEG spatial interference, a Common Average Reference (CAR) filter (Equation (1)) was applied for each of the 288 two-second EEG windows. (1) ViCAR=ViCR−1N∑j=1VjCR

where ViCR represents the potential between electrode i and the reference electrode, and N is the total number of electrodes.

Once the 288 windows filtered, each two-second window was transformed into the frequency domain. The power spectral for the 72 windows of each motion class was averaged to obtain 4 two-second frequency-averaged EEG windows. This process was carried out on each of the 18 recordings (Figure 2b).

2.3. Connectivity Estimation

The coherence index values between two signals range from 0 to 1. A value close to 1 indicates a strong relationship, while a value close to 0 represents weak interactions between signals. Coherence index is defined as (Equation (2)):(2) Cxy(f)=Sxy(f)2Sxx(f)Syy(f),

where x and y are two signals or channels, Cxy(f) is the coherence spectrum matrix as a function of a given frequency f, Sxy(f) is the cross-power spectrum, and Sxx(f) and Syy(f) are the auto-power spectra of x and y, respectively [47].

3. EEG Processing

3.1. Layers Construction

To generate the single- and multilayer network models for the used motor imagery dataset, four layers were estimated, each corresponding to the main electrophysiological bands (δ, θ, α and β). Each layer was built by estimating the coherence among the EEG electrodes, then averaging the magnitude of the frequencies that comprised each band. This approach generated an adjacency matrix for each band (Figure 2c).

As mentioned above, four two-second averaged windows were obtained from the 18 EEG recordings for each MI class. After that, functional brain connectivity was estimated in each window by calculating the pairwise coherence indices among the 22 electrodes. This allowed us to obtain 22 × 22 weighted adjacency matrices for each class as a layer. Figure 3 shows an example of a β band-coherence adjacency matrix for the left-hand IM. Red indicates a high coherence value, while blue represents weakly connected areas. These layers were evaluated by the approaches of a single layer, where the layers of electrophysiological bands were analyzed separately; and the multilayer, where each class layer was integrated to build a multiple network model.

3.2. Threshold Estimation

The threshold stage (Figure 2d) is a key step in graph analysis that provides reliable estimates of the network topology [48] and preserves the local topological features of the network measures [16,49]. In this study, the adjacency matrices were thresholded to build the connectivity networks using two methods: the widely used fixed threshold approach (i.e., average degree across the network) [33], and a proposal for a novel method based on image segmentation the Otsu’s method [40].

Otsu’s Threshold

This threshold uses the adjacency matrix data to calculate data distribution represented as a histogram Figure 4). In brain networks, histograms such as this one correspond to the scores of the weighted adjacency matrix. In our case, the matrices consisted of 22 × 22 values from 0 to 1 (coherence range values).

For example, if we fix the threshold at T = 0.01, then adjacency values below T can be classified as class C1 and correspond to spurious connections. Values above T are classified as class C2 and correspond to effective connections. Thus, connections in C1 are counted and divided by the total number of connections, N (22×22), to obtain the intensity w1, and, likewise, for C2 to estimate the intensity, w2. The means, μ1 and μ2, and variances, σ12 and σ22, of these intensity values are also estimated, and the procedure is repeated for each increment of T until the range of values is completed. Obviously, all connections for C2 are 1.

Next, the “Within-Class Variance (WCV)” (Equation (3)) and the “Between-Class Variance (BCV)” (Equation (4)) were computed in this threshold. (3) WCV=w1σ12+w2σ22

(4) BCV=w1w2(μ1−μ2)2

The optimal threshold is the value that minimizes WCV while maximizing BCV. Figure 5 shows an example of the distributions for an adjacency matrix with a maximum BCV and a minimum WCV. As can be seen, the optimal threshold is T = 0.9698. Once calculated, the weighted adjacency matrix is binarized. An example of this procedure is shown in Figure 5.

Comparing the values of the thresholds obtained by the fixed (T = 0.9747) and Otsu’s methods (T = 0.9698) we find that they tend to be similar. Therefore, the binarized matrices obtained from these thresholds (Figure 6) are close related. This suggests that both methods could generate similar topologies. However, as mentioned above, Otsu’s threshold has the advantage of estimating an optimized threshold based on the distribution of the weights in the adjacency matrix, while the fixed threshold average is sensitive to outliers and non-normal distributions.

3.3. Single-Layer Network Estimation

To model brain dynamics in motor imaginary tasks by the single-layer approach, multiple single-layer graphs were built for each class for all 18 EEG recordings. Each graph corresponds to a band network representation (δ, θ, α, and β) of the 22 EEG electrodes as the graph nodes, and the brain wiring or graph edges corresponding to the effective band-coherence score between electrodes. Notice that such graphs are independent one of another, despite in nature, the brain oscillome is not compartmentalized but modulates electrophysiological bands as a whole. Then, 72 graphs were obtained for each MI class that corresponds to the four frequency bands of the 18 EEG MI recordings.

Then, four graph metrics were estimated: degree (Equation (5)), that measures the electrode neighborhood by adding all j-column aij adjacency matrix coefficients for the i-node v; eigenvector centrality xv (Equation (6)), that evaluates the neighborhood (M(v)) integration by estimating the eigenvalues λ and their eigenvector xt; k-core number (Equation (7)), that represents the electrode coreness level where each node’s score k is the subgraph G(C) to which it belongs with degree nodes dG(C)(v) greater than k; and PageRank (Equation (8)), that ranks the node importance by averaging the ratio of its neighbors’ pagerank PR(v) and their degree d(v). (5) d(v)=∑i,j∈Vaij

(6) xv=1λ∑t∈M(v)xt

(7) ∀v∈C:dG(C)(v)≥k

(8) PR(v)=∑u∈BvPR(u)d(u)

3.4. Multilayer Network Estimation

For the multilayer approach, the layers that correspond to each electrophysiological band were retrieve, and then integrated into multi-level graph models for each class of all 18 EEG recordings. For these graphs, the intra-layer edges were considered to be present between the nodes themselves, since all electrophysiological bands operate simultaneously. In the next step, multilayer metrics were estimated (Figure 2e,f) using the MuxViz framework in R language [50].

The metrics considered were degree, PageRank, eigenvector centrality, and k-core. The degree (Equation (9)) is the number of links through the layers, ignoring the interlayer link nodes themselves. PageRank (Equation (10)) is the probability of a node reaching any other node (1−r)NL, so it ranks the nodes based on the latter probability [51]. As in a single-layer model, those probabilities are uniform, ujβiα, through all nodes, and are interactively updated. However, in the multilayer case, the probabilities. ujβiα, are considered to be the initial values of the next layer. For eigenvector centrality (Equation (11)), the suprajacency matrix is encoded into an aggregate matrix, Mjβiα via an eigentensor Θjα. The eigenvector centrality is the dot product of the leading eigenvector, λ1−1 and the neighborhood of each node [52]. Finally, k-core (Equation (12)) represents the ratio of the coreness nk−core for the probability of specific degree-node nk(q) through all the layers [53]. (9) ki=MjβiαUαβuj

(10) Rjβiα=rTjβiα+(1−r)NLujβiα

(11) Θjβ=λ1−1MjβiαΘiα

(12) Pk(q)=nk(q)nk−core

4. Results and Discussion

4.1. Single-Layer Network

Statistical analysis for each band was performed to evaluate which electrode metric differs among the MI classes. Thus, the electrode metric distributions for each MI class were considered to be dependent variables of such class. Thereafter, a MANOVA was performed to determine the significative electrodes and followed by a post hoc test on each electrode.

MANOVA post hoc test consists of applying a one-way ANOVA on the significative electrodes and a posterior Games-Howell post hoc test, to locate the motions that have a significant difference at these electrodes.

The single-layer network results presented in Table 1 and Figure 7 show that the significant electrodes correspond to the frontal and parietal cortex in β band (Figure 7c). Post hoc analysis points that the significant electrodes on these brain areas corresponding to each graph metrics are: degree—C3, FC4, POZ, CP2 and CP3 (Figure 7d); eigenvector—C3, POZ, CP2 and CP4 (Figure 7e); k-core and PageRank metrics were not significative for the MANOVA. From these results, and considering those electrodes that were significative in at least two metrics, we first labeled as key electrodes: C3, POZ and CP2. Later, from these electrodes, we identified which were higher than the fixed and Otsu’s thresholds. Thus, the fixed threshold retrieved the C3, POZ and CP2 electrodes (Figure 7b), while Otsu’s threshold only retained C3 and POZ electrodes (Figure 7a).

Our results support that the frontal and parietal brain areas drive MI, as reported by Shenoy and Vinod [54]. In the latter study, the authors analyzed the same database for the four MI movements as in the present work. The common electrodes in both studies are C3, FC4, CP3 and CP4. These areas have been reported as the main MI electrodes in several connectivity analyses [15,41,42,43,44]. Most of these works are subject-wise analyzed, and their findings slightly deviate. However, all coincided with the brain zones (frontal and parietal) and the electrophysiological bands and sub-bands (mainly α and β) involved in MI.

The aforementioned picture suggests that an integrative analysis for all electrophysiological bands can retrieve the driver nodes on the MI brain dynamics. Multilayer network analysis is a model that meets the above-mentioned constraints.

4.2. Multilayer Network

To analyze the dynamics of MI in EEG recordings through a multilayer network model, a one-way ANOVA was performed to evaluate the multilayer metrics estimated for both thresholds. The metric distributions for each movement were obtained independently of its associated electrode; that is, all the metrics per electrode were concatenated. In this analysis, PageRank, Eigenvector and k-core were significatives (p < 0.05) for the Otsu’s threshold, while the fixed threshold in k-core was only significative (Table 2). This points to a difference between movements in the topology of the brain nucleus. Figure 8 shows the metric distribution for each movement.

To eliminate familywise errors, a post hoc paired t-test was performed using Benjamin-Hochberg FDR correction. This resulted in significative differences between the left-hand movement when k-core distributions were compared to the other movements for both thresholds (Figure 9).

Next, two analyses were conducted, a clustering to verify whether the movements are distinguishable based on all multilayer metrics, and statistical analysis to unveil the significant electrodes between imaginary movements.

4.2.1. Clustering

To assess whether the imaginary movements diverged between them by multilayer metrics, an unsupervised approach was performed for the evaluated window data, i.e., the time from 3.5–5.5 s. Thus, all electrode metrics were concatenated and linear discriminant analysis (LDA) was carried out to lower the data dimensionality into a 3D mapping (Figure 10).

Afterward, k-means clustering was developed with four clusters, assuming that each cluster will depict each of the four movements. To evaluate the intersection between the estimated k-means cluster and the real targets (the imagery movements), the completeness score was calculated yielding a score equal to one of both thresholds.

For each threshold, the clusters mapped differently for movements. For the fixed threshold, cluster 1 (red) represents the left hand, cluster 2 (green) the right hand, cluster 3 (blue) the foot, and cluster 4 (black) the tongue. Meanwhile, for the Otsu’s threshold, cluster 1 (red) maps to the foot movement, cluster 2 (green) to the left hand, cluster 3 (blue) to the tongue, and cluster 4 (black) to the right hand. This finding points out that the multilayer graph metrics despite the threshold do illustrate the topological connectivity dynamics all during imaginary movements.

4.2.2. Key Electrodes

To elucidate the electrodes most likely associated with the movements, an electrode-wise statistical analysis was conducted for all multilayer metrics among the four movements. This was evaluated by considering that the electrodes in brain dynamics are the dependent variable among the movements. In this case, a multivariate analysis of variance (MANOVA) was performed for both thresholds. The k-core metric was discarded in both cases since it did not comply with the MANOVA assumption that the data must be normally distributed between groups. The three remaining metrics showed significant differences (Table 3). Table 3 shows significative p for the eigenvector, PageRank, and degree metrics for both thresholds. This can illustrate that brain topology during imaginary movement is driven by key brain electrodes that switch to control distinct movements.

After the MANOVA analysis, a one-way ANOVA for each of the 22 electrodes was performed to identify the key electrodes that contributed to the significant differences found in the MANOVA.

These 22 one-way ANOVAs were applied for the metrics with significant p-value of Table 3; that is, degree, eigenvector and PageRank for both thresholds. After the one-way ANOVAs, a post hoc Games-Howell test was conducted to determine the electrodes involved in the changes in brain dynamics for the four movements. Results of this analysis are presented in Table 4.

Table 4 shows that 2 electrodes most likely drive the brain dynamics of the MI dataset analyzed. These electrodes are P2 and CP2 (Figure 11a). Among these electrodes, multilayer eigenvector metric point that the significant ones are: P2 and CP2 (Figure 11d). Degree, k-core and PageRank metrics were not significative for the MANOVA.

The key nodes that the fixed threshold gather the P2 (Figure 11c) electrode, while the Otsu threshold identified the electrode CP2 (Figure 11b).

These results suggests that both Fixed and Otsu’s thresholds are selective to yield the pivotal electrodes from the multilayer network. Despite that the electrodes imaged by both thresholds differ, these electrodes are neighbors and localized over the same brain area. Thus, it suggests that the Otsu threshold can recognize the underlying dynamics which widely tested thresholds as Fixed have also distinguished. Figure 12 shows an example of a multilayer graph.

The multilayer approach outlined in this study allowed us to cluster the dynamics linked to all the studied imaginary movements. Based on this finding, we pinpointed the key electrodes for such dynamics. Our results are congruent with the state-of-the-art analyses [15,41,42,43,44] that reported the frontal and parietal areas as the main brain areas in MI. In more detail, Babiloni et al. [55] indicated that sensorimotor events are correlated via the coherence with a functional coupling between parietal and central areas. All these works applied a single-layer approach for different frequency bands. To the best of our knowledge in the literature, there was not reported MI analysis based on multilayer graph models. For future work, our multilayer workflow will be tested in practical BCI applications. Our proposal, which couples an adaptive threshold with a multilayer network model, shall be cross-validated on new databases to validate its advantages over the widespread single-layer analysis.

5. Conclusions

In this study, we modeled single-layer and multilayer network models to analyze MI in EEG recordings. Our analysis shows that the regions activated in MI tasks are located mainly in the frontal and parietal cortex for the single-layer approach and in the parietal cortex for the multilayer approach. To pinpoint the effective connections in MI graphs a proof-of-concept threshold approach known as Otsu was proposed. The present work illustrates that combining an adaptive threshold, such as Otsu, together with integrative graph models, such as multilayer networks, produces a more reliable approximation of both the topology and dynamics associated with cognitive and motor brain functions.

Finally, future work should aim to implement this methodology to study brain connectivity in other kinds of EEG databases.

Author Contributions

Conceptualization, R.R.-V., C.C.-O. and H.V.-P.; methodology, C.C.-O., J.B.L., O.P., R.R.-V. and H.V.-P.; software, C.C.-O., J.B.L. and O.P.; validation, C.C.-O. and O.P. formal analysis, C.C.-O. and O.P.; investigation, C.C.-O., O.P., R.R.-V. and H.V.-P.; data curation, C.C.-O., J.B.L. and O.P.; writing—original draft preparation, C.C.-O. and O.P.; writing—review and editing, R.R.-V. and H.V.-P.; supervision R.R.-V. and H.V.-P.; project administration, R.R.-V. and H.V.-P. All authors have read and agreed to the published version of the manuscript.

Funding

This research received no external funding. This work was supported by the Consejo Nacional de Ciencia y Tecnología—CONACyT [Scholarship to C.C.-O. scholarship 480527, O.P. with CVU 713526 and J.B.L. with CVU 745514].

Institutional Review Board Statement

Not applicable.

Informed Consent Statement

Not applicable.

Data Availability Statement

http://www.bbci.de/competition/iv/.

Conflicts of Interest

The authors declare no conflict of interest.

Figure 1 Time and scheme paradigm.

Figure 2 Schematic flowchart of the study methodology. Here, (a) correspond to the acquisition paradigm of all four classes of motor imagery, (b) data prepossessing, while (c–f) outline the stages of the connectivity graph analysis.

Figure 3 Example of a coherence adjacency matrix in the β electrophysiological band (13–30 Hz) for the IM of the left-hand.

Figure 4 An adjacency matrix weight histogram for use in Otsu’s method. The data correspond to the β band (13–30 Hz) for the IM of the left-hand.

Figure 5 WCV and BCV histograms for the β band (13–30 Hz) for the IM right-hand. The optimum threshold value is T = 0.9698, indicating the minimum WCV value and the maximum BCV value. (a) Within-Class Variance (WCV) with the minimum value of 8.61×10−05 at threshold position T = 0.9698. (b) Between-Class Variance (BCV) with the maximum value of 1.62×10−04 at threshold position T = 0.9698.

Figure 6 Example of the binarized adjacency matrix from Figure 3; (a) fixed threshold (0.9809) and (b) Otsu’s threshold (0.9750) for the β band (13–30 Hz) for the IM right-hand. (a) Example of the binarized adjacency matrix by a fixed threshold (0.9747), in the β band (13–30 Hz) for the IM of the left-hand. (b) Example of the binarized adjacency matrix by the Otsu’s threshold (0.9698), in the β band (13–30 Hz) for the IM of the left-hand.

Figure 7 The electrodes with significative differences according to the post hoc MANOVA. In (a) all electrodes obtained with the post hoc analysis; (b,c) display the significative electrodes for the single-layer metrics with significative differences, while (d,e) identify the electrodes that were significative for both thresholds.

Figure 8 Multilayer graph metric distributions for all four MI classes. After applying a one-way ANOVA test, Otsu’s threshold showed significant values (p < 0.05) for k-core and degree, while fixed threshold only k-core was significantly different (p < 0.05).

Figure 9 Post hoc test scores in k-core for Otsu’s threshold on window 3.5–5.5 s.

Figure 10 4-cluster k-means for a low dimensionality representation (LDA) of multilayer graph metrics, on the left for the fixed threshold and right for the Otsu’s threshold. The four estimated clusters mapped to the imaginary movements in the window 3.5–5.5 s studied in the present work.

Figure 11 The electrodes with significative differences according to the post hoc MANOVA. In (a) all electrodes obtained with the post hoc analysis; (b,c) display the significative electrodes for the multilayer metrics with significative differences, while (d) identify the electrodes that were significatives for both thresholds.

Figure 12 Multilayer graph for right-hand movement intention. Each electrophysiological band is a layer of the graph. Those electrodes with significative difference identified (CP2 and P2) are highlighted in red in the present study. Cross-layer edges are found for all nodes, yet only those corresponding to the significant electrodes are plotted. Each individual layer is shown separately to provide a more detailed picture of the intra-layer connectivity.

sensors-21-08305-t001_Table 1 Table 1 p-values < 0.05 for the post hoc Games-Howell test in single layer of the fixed and Otsu’s threshold.

Metric	Band	Electrode	Movement	Movement	Threshold	
1	2	Fixed	Otsu	
Degree	Beta	C3	Foot	Right Hand	*	*	
POz	Right Hand	Tongue	*	*	
CP2	Left Hand	Right Hand	*	−	
CP3	Right Hand	Tongue	*	−	
FC4	Right Hand	Tongue	*	−	
Eigenvector	Beta	C3	Foot	Right Hand	*	*	
POz	Right Hand	Tongue	*	*	
CP2	Left Hand	Right Hand	*	−	
CP4	Foot	Left Hand	*	−	
Entries ‘−’ indicate no data according to threshold (average or Otsu); ‘*’ indicates significant data found in either the same threshold individually, or in both with the same threshold (fixed or Otsu).

sensors-21-08305-t002_Table 2 Table 2 p-values from the ANOVA test on window 3.5–5.5 s.

	Fixed	Otsu	
Degree	9.42×10−01	9.83×10−01	
PageRank	2.29×10−02	3.3×10−03	
Eigenvector	8.72×10−02	1.77×10−02	
Kcore	2.7×10−03	3.7×10−03	

sensors-21-08305-t003_Table 3 Table 3 p-values from the MANOVA test of the average and Otsu’s thresholds on window 3.5–5.5 s.

	Fixed	Otsu	
Degree	3.72×10−01	9.56×10−01	
PageRank	5.94×10−02	6.2×10−02	
Eigenvector	3.48×10−02	1.71×10−02	
Kcore	Error	Error	

sensors-21-08305-t004_Table 4 Table 4 p-values < 0.05 for the post hoc Games-Howell test in multilayer of the fixed and Otsu’s threshold on window 3.5–5.5 s.

Electrode	Movement	Movement	Metric	Threshold	
1	2	Degree	Eigenvector	PageRank	Fixed	Otsu	
CP2	Left Hand	Tongue	−	*	−	*	−	
P2	Foot	Left Hand	−	*	−	−	*	
Entries ‘−’ indicate no data according to the metric (degree, eigenvector or PageRank) or threshold (average or Otsu); ‘*’ indicates significative data found in either the same graph metric individually, or in both with the same threshold (fixed or Otsu).

Publisher’s Note: MDPI stays neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

1. Park H.J. Friston K. Structural and functional brain networks: From connections to cognition Science 2013 342 6158 10.1126/science.1238411 24179229
2. Subasi A. Ercelebi E. Classification of EEG signals using neural network and logistic regression Comput. Methods Programs Biomed. 2005 78 87 99 10.1016/j.cmpb.2004.10.009 15848265
3. Sanei S. Chambers J. Brain–Computer Interfacing EEG Signal Process. 2007 239 265 10.1002/9780470511923.ch7
4. Mandke K. Meier J. Brookes M.J. O’Dea R.D. Van Mieghem P. Stam C.J. Hillebrand A. Tewarie P. Comparing multilayer brain networks between groups: Introducing graph metrics and recommendations NeuroImage 2018 166 371 384 10.1016/j.neuroimage.2017.11.016 29138088
5. Klados M.A. Pandria N. Micheloyannis S. Margulies D. Bamidis P.D. Math anxiety: Brain cortical network changes in anticipation of doing mathematics Int. J. Psychophysiol. 2017 122 24 31 10.1016/j.ijpsycho.2017.05.003 28479367
6. González-Garrido A.A. Gómez-Velázquez F.R. Salido-Ruiz R.A. Espinoza-Valdez A. Vélez-Pérez H. Romo-Vazquez R. Gallardo-Moreno G.B. Ruiz-Stovel V.D. Martínez-Ramos A. Berumen G. The analysis of EEG coherence reflects middle childhood differences in mathematical achievement Brain Cogn. 2018 124 57 63 10.1016/j.bandc.2018.04.006 29747149
7. Sakkalis V. Review of advanced techniques for the estimation of brain connectivity measured with EEG/MEG Comput. Biol. Med. 2011 41 1110 1117 10.1016/j.compbiomed.2011.06.020 21794851
8. Bowyer S.M. Coherence a measure of the brain networks: Past and present Neuropsychiatr. Electrophysiol. 2016 2 1 10.1186/s40810-015-0015-7
9. Jiang Z. Study on EEG power and coherence in patients with mild cognitive impairment during working memory task J. Zhejiang Univ. Sci. B 2005 6 1213 1219 10.1631/jzus.2005.B1213 16358382
10. Vecchiato G. Susac A. Margeti S. Fallani F.D.V. Maglione A.G. Supek S. Planinic M. Babiloni F. High-resolution EEG analysis of power spectral density maps and coherence networks in a proportional reasoning task Brain Topogr. 2013 26 303 314 10.1007/s10548-012-0259-5 23053602
11. Özerdem A. Güntekin B. İlhan A. Turp B. Başar E. Reduced long distance gamma (28–48 Hz) coherence in euthymic patients with bipolar disorder J. Affect. Disord. 2011 132 325 332 10.1016/j.jad.2011.02.028 21459454
12. Moazami-Goudarzi M. Sarnthein J. Michels L. Moukhtieva R. Jeanmonod D. Enhanced frontal low and high frequency power and synchronization in the resting EEG of parkinsonian patients NeuroImage 2008 41 985 997 10.1016/j.neuroimage.2008.03.032 18457962
13. Hidasi Z. Czigler B. Salacz P. Csibri É. Molnár M. Changes of EEG spectra and coherence following performance in a cognitive task in Alzheimer’s disease Int. J. Psychophysiol. 2007 65 252 260 10.1016/j.ijpsycho.2007.05.002 17586077
14. Song J. Tucker D. Gilbert T. Hou J. Mattson C. Luu P. Holmes M. Methods for Examining Electrophysiological Coherence in Epileptic Networks Front. Neurol. 2013 4 55 10.3389/fneur.2013.00055 23720650
15. Gaxiola-Tirado J.A. Salazar-Varas R. Gutiérrez D. Using the partial directed coherence to assess functional connectivity in electroencephalography data for brain–computer interfaces IEEE Trans. Cogn. Dev. Syst. 2017 10 776 783 10.1109/TCDS.2017.2777180
16. Dennis E.L. Jahanshad N. Toga A.W. McMahon K.L. De Zubicaray G.I. Martin N.G. Wright M.J. Thompson P.M. Test-retest reliability of graph theory measures of structural brain connectivity International Conference on Medical Image Computing and Computer-Assisted Intervention Springer Berlin/Heidelberg, Germany 2012 305 312
17. Kinsley A.C. Rossi G. Silk M.J. VanderWaal K. Multilayer and Multiplex Networks: An Introduction to Their Use in Veterinary Epidemiology Front. Vet. Sci. 2020 7 596 10.3389/fvets.2020.00596 33088828
18. Ahmadlou M. Adeli H. Functional community analysis of brain: A new approach for EEG-based investigation of the brain pathology Neuroimage 2011 58 401 408 10.1016/j.neuroimage.2011.04.070 21586331
19. Zippo A.G. Della Rosa P.A. Castiglioni I. Biella G.E. Alternating dynamics of segregation and integration in human EEG functional networks during working-memory task Neuroscience 2018 371 191 206 10.1016/j.neuroscience.2017.12.004 29246785
20. Puxeddu M. Petti M. Mattia D. Astolfi L. The optimal setting for multilayer modularity optimization in multilayer brain networks Proceedings of the 2019 41st Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC) Berlin, Germany 23–27 July 2019 624 627
21. Puxeddu M.G. Petti M. Astolfi L. A Comprehensive Analysis of Multilayer Community Detection Algorithms for Application to EEG-Based Brain Networks Front. Syst. Neurosci. 2021 15 624183 10.3389/fnsys.2021.624183 33732115
22. Muldoon S.F. Bassett D.S. Network and multilayer network approaches to understanding human brain dynamics Philos. Sci. 2016 83 710 720 10.1086/687857
23. Vaiana M. Muldoon S.F. Multilayer brain networks J. Nonlinear Sci. 2018 30 2147 2169 10.1007/s00332-017-9436-8
24. Braun U. Schäfer A. Walter H. Erk S. Romanczuk-Seiferth N. Haddad L. Schweiger J.I. Grimm O. Heinz A. Tost H. Dynamic reconfiguration of frontal brain networks during executive cognition in humans Proc. Natl. Acad. Sci. USA 2015 112 11678 11683 10.1073/pnas.1422487112 26324898
25. De Domenico M. Sasai S. Arenas A. Mapping multiplex hubs in human functional brain networks Front. Neurosci. 2016 10 326 10.3389/fnins.2016.00326 27471443
26. Brookes M.J. Tewarie P.K. Hunt B.A. Robson S.E. Gascoyne L.E. Liddle E.B. Liddle P.F. Morris P.G. A multi-layer network approach to MEG connectivity analysis Neuroimage 2016 132 425 438 10.1016/j.neuroimage.2016.02.045 26908313
27. Paredes O. López J.B. Covantes-Osuna C. Ocegueda-Hernández V. Romo-Vázquez R. Morales J.A. A Transcriptome Community-and-Module Approach of the Human Mesoconnectome Entropy 2021 23 1031 10.3390/e23081031 34441171
28. Frolov N. Maksimenko V. Hramov A. Revealing a multiplex brain network through the analysis of recurrences Chaos Interdiscip. J. Nonlinear Sci. 2020 30 121108 10.1063/5.0028053
29. Naro A. Maggio M.G. Leo A. Calabrò R.S. Multiplex and Multilayer Network EEG Analyses: A Novel Strategy in the Differential Diagnosis of Patients with Chronic Disorders of Consciousness Int. J. Neural Syst. 2020 31 2050052 10.1142/S0129065720500525 33034532
30. Havlin S. Stanley H.E. Bashan A. Gao J. Kenett D.Y. Percolation of interdependent network of networks Chaos Solitons Fractals 2015 72 4 19 10.1016/j.chaos.2014.09.006
31. Yu M. Engels M.M. Hillebrand A. Van Straaten E.C. Gouw A.A. Teunissen C. Van Der Flier W.M. Scheltens P. Stam C.J. Selective impairment of hippocampus and posterior hub areas in Alzheimer’s disease: An MEG-based multiplex network study Brain 2017 140 1466 1485 10.1093/brain/awx050 28334883
32. Van Den Heuvel M.P. Fornito A. Brain networks in schizophrenia Neuropsychol. Rev. 2014 24 32 48 10.1007/s11065-014-9248-7 24500505
33. Van Wijk B.C. Stam C.J. Daffertshofer A. Comparing brain networks of different size and connectivity density using graph theory PLoS ONE 2010 5 e13701 10.1371/journal.pone.0013701 21060892
34. Sezgin M. Sankur B. Survey over image thresholding techniques and quantitative performance evaluation J. Electron. Imaging 2004 13 146 166
35. Roy S. Nag S. Maitra I.K. Bandyopadhyay S.K. A review on automated brain tumor detection and segmentation from MRI of brain arXiv 2013 1312.6150
36. Sandhya G. Babu Kande G. Savithri T.S. Multilevel thresholding method based on electromagnetism for accurate brain MRI segmentation to detect white matter, gray matter, and CSF BioMed Res. Int. 2017 2017 6783209 10.1155/2017/6783209 29250547
37. Fortin M. Omidyeganeh M. Battié M.C. Ahmad O. Rivaz H. Evaluation of an automated thresholding algorithm for the quantification of paraspinal muscle composition from MRI images Biomed. Eng. Online 2017 16 61 10.1186/s12938-017-0350-y 28532491
38. Sharma A. Kumar S. Singh S.N. Brain tumor segmentation using DE embedded OTSU method and neural network Multidimens. Syst. Signal Process. 2019 30 1263 1291 10.1007/s11045-018-0603-3
39. Geetha G. Geethalakshmi S. Artifact removal from eeg using spatially constrained independent component analysis and wavelet denoising with otsu’s thresholding technique Procedia Eng. 2012 30 1064 1071 10.1016/j.proeng.2012.01.964
40. Otsu N. A threshold selection method from gray-level histograms IEEE Trans. Syst. Man Cybern. 1979 9 62 66 10.1109/TSMC.1979.4310076
41. Astolfi L. Cincotti F. Mattia D. Marciani M.G. Baccala L.A. de Vico Fallani F. Salinari S. Ursino M. Zavaglia M. Ding L. Comparison of different cortical connectivity estimators for high-resolution EEG recordings Hum. Brain Mapp. 2007 28 143 157 10.1002/hbm.20263 16761264
42. Rathee D. Cecotti H. Prasad G. Estimation of effective fronto-parietal connectivity during motor imagery using partial granger causality analysis Proceedings of the 2016 International Joint Conference on Neural Networks (IJCNN) Vancouver, BC, Canada 24–29 July 2016 2055 2062
43. Cardoso V.F. Delisle-Rodriguez D. Romero-Laiseca M.A. Loterio F.A. Gurve D. Floriano A. Valadão C. Silva L. Krishnan S. Frizera-Neto A. Effect of a Brain–Computer Interface Based on Pedaling Motor Imagery on Cortical Excitability and Connectivity Sensors 2021 21 2020 10.3390/s21062020 33809317
44. Alanis-Espinosa M. Gutiérrez D. On the assessment of functional connectivity in an immersive brain-computer interface during motor imagery Front. Psychol. 2020 11 1301 10.3389/fpsyg.2020.01301 32714232
45. Tangermann M. Müller K.R. Aertsen A. Birbaumer N. Braun C. Brunner C. Leeb R. Mehring C. Miller K.J. Mueller-Putz G. Review of the BCI competition IV Front. Neurosci. 2012 6 55 22811657
46. Brunner C. Leeb R. Müller-Putz G. Schlögl A. Pfurtscheller G. BCI Competition 2008–Graz Data Set A Institute for Knowledge Discovery, Graz University of Technology Graz, Austria 2008 Volume 16 1 6
47. De Vico Fallani F. Astolfi L. Cincotti F. Mattia D. la Rocca D. Maksuti E. Salinari S. Babiloni F. Vegso B. Kozmann G. Evaluation of the Brain Network Organization From EEG Signals: A Preliminary Evidence in Stroke Patient Anat. Rec. 2009 292 2023 2031 10.1002/ar.20965
48. Tsai S.Y. Reproducibility of structural brain connectivity and network metrics using probabilistic diffusion tractography Sci. Rep. 2018 8 11562 10.1038/s41598-018-29943-0 30068926
49. Stefan S. Schorr B. Lopez-Rolon A. Kolassa I.T. Shock J.P. Rosenfelder M. Heck S. Bender A. Consciousness indexing and outcome prediction with resting-state EEG in severe disorders of consciousness Brain Topogr. 2018 31 848 862 10.1007/s10548-018-0643-x 29666960
50. Domenico M.D. Porter M.A. Arenas A. MuxViz: A tool for multilayer analysis and visualization of networks J. Complex Networks 2014 3 159 176 10.1093/comnet/cnu038
51. Brin S. Page L. The anatomy of a large-scale hypertextual Web search engine Comput. Netw. ISDN Syst. 1998 30 107 117 10.1016/S0169-7552(98)00110-X
52. Domenico M.D. Solé-Ribalta A. Omodei E. Gómez S. Arenas A. Ranking in interconnected multilayer networks reveals versatile nodes Nat. Commun. 2015 6 6868 10.1038/ncomms7868 25904405
53. Azimi-Tafreshi N. Gómez-Gardeñes J. Dorogovtsev S.N. k-core percolation on multiplex networks Phys. Rev. E 2014 90 032816 10.1103/PhysRevE.90.032816
54. Shenoy H.V. Vinod A.P. An iterative optimization technique for robust channel selection in motor imagery based brain computer interface Proceedings of the 2014 IEEE International Conference on Systems, Man, and Cybernetics (SMC) San Diego, CA, USA 5–8 October 2014 1858 1863
55. Babiloni C. Brancucci A. Vecchio F. Arendt-Nielsen L. Chen A.C. Rossini P.M. Anticipation of somatosensory and motor events increases centro-parietal functional coupling: An EEG coherence study Clin. Neurophysiol. 2006 117 1000 1008 10.1016/j.clinph.2005.12.028 16516546

