
==== Front
PLoS Comput Biol
PLoS Comput Biol
plos
PLoS Computational Biology
1553-734X
1553-7358
Public Library of Science San Francisco, CA USA

10.1371/journal.pcbi.1009160
PCOMPBIOL-D-21-01028
Research Article
Biology and Life Sciences
Genetics
Gene Expression
Biology and Life Sciences
Cell Biology
Cellular Types
Animal Cells
Glial Cells
Microglial Cells
Biology and Life Sciences
Psychology
Developmental Psychology
Pervasive Developmental Disorders
Autism Spectrum Disorder
Social Sciences
Psychology
Developmental Psychology
Pervasive Developmental Disorders
Autism Spectrum Disorder
Science Policy
Science and Technology Workforce
Careers in Research
Scientists
People and Places
Population Groupings
Professions
Scientists
Biology and Life Sciences
Genetics
Gene Expression
Gene Regulation
Computer and Information Sciences
Computer Architecture
User Interfaces
Computer and Information Sciences
Computer Applications
Web-Based Applications
Research and Analysis Methods
Database and Informatics Methods
Biological Databases
Genomic Databases
Biology and Life Sciences
Computational Biology
Genome Analysis
Genomic Databases
Biology and Life Sciences
Genetics
Genomics
Genome Analysis
Genomic Databases
MGEnrichment: A web application for microglia gene list enrichment analysis
MGEnrichment: Microglia gene list enrichment analysis
https://orcid.org/0000-0003-3926-0128
Jao Justin Formal analysis Methodology Resources Software Validation Visualization Writing – original draft Writing – review & editing
https://orcid.org/0000-0002-3406-3806
Ciernia Annie Vogel Conceptualization Data curation Formal analysis Funding acquisition Methodology Project administration Resources Software Supervision Writing – original draft Writing – review & editing *
Department of Biochemistry and Molecular Biology, Djavad Mowafaghian Centre for Brain Health, University of British Columbia, Vancouver, Canada
Pertea Mihaela Editor
Johns Hopkins University, UNITED STATES
The authors have declared that no competing interests exist.

* E-mail: annie.ciernia@ubc.ca
17 11 2021
11 2021
17 11 e10091602 6 2021
19 10 2021
© 2021 Jao, Ciernia
2021
Jao, Ciernia
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.

Gene expression analysis is becoming increasingly utilized in neuro-immunology research, and there is a growing need for non-programming scientists to be able to analyze their own genomic data. MGEnrichment is a web application developed both to disseminate to the community our curated database of microglia-relevant gene lists, and to allow non-programming scientists to easily conduct statistical enrichment analysis on their gene expression data. Users can upload their own gene IDs to assess the relevance of their expression data against gene lists from other studies. We include example datasets of differentially expressed genes (DEGs) from human postmortem brain samples from Autism Spectrum Disorder (ASD) and matched controls. We demonstrate how MGEnrichment can be used to expand the interpretations of these DEG lists in terms of regulation of microglial gene expression and provide novel insights into how ASD DEGs may be implicated specifically in microglial development, microbiome responses and relationships to other neuropsychiatric disorders. This tool will be particularly useful for those working in microglia, autism spectrum disorders, and neuro-immune activation research. MGEnrichment is available at https://ciernialab.shinyapps.io/MGEnrichmentApp/ and further online documentation and datasets can be found at https://github.com/ciernialab/MGEnrichmentApp. The app is released under the GNU GPLv3 open source license.

Author summary

Recent technological and computational advances have produced a massive amount of sequencing data that is often inaccessible to the non-bioinformatician. This is particularly true in multi-disciplinary areas of study such as neuro-immunology, where scientists come from a diversity of background fields. We developed a tool to allow wet-lab scientists without computational skills to utilize previous findings on microglia, the innate immune cells of the brain. Our web hosted tool allows users to compare their genes of interest against a large database of previously published gene lists relevant to microglia and brain disorders. With just a few clicks on the interface, users can upload their genes of interest from mouse or human studies, and query their list by selecting options for running statistical analysis. The application compares the user input to each database list, performs a statistical comparison and returns the results to the user, which can be viewed within the application or downloaded for publication. We have included two example datasets of genes from Autism Spectrum Disorder human brain samples. With these example datasets we demonstrate that this type of analysis can be utilized to identify new biological insights and high priority targets for further study in the lab.

http://dx.doi.org/10.13039/501100000024 Canadian Institutes of Health Research 950-232402 https://orcid.org/0000-0002-3406-3806
Ciernia Annie Vogel http://dx.doi.org/10.13039/501100000038 Natural Sciences and Engineering Research Council of Canada RGPIN-2019-04450 https://orcid.org/0000-0002-3406-3806
Ciernia Annie Vogel http://dx.doi.org/10.13039/501100000038 Natural Sciences and Engineering Research Council of Canada DGECR-2019-00069 https://orcid.org/0000-0002-3406-3806
Ciernia Annie Vogel http://dx.doi.org/10.13039/501100000196 Canada Foundation for Innovation CFI 38190 https://orcid.org/0000-0002-3406-3806
Ciernia Annie Vogel http://dx.doi.org/10.13039/501100000165 Sick Kids Foundation NI20-1004 https://orcid.org/0000-0002-3406-3806
Ciernia Annie Vogel http://dx.doi.org/10.13039/100000874 Brain and Behavior Research Foundation 26784 https://orcid.org/0000-0002-3406-3806
Ciernia Annie Vogel NeuroImaging and NeuroComputation Centre at the Djavad Mowafaghian Centre for Brain Health RRID: SCR_019086 This work was supported by the Canadian Institutes for Health Research [CRC-RS 950-232402 to AC]; Natural Sciences and Engineering Research Council of Canada [RGPIN-2019-04450, DGECR-2019-00069 to AC]; Canada Foundation for Innovation / John R. Evans Leaders Fund – Partnerships [CFI 38190 to AC]; SickKids Foundation [NI20-1004 to AC]; and Brain and Behavior Research Foundation [Young Investigator Award 26784 to AC]. This work was supported by resources made available through the NeuroImaging and NeuroComputation Centre at the Djavad Mowafaghian Centre for Brain Health (RRID: SCR_019086). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript. Data AvailabilityAll relevant data are within the manuscript and its Supporting Information files. Relevant code can be found here: https://github.com/ciernialab/MGEnrichmentApp.
Data Availability

All relevant data are within the manuscript and its Supporting Information files. Relevant code can be found here: https://github.com/ciernialab/MGEnrichmentApp.
==== Body
pmcThis is a PLOS Computational Biology Software paper.

Introduction

With the recent advances in sequencing technology, researchers are increasingly able to generate larger amounts of genomic data. Investigating changes in gene expression has allowed neuroscientists to move beyond the high-level analysis of cellular dynamics, and into the investigation of the molecular and biochemical pathways and networks underlying brain disorders [1]. For example, in the developing brain, early life insults can produce rapid and long-lasting changes to gene expression that alter the neuro-immune system and behaviour [2,3]. Microglia, the brain’s resident innate immune cells, appear particularly vulnerable to early life genetic and environmental risk factors for neurodevelopmental, psychiatric and neurodegenerative disorders [4]. As sequencing costs have dropped in recent years [5] and the ability to isolate microglial populations from the brain has expanded, a number of key microglial signature gene lists have been identified across disease models [6] and development [7–10]. The ease at which this data can be generated and incorporated into various experiments has led to gene expression analysis now being utilized not just in hypothesis testing, but also in hypothesis generation [11]. These microglial gene expression differences have been successfully examined across labs and contexts to identify conserved targets and patterns disrupted across brain disorders [2,12]. However, there is currently no central repository for published microglial gene lists, nor a user friendly, non-programmatic interface that allows biologists to statistically test their gene list of interest for enrichment of identified microglial gene lists from other studies.

Several enrichment tools currently exist to assist users in interrogating their gene expression results, such as enrichment of Gene Ontologies using tools such as DAVID [13], Gene Set Enrichment Analysis (GSEA) [14], or KEGG pathways [15,16]. However, these interfaces are not specific to individual cell types nor brain disorders and may not accurately reflect microglial-specific processes or disease states. In comparison, direct gene list comparisons to published microglia datasets can lead to cell type or cell state specific insights into underlying microglial mechanisms. However, this requires access to both a curated database of microglial gene lists and the programmatic skills to implement the analysis and statistics. These obstacles can present a daunting challenge for the non-programming wet-lab scientist. With the increasing use of RNA sequencing (RNAseq) and other expression analysis approaches by biologists, there is a growing need for non-programming based tools that allow for efficient analysis without extensive bioinformatic experience. This need is particularly great in the area of neuro-immunology which attracts researchers from a broad set of backgrounds such as neuroscience, immunology, and others.

Our lab has thus developed MGEnrichment (Microglia Enrichment), a customized web application for performing enrichment testing on a manually curated database of gene lists pertinent to microglia. A key feature of our application is the user’s ability to easily upload a list of genes of interest as either mouse or human gene identifiers, as well as the accessibility of customizing background gene list settings. The application is intended for use by wet-lab scientists who wish to quickly assess the relevance of their gene expression results, and will be of particular interest to those working in the field of microglia research, brain disorders, and neuro-immune activation.

Design and implementation

The base functionality of the app was built using the R Shiny package (https://shiny.rstudio.com/), and hosted using shinyapps.io by RStudio. MGEnrichment allows the user to upload a list of genes from their experiment in three common gene identifier (ID) formats (Ensembl, Entrez, gene symbols) for either mouse or human (Fig 1). Depending on which gene ID format and species are entered, the database of microglial gene lists (queried from the R biomaRt package [17]) is filtered for the matching ID type and species. Users can select between setting the background as all mouse or human genes, all the genes in the microglial gene list database, or an optional user-specified list of background genes. MGEnrichment then performs a one-tailed Fisher’s exact test using the GeneOverlap package [18] to compare the overlap between the user’s input list and each list in the microglia database. Statistical significance is calculated relative to the background gene list and a False Discovery Rate (FDR) correction is then applied across all comparisons. The level of FDR correction is controlled by the user, allowing for greater flexibility in the statistical threshold used for significance determination.

10.1371/journal.pcbi.1009160.g001 Fig 1 Model of MGEnrichment.

Users can select either mouse or human gene lists and upload their gene lists of interest either through a CSV file or through entry into the GUI. The input dataset is compared against the database of microglia gene lists to determine enrichment. The GeneOverlap package is used to calculate a one-tailed Fisher’s Exact Test for enrichment in each gene list, and FDR corrected p-values are then calculated across all comparisons. The enriched gene results and corresponding statistical significance are then viewable via the GUI, or exportable via CSV. ASD = Autism Spectrum Disorder.

Enrichment results display several key output variables including the odds ratio, p-value, FDR corrected p-value, and the number and IDs of the overlapping genes for each database list (Fig 2). Information is also provided regarding individual microglial database gene lists, including the group they belong to, a description of the gene list, the species the gene list was collected from, as well as a literature source for where the gene list originates. These results may be viewed directly on the web browser or as a downloaded CSV file.

10.1371/journal.pcbi.1009160.g002 Fig 2 Preview of MGEnrichment, as previewed on a Web Browser.

The left panel includes user-input and possible modifications to results, while the table on the right outputs the user query results for each gene list.

The database contains 214 unique microglial gene lists from 42 publications pulled from the microglial literature (S1 Table). Gene lists from mouse, rat and human are included. For the mouse version of the database, all human and rat gene IDs were converted to mouse using bioMart. For the human version of the database all mouse and rat gene IDs were converted to human gene IDs using bioMart. The database of gene lists was manually curated from previous literature and includes a wide assortment of microglial relevant gene lists collected from multiple treatments, disease states and developmental timepoints in microglia or brain. Additional gene lists can be added to the database directly using example code provided in the GitHub repository or by request through GitHub. Users may select from several background options including uploading a custom background list. Users can select subsets of gene lists from the database based on six different list categories (groups). Group options include Microglia, Microglia Development, Neuropsychiatric & Neurodevelopmental Disorders, Autism genetics, Autism regulators, and Inflammation. The user can select the groups to be included, allowing for more targeted analysis to a specific subgrouping within the database.

To demonstrate the utility of our approach we created two “toy” datasets that examine gene regulation in ASD. Microglial dysregulation has been observed in ASD postmortem brain samples in terms of altered cellular morphology and gene expression. Specifically, there have been three large-scale, recent RNAseq studies examining differentially expressed genes from human ASD postmortem brain compared to matched controls [19–21]. All three identified immune, and specifically microglial, gene expression as altered in ASD brain [19–21]. We took the published gene lists from these papers, divided them into genes with either increased or decreased expression in ASD and then overlapped the three sets to identify genes consistently identified in at least 2 out of the 3 publications. Users can access these datasets by clicking their respective buttons on the application with the desired species selected, and querying the database to look for gene list enrichments. Alternatively, a compiled supplemental excel spreadsheet (S2 Table) of both mouse and human toy datasets and the corresponding MGErichment results can be downloaded from the GitHub repository. Human enrichments were calculated using Human Ensembl gene IDs, with the background set to “All hg38 Genes”, queried against all gene list groups, and with FDR filtering for q<0.05. Similarly, mouse enrichments were calculated using Mouse Ensembl gene IDs (after conversion from human using BioMart), with the background set to “All mm10 Genes”, queried against all gene list groups, and with FDR filtering for q<0.05.

Results

The MGEnrichment app is setup so that users can easily query the microglia database to analyze the gene expression profiles of their lists (mouse or human) compared to selected lists from the database. The provided toy ASD increased gene expression dataset (ASD>CTRL DEGs) produces numerous significant (FDR q<0.05) enrichments with database gene lists. For example, using the Human Ensembl IDs, ASD>CTRL DEGs are significantly enriched for genes with increased expression in schizophrenia, a relationship previously identified [21]. There were also significant enrichments with gene lists important for microglial development, gene regulation (Sall1 and Mef2c) and immune activation (PolyI:C and LPS treatments) (S2 Table). There were also significant enrichments with gene lists generated from microglia from germ free mice, supporting a recent growing literature on the role of the microbiome in ASD [22] and suggesting microbiome disturbances associated with the disorder may contribute to altered brain microglia. From these enrichments, individual genes of interest can be identified among the shared genes to identify novel targets for further investigation. For example, our target toy list (ASD>CTRL DEGs) shares genes with higher expression in amoeboid compared to ramified microglia. These genes might be reasonable targets for further exploration to explain previously observed changes in microglia morphology in human post-mortem brain from ASD [23,24].

Similarly, using the Human Ensembl IDs for genes with decreased expression in ASD brain (ASD<CTRL DEGs) produces significant overlaps with lists for other human neuropsychiatric disorders as well as genes regulated in microglial development (S2 Table). The developmental list enrichments all center around lists of differentially expressed genes between embryonic day 18 (E18) microglia and postnatal microglia (P4, P14 and P60), suggesting that genes with disruption in ASD may impact embryonic microglia maturation towards a postnatal transcriptome.

Together, our two example datasets demonstrate the utility of MGEnrichment in exploring microglial gene regulation in neurodevelopmental disorders. The app can provide both novel insights into differentially expressed gene lists, as well as identification of microglial target genes for further examination.

Availability and future directions

The code for the application is freely available on our GitHub repository, and released under the GNU General Public License version 3 (GPLv3). By releasing this under an open source license, we aim to provide transparency as to how our program was designed, as well as invite collaboration and contributions from others in the field. Documentation for MGEnrichment is provided within a “help” tab of the web application and at https://github.com/ciernialab/MGEnrichmentApp. All source code is included on the GitHub repository, including the microglia gene list database and instructions for adding in new custom gene lists to the database.

MGEnrichment allows for a targeted approach to understanding microglial biology by leveraging known changes in gene expression across different disease and developmental states. As genomics becomes increasingly intertwined with neuro-immunology and behavioural neuroscience research, the ability to interpret gene expression results within the broader context of microglial biology will be a key skillset for many researchers. We have developed MGEnrichment to accomplish two main goals: firstly, to disseminate an easy to access database of curated microglia-relevant gene lists; secondly, to provide a user-friendly interface for non-programmers to examine their gene lists of interest for impacts on microglial biology. MGEnrichment’s hosting on the web through the R Shiny platform allows any user to easily query their gene list of interest and download their results for further analysis.

Future directions for the project include expansion to include additional types of data visualization, such as dot plots to better visualize the level of gene enrichment and network visualizations to support more systems-based analyses. It is our hope that this app will act as a useful tool to bridge the gap between wet and dry-lab scientists in microglial research, and to help traditional behavioural neuroscientists and immunologists to interpret changes in microglial gene regulation.

Supporting information

S1 Table MG Database.

Sheet 1: MG Mouse Database. Includes an entry for each gene list in the curated mouse database, description of the gene list, source/citation, group assignment, species of the original study, tissue and the number of Ensembl mouse IDs within that list. Sheet 2: MG Human Database. Includes an entry for each gene list in the curated human database, description of the gene list, source/citation, group assignment, species of the original study, tissue and the number of Ensembl human IDs within that list.

(XLSX)

Click here for additional data file.

S2 Table Toy Dataset.

Sheet 1: ASD>CTRL_DEGs_Datasets. Includes the input dataset containing the human and mouse Ensembl IDs for genes identified across 2 out of 3 human brain RNA-seq studies comparing brain samples from ASD and Controls. DEGs show higher expression in ASD compared to Control samples. Human IDs were converted to mouse IDs using BioMart. Sheet 2: ASD<CTRL_DEGs_Datasets. Includes the input dataset containing the human and mouse Ensembl IDs for genes identified across 2 out of 3 human brain RNA-seq studies comparing brain samples from ASD and Controls. DEGs show lower expression in ASD compared to Control samples. Human IDs were converted to mouse IDs using BioMart. Sheet 3: Human ASD>CTRL Results. FDR filtered (q<0.05) enrichment results are shown for all significant enrichments between ASD>CTRL DEGs and gene lists in the MGEnrichment database run using human Ensembl IDs from Sheet 1. Sheet 4: Human ASD<CTRL Results. FDR filtered (q<0.05) enrichment results are shown for all significant enrichments between ASD<CTRL DEGs and gene lists in the MGEnrichment database run using human Ensembl IDs from Sheet 2. Sheet 5: Mouse ASD>CTRL Results. FDR filtered (q<0.05) enrichment results are shown for all significant enrichments between ASD>CTRL DEGs and gene lists in the MGEnrichment database run using mouse Ensembl IDs from Sheet 1. Sheet 6: Mouse ASD<CTRL Results. FDR filtered (q<0.05) enrichment results are shown for all significant enrichments between ASD<CTRL DEGs and gene lists in the MGEnrichment database run using mouse Ensembl IDs from Sheet 2.

(XLSX)

Click here for additional data file.

We would like to thank members of the Ciernia, Tropini and Osborne labs at UBC for helpful feedback on this project.

10.1371/journal.pcbi.1009160.r001
Decision Letter 0
Pertea Mihaela Software Editor
© 2021 Mihaela Pertea
2021
Mihaela Pertea
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
Submission Version0
17 Jul 2021

Dear Dr. Ciernia,

Thank you very much for submitting your manuscript "MGEnrichment: a web application for microglia gene list enrichment analysis" for consideration at PLOS Computational Biology.

As with all papers reviewed by the journal, your manuscript was reviewed by members of the editorial board and by several independent reviewers. In light of the reviews (below this email), we would like to invite the resubmission of a significantly-revised version that takes into account the reviewers' comments.

We cannot make any decision about publication until we have seen the revised manuscript and your response to the reviewers' comments. Your revised manuscript is also likely to be sent to reviewers for further evaluation.

When you are ready to resubmit, please upload the following:

[1] A letter containing a detailed list of your responses to the review comments and a description of the changes you have made in the manuscript. Please note while forming your response, if your article is accepted, you may have the opportunity to make the peer review history publicly available. The record will include editor decision letters (with reviews) and your responses to reviewer comments. If eligible, we will contact you to opt in or out.

[2] Two versions of the revised manuscript: one with either highlights or tracked changes denoting where the text has been changed; the other a clean version (uploaded as the manuscript file).

Important additional instructions are given below your reviewer comments.

Please prepare and submit your revised manuscript within 60 days. If you anticipate any delay, please let us know the expected resubmission date by replying to this email. Please note that revised manuscripts received after the 60-day due date may require evaluation and peer review similar to newly submitted manuscripts.

Thank you again for your submission. We hope that our editorial process has been constructive so far, and we welcome your feedback at any time. Please don't hesitate to contact us if you have any questions or comments.

Sincerely,

Mihaela Pertea

Software Editor

PLOS Computational Biology

Mihaela Pertea

Software Editor

PLOS Computational Biology

***********************

Reviewer's Responses to Questions

Comments to the Authors:

Please note here if the review is uploaded as an attachment.

Reviewer #1: This manuscript describes a novel computational software/tool to assess overlap (and statistical significance of the overlap) between a user’s list of genes of interest and target ensemble of genes expressed by microglia in defined conditions. Microglial cells are at the center of intense research in neuroscience, owing to their roles in neurodevelopmental disorders, neurodegenerative disorders, and basic brain biology in general. As also pointed out by the authors, there has been a tremendous accumulation of high-quality transcriptomic data associated with microglia over these past 5-6 years. These include both bulk RNA-seq and single-cell RNA-seq. Furthermore, many groups now rely on direct comparisons with these published datasets to guide their studies. This is done to either cross-validate their own experimental results or to justify molecular targets of interest for specific experiments.

Given the above, release of MGEnrichment is timely and will likely facilitate data analysis and interpretation. Based on my testing, it is quite user-friendly, and results are quickly generated. Thus, its intended audience (i.e., people not well-versed in computational analyses) should find it accessible. That being said, it is a little perplexing to see that recent seminal work on human microglia were not included in the first iteration of the software. For example, work from Bart Eggen’s lab (PMID 28671693 and 32732419) and Chris Glass’ lab (e.g., PMID 28546318) have provided high-quality, comprehensive datasets of microglial gene expression from human microglia, and these are frequently used as baseline to generate and refine protocols for the generation of ips-derived microglia. My guess is that this may be an issue of setting-up a “human-based” analysis arm so that human genes and their identifiers are properly treated when entered as input. Irrespective of the reasons however, I would be inclined to ask that the authors add a human component, as the resulting enhanced scope would be better aligned with the goal of PLOS Computational Biology. Moreover, given the significant efforts devoted to research on human microglia and ips-derived microglia in the context of neurodegenerative disorders, a human component would necessarily reach a larger audience, which would allow MGEnrichment to set itself better as a key reference in the field.

Reviewer #2: Summary of MGEnrichment: a web application for microglia gene list enrichment analysis

The authors address the lack of a central repository for microglial gene expression signatures by creating MGEnrichment, a non-programmatic web application for microglia gene enrichment analysis. The database includes 166 microglial gene lists from human, mouse and rat. This could assist non-programming scientists in their analyses of gene expression data in a cell-type-specific or disorder-specific way.

This tool is created using the Shiny R package, which allows its users to upload their own gene list and define a background gene list. Using the GeneOverlap R package, MGEnrichment then performs a one-tailed Fisher’s exact test to compare the input data against each of the lists from the database. A combination of any subset or all lists from the microglia database can be used for the enrichment analysis. The subsets include: microglia, microglia development, neuropsychiatric & neurodevelopmental disorders human brain, autism genetics, autism regulators, and inflammation. The p-value is then computed to evaluate statistical significance, followed by a False Discovery Rate (FDR) calculation. The app provides users the flexibility to set an FDR threshold. Finally, the output is presented on the web browser and a downloadable CSV file. This could be particularly useful for scientists with an interest in microglia and neuro-immunology.

To validate the applicability of MGEnrichment, Jao et al used two “toy” datasets: ASD>CTRL DEGs and ASD<ctrl asd="" degs.="">CTRL DEGs is a gene list that is increasingly expressed in autism spectrum disorder (ASD), whereas ASD<ctrl an="" asd="" brain.="" come="" dataset.="" datasets="" decreased="" degs="" examined="" expression="" four="" from="" gene="" in="" is="" postmortem="" querying="" rnaseq="" studies="" that="" the="" these="" upon="">

In summary, we found the article and web tool of high quality and of appropriate scope for PLoS Comp Bio. We (myself and members of my lab) were able to adequately test the tool and found its functionality helpful in interpreting microglial gene sets that we had generated in our lab. We were able to use the app to understand the enrichment of multiple gene sets related to microglia. The careful curation and standardization of multiple microglia-related gene sets is an especially valuable contribution of this work.

We had a few minor comments with the manuscript / list of datasets with microglial datasets:

• It’d be helpful to include a table in the manuscript listing the datasets and publications used

• How carefully was the literature curated, in particular, the list of human microglial subtypes? We found the omission of the datasets presented in Olah et al., 2020 as one such missing dataset we had expected to be included: https://www.nature.com/articles/s41467-020-19737-2

In using the associated web application, we noticed a few points for improvement that would greatly increase the usability of the application.

• Given that our gene lists were based on analyses of human cells, we found it inconvenient to have to first convert these genes to the equivalent gene names in the mouse. This seemed non-intuitive and unnecessary, especially as a number of the gene lists are based on human gene expression profiles. I suggest adding functionality to allow the user to enter what species their gene names are entered as, and do the conversion of the symbols within the app.

• The gene list groups that are selected by default are non-intuitive. Given that this is a microglia enrichment tool, it seems more useful and intuitive to have only the microglia, microglia development, and inflammation gene list groups selected by default.

• It’d be more useful to pick a more meaningful default for the minimum FDR value – I’d suggest a value of 0.1 instead of 1.0.

• The notAnotB inAnotB terminology is not intuitive. Consider using the terms N K n k from hypergeometric test: https://en.wikipedia.org/wiki/Hypergeometric_distribution

• There are a lot of columns displayed within the tool – are all of these really necessary? I don’t find it particularly helpful to show both the intersection IDs, intersection ensembl, intersection mgi symbol, etc etc. I think merely showing the gene symbols would be more than sufficient. Showing all of these columns makes each row within the app very long and challenging to scroll through.

• The sorting of results that are displayed in the table would be considerably more intuitive if the table was sorted by default in order of increasing pvalue or FDR.

• Is it possible to have the source publications be listed as hyperlinks with links to the publications at pubmed?

• Please think carefully about where columns in the table should appear. For example, I found the shortnames for each condition somewhat difficult to parse. The problem would likely be fixed if the columns listname, shortname, and description were closer to one another (also – why do you need all 3).</ctrl></ctrl>

**********

Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?

The PLOS Data policy requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.

Reviewer #1: Yes

Reviewer #2: Yes

**********

PLOS authors have the option to publish the peer review history of their article (what does this mean?). If published, this will include your full peer review and any attached files.

If you choose “no”, your identity will remain anonymous but your review may still be made public.

Do you want your identity to be public for this peer review? For information about this choice, including consent withdrawal, please see our Privacy Policy.

Reviewer #1: No

Reviewer #2: No

Figure Files:

While revising your submission, please upload your figure files to the Preflight Analysis and Conversion Engine (PACE) digital diagnostic tool, https://pacev2.apexcovantage.com. PACE helps ensure that figures meet PLOS requirements. To use PACE, you must first register as a user. Then, login and navigate to the UPLOAD tab, where you will find detailed instructions on how to use the tool. If you encounter any issues or have any questions when using PACE, please email us at figures@plos.org.

Data Requirements:

Please note that, as a condition of publication, PLOS' data policy requires that you make available all data used to draw the conclusions outlined in your manuscript. Data must be deposited in an appropriate repository, included within the body of the manuscript, or uploaded as supporting information. This includes all numerical values that were used to generate graphs, histograms etc.. For an example in PLOS Biology see here: http://www.plosbiology.org/article/info%3Adoi%2F10.1371%2Fjournal.pbio.1001908#s5.

Reproducibility:

To enhance the reproducibility of your results, we recommend that you deposit your laboratory protocols in protocols.io, where a protocol can be assigned its own identifier (DOI) such that it can be cited independently in the future. Additionally, PLOS ONE offers an option to publish peer-reviewed clinical study protocols. Read more information on sharing protocols at https://plos.org/protocols?utm_medium=editorial-email&utm_source=authorletters&utm_campaign=protocols

10.1371/journal.pcbi.1009160.r002
Author response to Decision Letter 0
Submission Version1
3 Sep 2021

Attachment Submitted filename: ResponsetoReviews.pdf

Click here for additional data file.

10.1371/journal.pcbi.1009160.r003
Decision Letter 1
Pertea Mihaela Software Editor
© 2021 Mihaela Pertea
2021
Mihaela Pertea
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
Submission Version1
19 Oct 2021

Dear Dr. Ciernia,

We are pleased to inform you that your manuscript 'MGEnrichment: a web application for microglia gene list enrichment analysis' has been provisionally accepted for publication in PLOS Computational Biology.

Before your manuscript can be formally accepted you will need to complete some formatting changes, which you will receive in a follow up email. A member of our team will be in touch with a set of requests.

Please note that your manuscript will not be scheduled for publication until you have made the required changes, so a swift response is appreciated.

IMPORTANT: The editorial review process is now complete. PLOS will only permit corrections to spelling, formatting or significant scientific errors from this point onwards. Requests for major changes, or any which affect the scientific understanding of your work, will cause delays to the publication date of your manuscript.

Should you, your institution's press office or the journal office choose to press release your paper, you will automatically be opted out of early publication. We ask that you notify us now if you or your institution is planning to press release the article. All press must be co-ordinated with PLOS.

Thank you again for supporting Open Access publishing; we are looking forward to publishing your work in PLOS Computational Biology. 

Best regards,

Mihaela Pertea

Software Editor

PLOS Computational Biology

Mihaela Pertea

Software Editor

PLOS Computational Biology

***********************************************************

Reviewer's Responses to Questions

Comments to the Authors:

Please note here if the review is uploaded as an attachment.

Reviewer #1: The authors have addressed my original concerns with this resubmission.

Reviewer #2: No further comments. The authors have done an excellent job responding to my prior review. I especially commend the authors on implementing all of the suggestions to improve the usability of the web app.

**********

Have the authors made all data and (if applicable) computational code underlying the findings in their manuscript fully available?

The PLOS Data policy requires authors to make all data and code underlying the findings described in their manuscript fully available without restriction, with rare exception (please refer to the Data Availability Statement in the manuscript PDF file). The data and code should be provided as part of the manuscript or its supporting information, or deposited to a public repository. For example, in addition to summary statistics, the data points behind means, medians and variance measures should be available. If there are restrictions on publicly sharing data or code —e.g. participant privacy or use of data from a third party—those must be specified.

Reviewer #1: Yes

Reviewer #2: Yes

**********

PLOS authors have the option to publish the peer review history of their article (what does this mean?). If published, this will include your full peer review and any attached files.

If you choose “no”, your identity will remain anonymous but your review may still be made public.

Do you want your identity to be public for this peer review? For information about this choice, including consent withdrawal, please see our Privacy Policy.

Reviewer #1: No

Reviewer #2: Yes: Shreejoy J Tripathy

10.1371/journal.pcbi.1009160.r004
Acceptance letter
Pertea Mihaela Software Editor
© 2021 Mihaela Pertea
2021
Mihaela Pertea
https://creativecommons.org/licenses/by/4.0/ This is an open access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.
1 Nov 2021

PCOMPBIOL-D-21-01028R1

MGEnrichment: a web application for microglia gene list enrichment analysis

Dear Dr Ciernia,

I am pleased to inform you that your manuscript has been formally accepted for publication in PLOS Computational Biology. Your manuscript is now with our production department and you will be notified of the publication date in due course.

The corresponding author will soon be receiving a typeset proof for review, to ensure errors have not been introduced during production. Please review the PDF proof of your manuscript carefully, as this is the last chance to correct any errors. Please note that major changes, or those which affect the scientific understanding of the work, will likely cause delays to the publication date of your manuscript.

Soon after your final files are uploaded, unless you have opted out, the early version of your manuscript will be published online. The date of the early version will be your article's publication date. The final article will be published to the same URL, and all versions of the paper will be accessible to readers.

Thank you again for supporting PLOS Computational Biology and open-access publishing. We are looking forward to publishing your work!

With kind regards,

Livia Horvath

PLOS Computational Biology | Carlyle House, Carlyle Road, Cambridge CB4 3DN | United Kingdom ploscompbiol@plos.org | Phone +44 (0) 1223-442824 | ploscompbiol.org | @PLOSCompBiol
==== Refs
References

1 Geschwind DH , Konopka G . Neuroscience in the era of functional genomics and systems biology. Nature. 2009. doi: 10.1038/nature08537 19829370
2 Vogel Ciernia A , Careaga M , LaSalle JM , Ashwood P . Microglia from offspring of dams with allergic asthma exhibit epigenomic alterations in genes dysregulated in autism. Glia. 2018;66 : 505–521. doi: 10.1002/glia.23261 29134693
3 Schwartzer JJ , Careaga M , Coburn MA , Rose DR , Hughes HK , Ashwood P . Behavioral impact of maternal allergic-asthma in two genetically distinct mouse strains. Brain Behav Immun. 2017;36 : 99–107. doi: 10.1016/j.bbi.2016.09.007 27622677
4 Thion MS , Garel S . On place and time: microglia in embryonic and perinatal brain development. Current Opinion in Neurobiology. 2017. pp. 121–130. doi: 10.1016/j.conb.2017.10.004 29080445
5 Wetterstrand K . DNA Sequencing Costs: Data from the NHGRI Genome Sequencing Program (GSP). In: genome.gov [Internet]. 2021. Available: www.genome.gov/sequencingcostsdata.
6 Keren-Shaul H , Spinrad A , Weiner A , Matcovitch-Natan O , Dvir-Szternfeld R , Ulland TK , et al . A Unique Microglia Type Associated with Restricting Development of Alzheimer’s Disease. Cell. 2017;169 : 1276–1290.e17. doi: 10.1016/j.cell.2017.05.018 28602351
7 Matcovitch-Natan O , Winter DR , Giladi A , Vargas Aguilar S , Spinrad A , Sarrazin S , et al . Microglia development follows a stepwise program to regulate brain homeostasis. Science. 2016;353 : aad8670. doi: 10.1126/science.aad8670 27338705
8 Thion MS , Low D , Silvin A , Chen J , Grisel P , Schulte-Schrepping J , et al . Microbiome Influences Prenatal and Adult Microglia in a Sex-Specific Manner. Cell. 2018;172 : 500–516.e16. doi: 10.1016/j.cell.2017.11.042 29275859
9 Hammond TR , Dufort C , Dissing-Olesen L , Giera S , Young A , Wysoker A , et al . Single-Cell RNA Sequencing of Microglia throughout the Mouse Lifespan and in the Injured Brain Reveals Complex Cell-State Changes. Immunity. 2019. doi: 10.1016/j.immuni.2018.11.004 30471926
10 Li Q , Cheng Z , Zhou L , Darmanis S , Neff NF , Okamoto J , et al . Developmental Heterogeneity of Microglia and Brain Myeloid Cells Revealed by Deep Single-Cell RNA Sequencing. Neuron. 2019. doi: 10.1016/j.neuron.2018.12.006 30606613
11 Holtman IR , Raj DD , Miller JA , Schaafsma W , Yin Z , Brouwer N , et al . Induction of a common microglia gene expression signature by aging and neurodegenerative conditions: a co-expression meta-analysis. Acta Neuropathol Commun. 2015;3 : 1–18. doi: 10.1186/s40478-014-0179-6 25627031
12 Vogel Ciernia A , Laufer BI , Hwang H , Dunaway KW , Mordaunt CE , Coulson RL , et al . Epigenomic Convergence of Neural-Immune Risk Factors in Neurodevelopmental Disorder Cortex. Cereb Cortex. 2019;bhz115. doi: 10.1093/cercor/bhz015 30796800
13 Jr GD, Sherman BT , Hosack DA , Yang J . DAVID: Database for Annotation, Visualization, and Integrated Discovery. 2003;4 : P3. 12734009
14 Subramanian A , Tamayo P , Mootha VK , Mukherjee S , Ebert BL . Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles. 2005;102 : 15545–15550.
15 Kanehisa M , Goto S , Sato Y , Furumichi M , Tanabe M . KEGG for integration and interpretation of large-scale molecular data sets. 2012;40 : D109–14. doi: 10.1093/nar/gkr988 22080510
16 Ogata H , Goto S , Sato K , Fujibuchi W , Bono H , Kanehisa M . KEGG: Kyoto Encyclopedia of Genes and Genomes. 1999;27 : 29–34. doi: 10.1093/nar/27.1.29 9847135
17 Durinck S , Spellman PT , Birney E , Huber W . Mapping identifiers for the integration of genomic datasets with the R/ Bioconductor package biomaRt. Nat Protoc. 2009. doi: 10.1038/nprot.2009.97 19617889
18 Shen L . GeneOverlap: An R package to test and visualize gene overlaps. Mount Sinai; 2013. Available: http://shenlab-sinai.github.io/shenlab-sinai/
19 Gupta S , Ellis SE , Ashar FN , Moes A , Bader JS , Zhan J , et al . Transcriptome analysis reveals dysregulation of innate immune response genes and neuronal activity-dependent genes in autism. Nat Commun. 2014;5 : 5748. doi: 10.1038/ncomms6748 25494366
20 Parikshak NN , Swarup V , Belgard TG , Irimia M , Ramaswami G , Gandal MJ , et al . Genome-wide changes in lncRNA, splicing, and regional gene expression patterns in autism. Nature. 2016;540 : 423–427. doi: 10.1038/nature20612 27919067
21 Gandal MJ , Haney J , Parikshak N , Leppa V , Horvath S , Geschwind DH . Shared molecular neuropathology across major psychiatric disorders parallels polygenic overlap. Science (80-). 2018;693 : 693–697. doi: 10.1126/science.aad6469 29439242
22 Pulikkan J , Mazumder A , Grace T . Role of the Gut Microbiome in Autism Spectrum Disorders. Advances in Experimental Medicine and Biology. Springer New York LLC; 2019. pp. 253–269. doi: 10.1007/978-3-030-05542-4_13
23 Morgan JT , Chana G , Pardo CA , Achim C , Semendeferi K , Buckwalter J , et al . Microglial activation and increased microglial density observed in the dorsolateral prefrontal cortex in autism. Biol Psychiatry. 2010;68 : 368–376. doi: 10.1016/j.biopsych.2010.05.024 20674603
24 Morgan JT , Barger N , Amaral DG , Schumann CM . Stereological Study of Amygdala Glial Populations in Adolescents and Adults with Autism Spectrum Disorder. PLoS One. 2014;9 : e110356. doi: 10.1371/journal.pone.0110356 25330013

