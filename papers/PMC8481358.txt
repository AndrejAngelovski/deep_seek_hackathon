
==== Front
Brain Inform
Brain Inform
Brain Informatics
2198-4018
2198-4026
Springer Berlin Heidelberg Berlin/Heidelberg

34586519
140
10.1186/s40708-021-00140-6
Research
Modeling brain connectivity dynamics in functional magnetic resonance imaging via particle filtering
http://orcid.org/0000-0002-1972-0556
Ambrosi Pierfrancesco pfa2804@gmail.com

1
Costagli Mauro 23
Kuruoğlu Ercan E. 46
Biagi Laura 35
Buonincontri Guido 35
Tosetti Michela 35
1 grid.8404.8 0000 0004 1757 2304 Department of Neuroscience, Psychology, Pharmacology and Child Health, University of Florence, Florence, Italy
2 grid.5606.5 0000 0001 2151 3065 Department of Neurosciences, Rehabilitation, Ophthalmology, Genetics, and Maternal-and-Child Sciences, University of Genoa, Genova, Italy
3 Laboratory of Medical Physics and Magnetic Resonance, IRCCS Stella Maris, Pisa, Italy
4 grid.499361.0 Tsinghua-Berkeley Shenzhen Institute, Data Science and Information Technology Center, Shenzhen, China
5 Imago 7 Research Center, Pisa, Italy
6 grid.5326.2 0000 0001 1940 4177 Information Science and Technology Institute (ISTI), National Council of Research (CNR), Pisa, Italy
29 9 2021
29 9 2021
12 2021
8 1 1929 1 2021
16 8 2021
© The Author(s) 2021
https://creativecommons.org/licenses/by/4.0/ Open AccessThis article is licensed under a Creative Commons Attribution 4.0 International License, which permits use, sharing, adaptation, distribution and reproduction in any medium or format, as long as you give appropriate credit to the original author(s) and the source, provide a link to the Creative Commons licence, and indicate if changes were made. The images or other third party material in this article are included in the article's Creative Commons licence, unless indicated otherwise in a credit line to the material. If material is not included in the article's Creative Commons licence and your intended use is not permitted by statutory regulation or exceeds the permitted use, you will need to obtain permission directly from the copyright holder. To view a copy of this licence, visit http://creativecommons.org/licenses/by/4.0/.
Interest in the studying of functional connections in the brain has grown considerably in the last decades, as many studies have pointed out that alterations in the interaction among brain areas can play a role as markers of neurological diseases. Most studies in this field treat the brain network as a system of connections stationary in time, but dynamic features of brain connectivity can provide useful information, both on physiology and pathological conditions of the brain. In this paper, we propose the application of a computational methodology, named Particle Filter (PF), to study non-stationarities in brain connectivity in functional Magnetic Resonance Imaging (fMRI). The PF algorithm estimates time-varying hidden parameters of a first-order linear time-varying Vector Autoregressive model (VAR) through a Sequential Monte Carlo strategy. On simulated time series, the PF approach effectively detected and enabled to follow time-varying hidden parameters and it captured causal relationships among signals. The method was also applied to real fMRI data, acquired in presence of periodic tactile or visual stimulations, in different sessions. On these data, the PF estimates were consistent with current knowledge on brain functioning. Most importantly, the approach enabled to detect statistically significant modulations in the cause-effect relationship between brain areas, which correlated with the underlying visual stimulation pattern presented during the acquisition.

Keywords

Brain connectivity
fMRI
Particle filter
Sequential Monte Carlo
VAR model
http://dx.doi.org/10.13039/501100003196 Ministero della Salute issue-copyright-statement© The Author(s) 2021
==== Body
pmcIntroduction

The understanding of brain functioning is linked to the study of the dynamic interaction among anatomically segregated brain areas. These interactions are labeled functional and effective connectivity and refer to distinct ways of considering connections among brain region. While complementary to structural connectivity, which describes anatomical connections between brain regions [1], they concern functional connections that are not necessarily achieved through a direct anatomical link between brain areas. Functional connectivity regards connections as statistical codependencies between the signal of different brain regions, and consequently it is a non-directional and model-free description of the brain network. On the contrary, effective connectivity defines the temporal relationship and causal influences among brain regions in a given network model [2].

Functional Magnetic Resonance Imaging (fMRI) is frequently employed in brain connectivity studies, given its non-invasiveness and satisfactory spatiotemporal resolution, both in physiology and pathology (e.g. Alzheimer’s disease [3–5], schizophrenia [6] and Major Depression Disorder [7]). From brain connectivity studies it emerged that brain dynamics, in particular effective connectivity, may provide a biological marker for specific brain disease and a tool for monitoring responses to treatments of these pathologies [8–11].

Granger Causality (GC) and Dynamic Causal Modeling (DCM) are methods to investigate effective connectivity. Granger causality is present when knowledge on temporal evolution of the signal in a certain brain region A improves the predictability of another brain region B [12, 13]. This approach is based on the evaluation of a linear codependence among time series, and it is therefore limited to a stationary framework or needs a sliding-window approach to address time-varying coupling between regions, which has limitations [14]. Differently, in DCM the predicted relationship between neural activity and observed fMRI signal needs to be specified in a pre-determined model, hence requiring previous knowledge about the timing and effect on signals of the connectivity modulation [15].

The Sequential Monte Carlo (SMC) methodology [16] is crucially different from these two strategies. SMC approaches estimate the hidden states of a dynamic system with only partial and noisy observations, without further assumptions on the presence of variations in connectivity. A specific SMC methodology called Particle Filter (PF) employs Monte Carlo sampling to approximate probability density functions and it updates the posteriors with the arrival of new samples.

The SMC algorithm proposed here was recently developed by Ancherbak et al. [17], originally for time-varying gene network modeling. We adapted it for the study of brain connectivity using fMRI data and the feasibility and behaviour of the proposed approach has been studied on synthetic data mimicking fMRI time-series. When applied to real fMRI datasets, results were compared to correlation between delayed time series, considered as a proxy measure for stationary effective connectivity. Two different experimental paradigms were tested: the first one, whose preliminary results were presented in abstract form [18], involved tactile stimulation during an fMRI acquisition with temporal resolution of 2 s. The second experiment employed a periodic visual stimulation with significantly improved time resolution of 0.8 s.

Methodology

Model and algorithm

Particle filter [17, 19–22] is a sequential Monte Carlo methodology based on the Bayes theorem on conditional probability. Particle filters estimate the probability distributions of hidden variables of interest, modeled according to a hypothesized state-space equation. The probability density function (pdf) of the hidden variables is allowed to be time-varying and is therefore sequentially updated when new data become available. Such probability distribution is estimated from the data, modeled according to a hypothesized observation equation. In brain connectivity studies based on fMRI data, the relationship among the time-series of R different brain Regions of Interest (ROIs) xt={x1(t),⋯,xR(t)} can be modeled as a first order linear Vector Autoregressive (VAR) model [12, 21, 23–25] as:1 xi(t)=∑jRaij(t)xj(t-1)+ηi(t)i=1,…,R

or in matrix notation:2 x(t)=a(t)x(t-1)+η(t)

where3 a(t)=a11(t)a12(t)⋯a1R(t)a21(t)a22(t)⋯a2R(t)⋮⋮⋱⋮aR1(t)aR2(t)⋯aRR(t)

which is employed as the observation equation describing the relationship between the observations x(t) at time t and those at time t-1 (that is, x(t-1)); η(t) is the vector of observation noise; the matrix of hidden parameters of interest a(t) represents the causal influence exerted between different areas, and its elements aij(t) are the coefficients which represent conditional dependence. In particular, it can be assumed that elements of a(t) are allowed to be time-varying:4 aij(t)=aij(t-1)+νij(t)

where aij(t) is the ijth element of the matrix a(t), describing the influence of the jth region over the ith region, and νij(t) is the process noise (innovation) term.

The adoption of a linear model was supported by the well-established body of literature on fMRI data modelling and brain connectivity analysis at the temporal scales of fMRI data [25, 26]. The adopted autoregressive model was first-order, which was optimal on the basis of the Schwartz criterion, in accordance with previous findings [12, 25, 27].

The PF algorithm evolves from an initial probability distribution for aij(t-1), which we chose to be uniform at t=1, and through Eq. (4) it generates new possible values for aij(t). The N particles are generated from the probability distributions of the elements of ai(t): the distributions are adapted with each new observation through the mechanism provided by particle filtering, to describe for the set of coefficients aij at every time-step. The algorithm generates N particles, by updating those at the previous time point (initialized to zero at t=0) using a noise innovation term, by following Eq. 4. In our implementation, the innovation values are drawn from a Gaussian distribution. The standard deviation of this distribution follows the absolute difference between the two previous coefficient values estimated by the algorithm and constrained between a minimum of 0.1 and a maximum of 0.4: these values were chosen empirically to prevent divergence and, at the same time, capture non-stationarities.

With Eq. (2), the PF algorithm generates predicted values of the observations at time t. The desired probability density function of the parameters of interest a(t) can be estimated via Bayes theorem as follows:5 p(a(t)|x(1,⋯,t))=p(x(t)|a(t))p(a(t)|x(1,⋯,t-1))p(x(t)|x(1,⋯,t-1))

and with the assumption of Gaussian noise we have6 p(xi(t)|ai(t))=1(2πση2)R/2exp(-(xi(t)-x^i(t))22ση2)

where x^i(t) are the data estimated through Eq. (1) at time t for the i-th ROI and ai(t)={ai1,⋯,aiR} is the vector of hidden variables associated with the i-th ROI at time t, that is, the i-th row of matrix at. In Eq. 6 the value of the ai(t) elements determines the value of the estimate x^i(t), and the weight of the i-th particle.

In most applications, Eq. (5) cannot be solved analytically [28], but it can be computed through the Sequential Monte Carlo sampling scheme, which consists in representing the pdf p(a(t)|x(1,⋯,t)) as a discrete set of N particles:7 p(ai(t)|x(1,⋯,t))≈∑n=1Nwt(n)δ(ai(t)-ai(n)(t))

where wt(n) is the weight associated to the n-th particle vector ai(n)(t) for the ith row of matrix a(t) at time t. The Sequential Importance Sampling (SIS) [28] methodology provides a strategy to compute the weights. It has been shown [20] that the weights can be sequentially updated as follows:8 wt(n)∝wt-1(n)p(x(t)|ai(t)(n))

where the proportionality takes into account normalization factors. With this approach, at each time instant t we have a sample set {ai(t)(n),wt(n)} for n=1,⋯,N and for i=1,⋯,R which can be used to estimate the pdf of the parameters and to infer information about the network. However, after some iterations, most of the particles will have a very low statistical weight, resulting in a lower exploration efficiency of the algorithm. To overcome this typical problem of sequential Monte Carlo methodologies, a step called Resampling is performed. The number of effective particles was defined in [29] asNeff=1∑n=1N(wt(n))2

If Neff is below a certain arbitrary threshold the Resampling is performed: particles with weight below a certain threshold are substituted by copies of particles with sufficiently high weights and to each of the new particles set is assigned the same weight 1/N. This results in a more effective exploration of the solution space, because only statistically relevant particles remain after this step. The VAR process estimation problem using SMC was developed in [30], and it was extended and applied to time-varying gene expression networks in [17].Table 1 Schematic description of the PF algorithm

Input the BOLD fMRI data series	xt	
Set the number of particles	N (=2000 in our case)	
Set starting point for coefficients values	at=0=0	
Start PF	for t=1:T	
updating step	generate N particles from previous coefficients’ values through aij(t)=aij(t-1)+νij(t)	
estimation step	predict the values of the observations at time t from values at time t-1 with x(t)=a(t)x(t-1)+η(t) compute the likelihood between predicted values and observed values with (6) normalize the weights and resample	
End PF	end for on t	

To sum up, the resulting algorithm can be schematically expressed as in Table 1. In our implementation the procedure is repeated Nr=100 times, all independent from each other, to provide a better exploration of the solution space, and resampling was performed when Neff<30% of the total number of particles. The final outputs of the algorithm are the at computed as the average of the Nr repetitions. In this implementation, the running time was proportional to the length T of the time series, the number of particles N, the number of repetitions Nr, and it increased quadratically with the number of network nodes [31]. The algorithm was implemented in MATLAB (Mathworks, Natick, MA, U.S.A.) R2017b.

Synthetic data

To validate the proposed approach, two different synthetic networks were used.One network with R=6 nodes, each with T=100 time points, stationary coefficients generated with the MATLAB function varm() with a Signal-to-Noise Ratio (SNR) set to either ∞ (ση=0, ideal case) or 6dB.

Another network with R=2 and T=250 was used to assess the PF capability to capture time-varying hidden parameters. In this case, aij coefficients were zero except for coefficient a21, whose value switched from 1 to -1 with a period of 125 time points. The SNR was 10dB.

The first synthetic dataset allowed us to verify the reliability of the results of the PF and to decide the optimal values of the parameters; the second one allowed us to address the capability of the PF to track variations through time of the AR coefficients.

Real fMRI data

The proposed approach was also retrospectively applied to real fMRI data acquired on healthy volunteers in two different experimental set-ups, with two and four participants respectively, acquired with two-dimensional single-shot echo-planar imaging (EPI) on a 7T MRI system (MR950, GE Healthcare, Chicago, IL, U.S.A.).Motor task Time-series consisting of 240 time points with a temporal resolution of 2s were acquired on two subjects with the following acquisition parameters: Time of Echo (TE)=23ms, Flip Angle (FA)=60∘, Field of View (FoV)=(192mm)2, acquisition matrix size = 128×128, 32 slices of thickness = 1.5mm, resulting in isotropic spatial resolution of (1.5mm)3 and Time of Repetition (TR)=2s. During acquisition, the subjects’ thumb- and index-fingertips were stimulated via a pneumatic device (Linari Engineering, Pisa, Italy). The subjects’ task was to move the finger whenever it was stimulated. The fMRI data were motion-corrected using MCFLIRT [32]. Spatial smoothing was applied by using a Gaussian kernel of FWHM 3.0mm; each 4D dataset was demeaned and normalized by a single multiplicative factor; high-pass temporal filtering was applied to remove slow temporal drifts of the fMRI signal. Four ROIs were studied covering primary somatosensory (S1), primary motor (M1), supplementary motor (SM) and parietal (P) cortices. All ROIs consisted in four voxels and were manually drawn on each subject on one slice only, to avoid potential slice timing confounds (Fig. 1). The resultant time-series of each ROI were obtained by averaging the four time-series of individual voxels.

Visual task Time-series with a temporal resolution of 0.8s were acquired on four trials of either 300 time points (two subjects) or 600 (two subjects). Scanning parameters were TE=21ms, FA=48∘, FoV=(192mm)2, acquisition matrix size =64×64, 22 slices of thickness =3mm, resulting in isotropic spatial resolution of (3 mm)3 and TR=800ms. The same preprocessing steps described above for the motor task, including motion correction, spatial smoothing, normalization and signal drift removal, were adopted. Subjects underwent a periodic visual stimulation alternating between black and white dots moving along spiral trajectories over a gray background (stimulation ON) and presentation of the gray background alone (stimulation OFF). Four ROIs were studied covering the Lateral Geniculate Nucleus (LGN), the Middle temporal cortex (MT), the Primary Visual area (V1) and one control ROI in the tempo-parietal cortex (CTRL). Four voxels wide ROIs were manually drawn on each subject on one slice only.

Fig. 1 ROIs drawn on one representative subject, representing primary somatosensory (S1), primary motor (M1), supplementary motor (SM) and parietal (P) cortices

The optimal order of the autoregressive model describing the time series was 1, as estimated by the Schwartz criterion [12, 25, 27].

The particle filter was applied not only to the original time series but also to the same fMRI data shuffled in time. This test allowed to address the effective dependency of the results from the temporal order of the data, i.e. to address causal dependency through time in the data. Subsequently, the aij coefficients estimated by particle filtering were compared to the delayed correlation (DC) cij between signals xi(t) and xj(t-1) which reflect the time-invariant conditional correlation between network node (ROI) j over node i. Furthermore, the results of the PF were also compared to coefficients estimated in a stationary framework fitting a multivariate linear regression model with stationary coefficients to the data.Fig. 2 The plot on top shows the causal dependency of area MT from area V1 for one of the 4 subjects in the visual task as an example of PF estimates of conditional dependency coefficients between time-series. Plot in the center shows the actual stimulation pattern as a square wave, where the presence and the absence of stimulation are represented by 1 and 0 respectively. The bottom plot shows a time shifted stimulation pattern, which has a half-period offset from the actual stimulation pattern. The t-test was run comparing connectivity values in correspondence of ones (stimulation ON) and zeros (stimulation OFF) in both cases. The second test allowed to exclude spurious changes in connectivity values not due to the stimulation

With a t test between coefficient values in the presence and in the absence of stimulation we searched statistically significant (p-value <0.05) changes in connectivity following the underlying stimulation pattern. Also, as a control analysis, a second t-test was performed, simulating a different stimulation pattern from the actual one, which allowed to exclude variations deriving from spurious fluctuations of the results, as explained in Fig. 2.

Experimental results and discussions

Synthetic data

Scatter plots in Fig. 3 demonstrate that the conditional dependency coefficients estimated by PF in a stationary network satisfactorily correlate with the true coefficients, both in the noiseless synthetic dataset (Pearson’s ρ=0.96) and in the noisy scenario with SNR=6dB (Pearsons’ ρ=0.59).Fig. 3 Scatter plots that relate PF estimates (x axis) and true values (y axis) of the autoregressive model for a 6-node network with 100 time samples, in the absence of noise (left) and with SNR=6dB (right). The lines are the results of a linear fit of the data: in the noiseless case the slope m and the offset q were 1.39 and -1.62·10-2, respectively; in the noisy case, m=1.62 and q=8·10-3

Fig. 4 Time courses of the hidden parameters aij in the case of a 2-node network with non-stationary coefficient a21 alternating between 1 and -1. Red lines represent the true values, while blue lines represent the estimates obtained by PF

The case of a network with one time-varying coefficient is shown in Fig. 4. The PF tracks the changes of the non-stationary coefficient a21, although the estimated values do not immediately follow the abrupt changes between 1 and -1 and viceversa. All the other coefficients are correctly estimated to be close to the nominal null value.

Real fMRI data

Motor network

Red lines in Fig. 5 represent average values of the aij coefficients obtained on fMRI time series and the blue histogram represents the corresponding distribution of mean values of causal interactions for the permuted time series. Since temporal permutation suppresses the causal dependency between subsequent values, it was expected to observe zero-mean Gaussian distributed results, that is, no causal dependency. On the other hand, coefficients representing the causal relationship between two interacting brain areas should have values lying far away from the null distribution. This is what Fig. 5 shows, demonstrating that the particle filter effectively discriminates between unrelated and causally related time series.Fig. 5 Mean conditional dependencies between real fMRI data computed through the particle filter: in blue, the histogram of mean values obtained on time-series randomly permuted in time, while the red line shows the corresponding mean value obtained from non-permuted time-series. Many of these values lie well outside of the null distribution, therefore their value reflects the effective mean causal interaction and it is not produced by chance

Fig. 6 Scatter plot showing the relationship between mean PF estimates (horizontal axis) and delayed correlation (vertical axis) on the two sensory-motor experiments. On both results taken altogether the Pearson’s correlation coefficient ρ is 0.74, which corresponds to a statistically significant correlation with p<0.001. Slope and offset of the linear fit were 0.83 and 0.24 respectively

Fig. 7 Plots in blue color show the PF-estimated time courses of three representative hidden parameters aij in the case of a 4-node motor network, estimated in real fMRI data in one subject. Top panel depicts the coefficient describing the negligible causal effect exerted by area S1 over P. Central and bottom panels represent the causal effect exerted by the SM area over M1 and viceversa respectively

The PF captured causal interactions between brain areas, which significantly correlated with a proxy measure of effective connectivity, that is, delayed correlation (DC) (p<0.001, Pearson’s correlation coefficient ρ=0.74, Fig. 6). In particular, in both subjects, the highest aij coefficients in both PF and delayed correlation were those which represent the conditional dependency of areas M1 and S1, in agreement with current knowledge of brain functioning during a sensory-motor task.

Figure 7 exemplifies the temporal evolution of brain connectivity through three representative aij coefficients in Subject 2. The top panel displays one representative coefficient involving the control ROI P, which is approximately 0. Our finding that the S1-on-P coefficient time series exhibits only small fluctuations around zero is in agreement with ground truth that the parietal node is not involved in the motor task. The two bottom panels demonstrate the expected reciprocal influence between M1 and SM areas. It is worth noting that the influences in the two directions, i.e. M1 over SM and vice versa, have different values, as a consequence of the adopted model that allows non-symmetric matrix of coefficients.

Visual network

The PF detected causal dependencies between brain areas of the visual network which also correlated with the delayed correlation (Pearson’s ρ=0.70 and p<0.001, as shown in Fig. 8a). Interestingly, all four fMRI datasets showed statistically significant dynamic changes (p<0.05) with a pattern following the underlying stimulation in the effective connectivity coefficient regarding the influence of MT on V1, which are known to take part in the processing of visual stimuli. As an example, Fig. 9 represents the statistically significant differences in the causal influence of MT on V1 in the presence or absence of the visual stimulus, observed consistently in all four fMRI datasets. Blue crosses show the quality parameter Q=T/σ, where T is the temporal length of the time series and σ is the standard deviation of the data, taken as a measure of noise. Q values indicate a possible explanation for inter-dataset variability: the particle filter performance are enhanced by the timeseries length (T) and reduced by noise (estimated as 1/σ). Not all connectivity coefficients share this same behavior, therefore other factors might influence the results. Figure 10 represents one example of absence of detected causal relationship between area MT and the control region CTRL, and one example of non-symmetrical causality exerted by area V1 over MT and viceversa.Fig. 8 a Scatter plot between mean PF estimates (horizontal axis) and delayed correlation (vertical axis) on the four visual experiments fMRI data. A p<0.001 was obtained with a Pearson’s correlation coefficient ρ=0.70. The black line is the result of a linear fit. Slope and offset of the linear fit were 1.10 and 0.25 respectively. b Scatter plot between average PF estimates (horizontal axis) and stationary AR coefficients (vertical axis). The resulting Pearson’s correlation coefficient ρ was 0.94, with a p<0.001. The black line is the result of a linear fit, with slope and offset 1.2 and -0.004 respectively

Fig. 9 Comparison between presence (green bar) and absence (red bar) of visual stimulation for the mean aij coefficient representing the causal influence of MT on V1 in the four different datasets. Bars indicate the mean values and the standard deviation of the mean. Higher values of the coefficients are obtained in data sets with better quality parameter Q, as shown by blue crosses

Fig. 10 Plots in blue color show the PF-estimated time courses of three representative hidden parameters aij in the case of the 4-node visual network, estimated in real fMRI data in one subject. Top panel depicts the coefficient describing the negligible causal effect exerted by area MT over the control area. Central and bottom panels represent the non-symmetrical causal effect exerted by the V1 area over MT and viceversa respectively

Figure 8b shows the comparison between results of the PF and stationary AR coefficients (Pearson’s ρ=0.94 and p<0.001). A good agreement was found between the two estimates. In addition, changes through time of the AR coefficient were searched through a sliding-window approach: a multivariate linear regression model was fitted to consecutive and overlapping blocks of 20 time points, and variations in the regression coefficients in phase with the visual stimulation were searched with the same strategy used for the estimates of the PF (Fig. 2). While in this way some coefficients were found to vary, those that did were not the same across the four datasets. Instead, the conditional dependency coefficients estimated with the PF representing the influence of area MT on area V1 were consistently varying in all subjects, suggesting that the PF more reliably detects non-stationarity.Fig. 11 Figure 8a with ROI-based encoding, explained in the legend above the figure: same color refer to the same causing ROI and same symbols to same caused ROI. Black crosses are clusters centroids found through the Matlab function kmeans(), called A, B and C as in figure. The horizontal red line and vertical green line intersect in the point equally distant from centroids A and B

Figure 11 shows the relationship between coefficients obtained by PF and DC with explicit reference to the causal influence they are referred to. We searched for the appropriate clustering of the data in Fig. 11. The number of clusters was chosen as the knee of the number-of-clusters vs distance-to-every-centroid curve. The optimal number was 3 and each cluster’s centroid was plotted as a black cross in Fig. 11. All coefficients representing the causal interactions involving the CTRL region (black symbols) belong to cluster A, that is, small values of DC and mean PF estimates, except for the self-causality terms, which all lay in the vicinity of the C centroid. Every non-diagonal coefficient involving ROIs LGN, MT and V1 belong to the cluster B. In particular, in Fig. 11, the horizontal red line and vertical green line intersect in the point equally distant to the centroids A and B. All values representing the causal influence of MT on V1 (which vary following the stimulation pattern, represented by highlighted red diamonds in the figure) and that of V1 on MT (green stars) lay right to the green line and above the red line.

Discussion

Other implementations of SMC algorithms were previously proposed to investigate brain connectivity in fMRI data. Murray and Storkey [33] proposed a forward-backward Particle Filter using, as observation equation, a stochastic extension of the balloon model, which was proposed to describe the haemodynamics that follow brain activity [34]. In their study, the hidden parameters of the model resulted approximately constant, probably as a consequence to the complexity of the model itself [35, 36].

In a different study, Ahmad et al. [37] adopted a symmetric, linear, first-order, time-varying Autoregressive (TVAR) model and used a Rao-Blackwellized PF to estimate the temporal relationships among fMRI time-series representing four brain regions during resting state. The assumption of symmetry in coupling coefficients, that is aij=aji, reduced model complexity, but did not permit to infer neither the directionality of the network nor any possibly asymmetric cause/effect interaction between brain areas. Therefore their approach cannot be used to investigate effective connectivity. Also, the results were not benchmarked with the outcome results from different analyses and the resting-state paradigm did not allow any analysis on the temporal evolution of the results.

In our implementation on fMRI data, the time-averaged PF estimates were in agreement with a proxy measure of causality, that is, delayed correlation. Part of the mismatch between the proposed method and delayed correlation could be explained by the fact that the PF algorithm studies the network as a whole and produces estimates of aij coefficients that update at every time instant, while delayed correlation is a measure of pair-wise causality that does not take into account possible non-stationarities and spurious cause-effect relationships mediated by other nodes of the network.

In the first experimental setup involving the motor network, statistically significant changes in connectivity were not found, but the poor temporal resolution of the data (2s) may have prevented the detection of these changes.

On the contrary, in our study of the visual network statistically significant changes in connectivity were found in four different datasets with a pattern following the underlying stimulation, without requiring any previous knowledge on the actual stimulation paradigm during the estimation process. These variations interested the influence of MT on V1 which is consistent with our understanding of cortical processing in the early visual cortex [24]. The average behavior of PF’s results and a simpler regression estimate were in good agreement, but the PF also enabled to report consistent results across different datasets in the same experimental paradigm. Furthermore, while the PF is “blind”, sliding window analysis requires the inclusion of additional pieces of information, such as the stimulation paradigm timing, which in some cases may not be available.

The stability of the PF-estimated coefficients at larger time scales is in agreement with the regime of stationarity, commonly adopted in functional and effective connectivity fMRI studies: indeed, our experiments demonstrate a good agreement between time-averaged values of aij coefficients and both delayed correlation and stationary AR coefficients. This finding suggests that on large temporal scales the brain network has stable interactions within its nodes, under the assumption of linear first order autoregression.

Mean conditional dependency coefficients were found to vary between different datasets. As Fig. 9 shows, in some cases these differences can be explained through the joint contribution of noise and temporal length of the data, i.e. the quality parameter Q=T/σ. The brain haemodynamic responses may also be involved, which vary not only among subjects but also between different areas in the same subject [38], which was not taken into account in this study.

Conclusions

We used Particle Filter to test and identify the time-varying brain connectivity as evidenced in fMRI images. Our experiments confirmed the hypothesis of time-varying brain connectivity pattern and gave evidence for non-symmetric connectivity. It was possible to detect statistically significant changes in cortical cause-effect relationships correlated with the underlying task-rest pattern during the fMRI acquisition.

Future studies should test the performance of the proposed algorithm in fMRI experiments with higher time resolution, namely <0.8s, and they should aim to unveil possibly asymmetric changes in effective connectivity among brain regions. Also, to minimize the impact of vascular dynamics and highlight neural ones, future studies should use more sophisticated experimental designs that enable a better control over the non-uniformity of brain haemodynamics across different areas [38–40].

As suggested by Bugallo and Djuric [41], the PF can be improved by a parallel implementation when dealing with complex system, such as the brain. Ordinary brain connectivity analysis represents ROIs as time series obtained by averaging signals originating from more voxels of that region. This helps improving the Signal-to-Noise Ratio (SNR) but assumes some wide-scale connectivity features. Because of this wide-scale connectivity assumption, more reliable results may be achieved with a parallel combination of Particle Filters carried over single-voxels time series.

Our results, together with the possibility to refine the methodology, suggest that the proposed computational method, the Particle Filter, can be capable to infer time-varying effective connectivity on acquisitions with acceptable scan duration, without the need of any constraint or previous knowledge about the examined network or timing of the underlying brain processes.

Acknowledgements

The authors thank Dr Sergiy Ancherbak for having shared with them his particle filtering code for time-dependent gene network modeling.

Authors' contributions

Conceived and designed the experiments: PA, MC, MT. Performed the experiments: MC, LB, GB. Analyzed the data: PA, MC. Contributed analysis tools: EK. Wrote the paper: PA, MC, EK. All authors read and approved the final manuscript

Funding

This work has been partially supported by grants “RC 2018-2020” and “5 per mille” to IRCCS Fondazione Stella Maris, funded by the Italian Ministry of Health.

Availability of data and materials

The fMRI data used in this study will be made available upon direct request to the authors.

Declarations

Ethics approval and consent to participate

Ethics approval was issued by “Comitato per la sperimentazione clinica dei medicinali dell’Azienda Ospedaliero Universitaria Pisana”, reference number 12697, and by “Comitato Etico Regionale per la Sperimentazione Clinica della Regione Toscana”, reference number 32891. All subjects provided written informed consent.

Competing interests

The authors declare that they have no competing interests.

Publisher's Note

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

1. Friston KJ Functional and effective connectivity: a review Brain Connect 2011 1 13 36 10.1089/brain.2011.0008 22432952
2. Stephan KE Friston KJ Analyzing effective connectivity with functional magnetic resonance imaging WIREs Cognit Sci 2010 1 446 459 10.1002/wcs.58
3. Greicius MD Srivastava G Reiss AL Menon V Default mode network activity distinguishes Alzheimer’s disease from healthy aging: evidence from functional MRI Proc Natl Acad Sci USA 2004 101 4637 4642 10.1073/pnas.0308627101 15070770
4. Greicius MD Resting-state functional connectivity in neuropsychiatric disorders Curr Opin Neurol 2008 21 424 430 10.1097/WCO.0b013e328306f2c5 18607202
5. Jones DT Vemuri P Murphy MC Gunter JL Senjem ML Machulda MM Non-stationarity in the "resting brain’s” modular architecture PLoS ONE 2012 7 e39731 10.1371/journal.pone.0039731 22761880
6. van den Heuvel MP Exploring the brain network: a review on resting-state fMRI functional connectivity Eur Neuropsychopharmacol 2010 20 519 534 10.1016/j.euroneuro.2010.03.008 20471808
7. Greicius MD Flores BH Menon V Glover GH Solvason HB Kenna H Resting-state functional connectivity in major depression: abnormally increased contributions from subgenual cingulate cortex and thalamus Biol Psychiatry 2007 62 429 437 10.1016/j.biopsych.2006.09.020 17210143
8. Jirsa V McIntosh AR Jirsa V McIntosh AR Models of effective connectivity in neural systems Handbook of brain connectivity 2007 5 Berlin Springer 303 326
9. Honey G Bullmore E Human pharmacological MRI Trends Pharmacol Sci 2004 25 7 366 374 10.1016/j.tips.2004.05.009 15219979
10. Stephan KE Harrison LM Penny WD Friston KJ Biophysical models of fMRI responses Curr Opin Neurobiol 2004 14 629 635 10.1016/j.conb.2004.08.006 15464897
11. Gottesman II Gould TD The endophenotype concept in psychiatry: etymology and strategic intentions Am J Psychiatry 2003 160 636 645 10.1176/appi.ajp.160.4.636 12668349
12. Roebroeck A Formisano E Goebel R Mapping directed influence over the brain using Granger causality and fMRI Neuroimage 2005 25 230 242 10.1016/j.neuroimage.2004.11.017 15734358
13. Desphande G Sathian K Hu X Effect of hemodynamic variability on Granger causality analysis of fMRI Neuroimage 2010 52 884 896 10.1016/j.neuroimage.2009.11.060 20004248
14. Leonardi N Van De Ville D On spurious and real fluctuations of dynamic functional connectivity during rest NeuroImage 2015 104 430 436 10.1016/j.neuroimage.2014.09.007 25234118
15. Friston KJ Harrison L Penny W Dynamic causal modelling Neuroimage 2003 19 1273 1302 10.1016/S1053-8119(03)00202-7 12948688
16. Geyer CJ Brooks S Gelman A Jones G Meng X Introduction to Markov chain Monte Carlo Handbook of Markov chain Monte Carlo 2011 Boca Raton CRC Press, Taylor and Francis Group
17. Ancherbak S Kuruoğlu EE Vingron M Time-dependent gene network modeling by Sequential Monte Carlo IEEE/ACM Trans Comput Biol Bioinform 2016 13 1183 1193 10.1109/TCBB.2015.2496301 26540693
18. Ambrosi P, Costagli M, Kuruoglu EE, Biagi L, Buonincontri G, Tosetti M (2019) Investigating time-varying brain connectivity with functional magnetic resonance imaging using sequential Monte Carlo. In: 2019 27th European Signal Processing Conference (EUSIPCO). A Coruna: IEEE (p. 1–5)
19. Djuric PM Kotecha JH Zhang J Huang Y Ghirmai T Bugallo MF Miguez J Particle filtering IEEE Signal Process Mag 2003 20 19 38 10.1109/MSP.2003.1236770
20. Arulampalam MS Maskell S Gordon N Clapp T A tutorial on particle filters for nonlinear/non-gaussian bayesian tracking IEEE Trans Signal Process 2002 50 174 188 10.1109/78.978374
21. Costagli M Kuruoğlu EE Image separation using particle filters Digital Signal Process 2007 17 935 946 10.1016/j.dsp.2007.04.003
22. Wang Z Kuruolu EE Yang X Xu Y Huang TS Time varying dynamic Bayesian network for nonstationary events modeling and online inference IEEE Trans Signal Process 2011 59 4 1553 1568 10.1109/TSP.2010.2103071
23. Valdés-Sosa PA Roebroeck A Danizeau J Friston K Effective connectivity: influence, causality and biophysical modeling Neuroimage 2011 58 339 361 10.1016/j.neuroimage.2011.03.058 21477655
24. Gaglianese A Costagli M Bernardi G Ricciardi E Pietrini P Evidence of a direct influence between the thalamus and hMT+ independent of V1 in the human brain as measured by fMRI Neuroimage 2012 60 1440 1447 10.1016/j.neuroimage.2012.01.093 22300813
25. Casorso J Kong X Chi W Van De Ville D Yeo BTT Liègeois R Dynamic mode decomposition of resting-state and task fMRI Neuroimage 2019 194 2 54 10.1016/j.neuroimage.2019.03.019
26. Bressler SL Seth AK Wiener-Granger causality: a well-established methodology Neuroimage 2011 58 2 323 9 10.1016/j.neuroimage.2010.02.059 20202481
27. Gaglianese A Costagli M Ueno K Ricciardi E Bernardi G Pietrini P Cheng K The direct, not V1-mediated, functional influence between the thalamus and middle temporal complex in the human brain is modulated by the speed of visual motion Neuroscience 2015 284 833 844 10.1016/j.neuroscience.2014.10.042 25450965
28. Doucet A Godsill S Andrieu C On sequential Monte Carlo sampling methods for Bayesian filtering Stat Comput 2000 10 197 208 10.1023/A:1008935410038
29. Liu JS Chen R Blind deconvolution via sequential imputations J Am Stat Assoc 1995 90 567 576 10.1080/01621459.1995.10476549
30. Gençağa D Kuruoğlu EE Ertüzün A Modeling non-Gaussian time-varying vector autoregressive processes by particle filtering Multidim Syst Sign Process 2010 21 73 10.1007/s11045-009-0081-8
31. Mohammadi A Asif A Distributed particle filter implementation with intermittent/irregular consensus convergence IEEE Trans Signal Process 2013 61 10 2572 2587 10.1109/TSP.2013.2245123
32. Jenkinson M Bannister P Brady M Smith S Improved optimisation for the robust and accurate linear registration and motion correction of brain images NeuroImage 2002 17 2 825 841 10.1006/nimg.2002.1132 12377157
33. Murray L Storkey AJ Continuous time particle filtering for fMRI Adv Neural Inf Process Syst 2008 20 1049 1056
34. Buxton RB Wong EC Frank LR Dynamics of blood flow and oxygenation changes during brain activation: the balloon model Magn Reson Med 1998 39 6 855 864 10.1002/mrm.1910390602 9621908
35. Hettiarachchi IT, Mohamed S, Nahavandi S (2012) Identification of nonlinear fMRI models using auxiliary particle filter and Kernel smoothing method. In: 34th Annual International Conference of the IEEE EMBS, San Diego, California: IEEE. 28 Aug–1 Sept
36. Chambers M, Wyatt C (2011) An analysis of blood-oxygen-level-dependent signal parameter estimation using particle filters. In: 2011 IEEE International Symposium on Biomedical Imaging. New York: IEEE. Mar 30 (p. 250–253)
37. Ahmad MF, Murphy J, Vatansever D, Stamatakis EA, Godsill S. (2015) Tracking changes in functional connectivity of brain networks from resting-state fMRI using Particle Filters. IEEE International Conference on Acoustics, Speech and Signal Processing. New York: IEEE
38. Handwerker DA Ollinger JO D’Esposito M Variation of BOLD hemodynamic responses across subjects and brain regions and their effects on statistical analyses Neuroimage 2004 21 1639 1651 10.1016/j.neuroimage.2003.11.029 15050587
39. Duggento A Passamonti L Valenza G Barbieri R Guerrisi M Toschi N Multivariate Granger causality unveils directed parietal to prefrontal cortex connectivity during task-free MRI Sci Rep 2018 8 1 11 10.1038/s41598-018-23996-x 29311619
40. Aguirre GK Zarahn E Empirical analyses of BOLD fMRI statistics: II. Spatially smoothed data collected under null-hypothesis and experimental conditions NeuroImage 1997 5 3 199 212 10.1006/nimg.1997.0264 9345549
41. Bugallo MF, Djuric PM. Complex systems and particle filtering, 42nd Asilomar Conference on Signals, Systems and Computers. New York: IEEE; 2008

