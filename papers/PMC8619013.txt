
==== Front
Sensors (Basel)
Sensors (Basel)
sensors
Sensors (Basel, Switzerland)
1424-8220
MDPI

10.3390/s21227711
sensors-21-07711
Article
The Influence of Filters on EEG-ERP Testing: Analysis of Motor Cortex in Healthy Subjects
https://orcid.org/0000-0002-2104-7997
Karpiel Ilona 1*
https://orcid.org/0000-0003-3925-7033
Kurasz Zofia 2
Kurasz Rafał 3
Duch Klaudia 4
Luong Hiep Academic Editor
Aelterman Jan Academic Editor
1 Łukasiewicz Research Network—Institute of Medical Technology and Equipment, 41-800 Zabrze, Poland
2 Institute of Psychology, University of Silesia, 40-007 Katowice, Poland; zofia.kurasz@us.edu.pl
3 Independent Researcher, 40-007 Katowice, Poland; rizkurasz@gmail.com
4 Faculty of Science and Technology, Institute of Biomedical Engineering, Silesian Centre for Education and Interdisciplinary Research, University of Silesia in Katowice, 41-500 Chorzów, Poland; klaudia.duch@smcebi.edu.pl
* Correspondence: ilona.karpiel@itam.lukasiewicz.gov.pl; Tel.: +32-271-60-13 (ext. 127)
19 11 2021
11 2021
21 22 771121 9 2021
16 11 2021
© 2021 by the authors.
2021
https://creativecommons.org/licenses/by/4.0/ Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).
The raw EEG signal is always contaminated with many different artifacts, such as muscle movements (electromyographic artifacts), eye blinking (electrooculographic artifacts) or power line disturbances. All artifacts must be removed for correct data interpretation. However, various noise reduction methods significantly influence the final shape of the EEG signal and thus its characteristic values, latency and amplitude. There are several types of filters to eliminate noise early in the processing of EEG data. However, there is no gold standard for their use. This article aims to verify and compare the influence of four various filters (FIR, IIR, FFT, NOTCH) on the latency and amplitude of the EEG signal. By presenting a comparison of selected filters, the authors intend to raise awareness among researchers as regards the effects of known filters on latency and amplitude in a selected area—the sensorimotor area.

preprocessing data
somatosensory cortex
ERP
filters
==== Body
pmc1. Introduction

The EEG-ERP has become very popular, especially in the last 20 years, due to its many advantages: The examination is inexpensive, safe and easy to carry out. The modern EEG is considered to be an excellent alternative to magnetic resonance imaging or computer tomography because of its outstanding high temporal resolution [1]. The signal is widely applied in cognitive science and psychophysiological research, providing helpful clues about cognitive development and general mental functions [2]. The EEG is often used in neurological clinical trials to identify and treat various diseases, such as epilepsy [3], sleep disorders [4,5] and Alzheimer’s disease [6]. The EEG can also provide plenty of useful information about various mental dysfunctions or mental illnesses [7,8]. This is why it is gaining ground in psychological and psychiatric research and diagnosis in areas such as schizophrenia [9,10], Internet addiction [11], bipolar disorder [12], depression [13], binge eating disorder [14], different personality disorders [15,16] and many others.

Owing to the growing popularity of the EEG over the past two decades, researchers have definitely been using more instruments. In turn, the development of new tools and software has made it possible to conduct more complex and methodologically advanced research. This is closely related to the demand for knowledge about data processing. There is growing pressure on developing more advanced statistical and signal processing methods. In addition, scientific practice is currently undergoing tremendous changes to improve the transparency of data collection, documentation and analysis, research reproducibility and manuscript review [17]. Thus, a unified approach must be applied to data recording, artifact control and signal processing, and the procedures must be reported transparently.

However, a review of the literature shows that this is not an evident approach. As summarized by Robbins et al. [18], to date, studies have differed significantly already at the stage of data pre-cleaning methods, and EEG preprocessing approaches have not been standardized. Basically, the preprocessing phase is essential because a raw EEG signal is always contaminated with many different artifacts. They are related to the subject, e.g., as muscle movements, eye blinking, cardiac activity or breathing, or to other external and environmental factors, such as powerline disturbances [19]. Different methods are used to remove each type of artifact.

The methods are available as built-in options in various toolboxes or as dedicated overlays which support the preprocessing phase. EEG signals recorded by a single electrode are a superposition of signals from multiple sources (e.g., assigned to other electrodes); therefore, so-called spatial filters have come into use. There are also methods based on the principle of source signal estimation. An example of such a method is Blind Signal Separation (BSS) and, in particular, Independent Component Analysis (ICA) (Delorme 2004). One of the more popular environments used for preprocessing is MATLAB software together with open packages, i.e., EEGLAB, ERPLAB [20], SPM or Fieldtrip, or commercial ones, i.e., Curry or BESA. The aforementioned filters have been widely described in scientific papers both in technical terms, FIR [21,22], IIR [23,24], FFT [25,26], NOTCH, and in clinical applications or in typical research, FIR [27], NOTCH [28], FFT [29].

There is a recommendation for a package like EEGLAB that continuous EEG data should be filtered before being epoched or before the artifacts are removed. The process of filtering continuous data minimizes the need to filter artefacts at epoch boundaries (the use of FIR [30] is “recommended”). In the absence of the MATLAB Signal Processing toolbox (the EEGLAB legacy filter), a simple filtering method by means of the inverse Fourier transform can be applied. However, there are more filtering options. There is no ideal filter for the EEG data, either. For example, the effect of high-pass filters on ERP data is currently under discussion. Consequently, different solutions can be found in the literature: Both without filtering (e.g., VanRullen, [31]) or with very careful filtering [32]. There is an ongoing discussion in the literature [30,32,33,34] on how to avoid suboptimal practices resulting in regularly distorted or even false results.

External noises are removed at the first stage of data processing with the use of filters designed for this purpose. However, it is by no means easy to choose the right filters, as there is no adequate research into comparing the filtration effect by means of different filters. While several guidelines for best practices in signal preprocessing have been released [17], the procedures are relatively broad and give researchers considerable leeway to choose the appropriate filters or to create processing pipelines (in some parts, manual) consistent with best practices [18].

The absence of specific standards at the stage of preliminary signal purification and preparation is a cause for concern. To maintain a specific frequency, the signal needs to be cleaned with filters that should meet strict requirements. Any distortion of the original EEG signal can have fatal consequences, both for research purposes and in clinical use, at the stage of diagnosis and medication. Unfortunately, for the time being, little is known about the extent to which the use of different filters ultimately makes a difference in the obtained data. This refers in particular to latency and amplitude, which are important parameters for neuroscience and clinical diagnostics. There is not enough literature to compare various techniques used for artifact rejection. A standard methodology for perfect artifact removal has not been defined [35]. What is more, even those studies that strictly adhere to guidelines exhibit significant differences in the application of the recommended methods. This is a serious issue if the results between different studies are compared [18]. Another issue is that few researchers are familiar with certain artifact detection and removal methods [36], even though they are universally available [37].

The paper attempts to determine the influence of the filters on the EEG-ERP study, in particular the influence of the selected filters on the amplitude and latency in the sensorimotor area.

2. Materials and Methods

The data for the analyses were reused and the experiment itself was described in an earlier paper by Karpiel and Drzazga [38].

2.1. Participants

Seven healthy participants (4 males and 3 females) aged 20 to 35 (mean = 24.14, SD = ±4.99) without any neuromuscular or cerebral diseases took part in the study as volunteers. They were university students or alumni. All participants were right-handed, had normal color perception and normal visual acuity. All of the participants were healthy and had no neurological medical history. Information about their health and lifestyle was collected via a survey. The study was approved by the institutional ethics committee of the University of Silesia.

2.2. Experimental Design

Raw EEG signal data were taken from an experiment conducted in the laboratory. Participants were shown three Arabic numerals: 2, 3 and 4. Their task was to look at the center of the screen and respond to these numerals by pressing the appropriate keys on the keyboard with the index finger, middle finger and ring finger, respectively. A total of 450 right-hand and 300 left-hand trials were made. The stimulus interval was set at 800 ms. Each complete trial (stimulus + response + pause) lasted 2 s. Therefore, it took 15 min to complete the task for the right hand and 10 min for the left hand. Scenarios were created with Eevoke software (ANT Neuro running on PC desktop—MS Windows 7 OS). The experiment was carried out with a commercial ANT Neuro amplifier (AMP-TRF40AB model) in DC with 20,000 amplification gain and 256 Hz sampling rate, as well as ASA v.4.8 software. The stimuli included the Arabic numerals: 2, 3 and 4. The raw EEG signal and reaction times were recorded during the process for later analyses. The participants were seated in a comfortable chair, in front of a computer screen, at a distance of 1 m.

2.3. Experimental Procedure

Digits 2, 3 or 4 were shown in the center of the screen until a key was pressed, or until the digit automatically disappeared after 1200 ms. The subjects were required to respond by pressing the key with their index finger when “2” appeared, the middle finger when “3” appeared and the ring finger when “4” appeared. A new stimulus arrived 800 ms after the previous one. The order of all attempts was randomized. There were 150 attempts for each of these three arrangements for the right hand, and 100 attempts for the left hand. The order of these attempts was randomized.

2.4. Electroencephalogram Acquisition and ERP Recording

The EEG signal was recorded according to the standard 10–20 system, using an ANT Neuro amplifier and the ASA software, v.4.8. However, only eight electrodes were selected for the filtering process: Two frontocortical (F3, F4), two centrocephalic (C3, C4), two parietal (P3, P4) and two occipital (O1, O2). These channels were chosen because the visual perception and motor response had to be analyzed.

The raw EEG signal from 450 measurements for the right hand and 300 measurements for the left hand was refined four times; a different filter was used each time. Subsequently, the ICA analysis was intended to remove the artifacts, divided into 450 and 300 epochs, respectively, and averaged. The maximum amplitude and latency were determined from the averaged signals. At the final stage, the amplitude and latency values of the raw signal and the signals purified by filters were compared. The raw signal was filtered with the use of four different filters (FIR, IIR, FFT (0, 5–40 Hz) and NOTCH (lower passband edge 46.5 Hz, upper passband edge 127.5 Hz)) and processed. Two parameters are used to compare the effect of the filter on the EEG signal: Latency and amplitude. All analyses were performed in Python using the MNE toolkit on a PC. All analyses were performed using PC Dell Latitude E7270 with CPU Intel Core i5-6300U, Intel HD Graphics 520, 8 GB RAM and Windows 10 64 operating system. The data will be used to propose a model which uses machine learning [39,40].

2.5. Statistics

A statistical analysis was performed with the Statistica 13.1 software. For all measures, descriptive statistics were calculated. The Shapiro–Wilk test was used to check the normality of distributions of the studied variables. The homogeneity of variances in the analyzed groups was verified by Levene’s test. If the data failed to fulfill the assumptions required for a parametric test, a nonparametric Friedman’s ANOVA test was applied. The level of significance was set at p < 0.05.

3. Results

First, P100 and P300 refractions were located to verify the brain region in which the highest values were obtained. To present the results, we focused on selected electrodes/areas and the maximum and minimum values of both latency and amplitude. Several comparisons were made to show the differences between the selected approaches.

Figure 1 shows the averaged ERP curves of all three fingers from the O1, O2, Oz leads for seven tests. In the early visual phase (P75-120), the mean amplitude of O1 was the strongest. In the pre-execution phase (N175-260), the mean amplitude of O2 was the strongest. In the execution phase (P310-420), the strongest mean amplitude was for Oz (see Figure 2). The plot shows the envelopes (i.e., the min and max values, over all channels, at each time point), where the displayed topomaps of the average field in 50 ms time window centered at 129 ms, 172 ms and 375 ms. On the basis of the collected waveforms and topomaps, the highest values of amplitudes and latencies were selected. The figure shows that in the range between 0.1 and 0.2, the highest amplitude values of ~9 µV were obtained in the visual and motor cortex areas.

Figure 2 depicts the averaged curves of all three fingers from O1, O2 and Oz leads for seven tests. In the early visual phase, the highest mean amplitude value can be observed for the O1 lead with a slight advantage over the Oz and O2 leads.

Based on statistical analyses, there were no significant age-related differences for either latency or amplitude. By combining these topographical and temporal amplitude analyses, we confirmed the presence of differential responses to touch.

3.1. Latency and Amplitude—Influence of the Filters

EEG–ERP recordings were analyzed in order to identify the evoked potentials. On the basis of signal recordings obtained from seven subjects, tables were prepared with the values of amplitudes and latencies for the electrodes. Table 1 contains information on the analysis. Details concerning the group are included in Table 2. In the table for each subject there is a division into the first and second paradigm (I and II), type of filter and maximum and minimum values of latencies and amplitudes for selected electrodes.

It should be emphasized that among a considerable amount of data, only maximum and minimum values were chosen for the selected number of electrodes. In the first row, the highest amplitude value (for further consideration) is presented, which is associated with electrode C4 and exhibits the value of 250 ms. The latency was handled in the same way. Electrodes O1 and O2 were omitted in the presentation to narrow down the selected area to the sensorimotor area in the best possible way.

Our analyses showed that the lowest latency obtained was 250 ms (C3, C4, P3, P4) and the highest latency value was 664 ms (F3). The highest latency value was observed in the signal row for electrode F3, for the test performed with the left hand. The lowest band pass latency obtained was 250 ms (C3, C4, P3, P4) and the highest was 664 ms (F3). The analysis for “notch” also showed the lowest latency value of 250 ms (C3, C4, P3, P4). In contrast, the highest value was 664 ms (F3) (Table 1 and Table 2).

3.2. Differences between Filters

The analysis was divided into a first paradigm analysis (for the right hand) and a second paradigm analysis (for the left hand), respectively.

First paradigm. If analyzed sequentially, for one patient, the maximum value of latency changed/increased, the lowest was for raw, and the same for pass band and notch (648 ms). In patient 2, no difference was seen in the filters used; the latency value did not change. For the next one (3), the lowest latency value was 296 ms (C3) for raw, higher for pass band and even higher for notch, while the maximum latency value, interestingly, was the highest for raw (597 ms) and much lower for the other filters (382 ms). In case 4, the minimum latency value was the same for all. The maximum latency value for raw was obtained for C3 and was slightly higher for the other filters (664 ms) and in F3. In the analysis of patient 5, no difference was noticed in the filters used; the latency value did not change. In the analysis of patient 6, an increasing trend was observed, both for the minimum and maximum latency value. However, in the analysis of patient 7, the minimum value of latency (raw signal) for three electrodes (F3, C3, C4) was obtained, and it was exactly the same value, slightly bigger than for the applied filters. The maximum latency value for raw and filters was the same.

Second paradigm. A detailed analysis for each individual is as follows: For patient 1 the minimum and maximum latency value for all analyses is the same. For patient 2, the minimum latency value is 312 ms (C3), while for the filters it is the same at 328 ms. Taking into account the maximum value of latency for raw, it is much higher at 542 ms (P4), and for the analysis using selected filters it is only 398 ms (F4). For patient 3, the minimum latency value for raw and filter is the same, while the maximum is the same for raw and notch at 648 ms (C4), and lower for band pass at 519 ms (F4). An analysis of patient 4 indicates that the minimum latency value for raw and filters is the same at 250 ms (C3, C4, P3, P4), while the maximum is the same for band pass and notch. The raw signal analysis is marginally higher. It can be seen in the case of patient 5 that the minimum latency value for raw and filter is the same, while the maximum latency value for pass band is slightly higher than the other values. For patient 6, the minimum and maximum latency value for raw signals is the highest. Patient 7 exhibited no difference in the values between the minimum latency values for the analyses, while the maximum was the highest for notch.

Summary: Filters can affect the final latency time. They can change the latency values in comparison with the raw signal. In five out of seven patients, greater maximum latency values were observed for the first paradigm used compared to the second paradigm used for the left hand (filters). For raw signals: For four out of seven cases, higher maximum latency values were observed for the first paradigm used compared to the second paradigm used for the left hand.

3.3. Amplitude and Latency for Fingers 2, 3 and 4

Next, a more detailed analysis was performed. For each of the eight electrodes, data concerning the amplitude and latency were gathered. The values concerned all fingers, 2, 3 and 4, focusing on the raw signal, FIR, IIR, FFT and NOTCH. The analysis was performed both for the right and left hand. Table 3 exhibits data for the right hand for one patient.

As shown in Table 3, for all electrodes, different values were obtained for the unfiltered signal compared to the other filters. Each record under analysis produced a fairly large numerical database. It can be inferred from Table 3 that for the IIR filter the amplitude for electrode O1 was 4.02 and for the rest 4.66. A slightly higher amplitude, considering the selected electrodes, is noticeable for the NOTCH filter. On the other hand, slightly lower latency (for all electrodes) has been detected for the NOTCH filter in comparison to the other presented filters. FIR, IIR and FFT in this particular case have the same values of latency and amplitude. Interestingly, no regularities were observed to predict how amplitude or latency would change.

Figure 3, Figure 4, Figure 5, Figure 6 and Figure 7 exhibit comparisons of amplitude and latency values for each filter (divided into the left and right hand). Figure 4 and Figure 5 give a full picture of how latency and amplitude change. The presentation of the graphs includes data for both paradigms, i.e., for the right and left hand. Both Figure 4 and Figure 5 are box and whisker plots, showing the results for the applied FIR filter and its effect on the data averaged for all fingers, and for fingers 3 and 4, respectively. When analyzing the amplitude for the right hand movement (left panel), we can see the biggest scatter for electrode P4 and the smallest for O1. For the left hand, the largest scatter was obtained for electrode C4 and the smallest for electrodes F4 and P4. A graph was drawn for electrodes F3 and F4 showing the difference in the obtained latency values. The smallest differences were found for the right and left hands for the FFT, FIR and NOTCH filters (Figure 3).

The latency analysis in Figure 5 shows the smallest scatter for electrodes O1 and O2 and a much larger scatter for the other electrodes. There is a noticeable difference between the latency values for finger 4. If we compare the two paradigms, a smaller scatter is observed for electrodes P3 and P4 for the left hand compared to the right hand.

Comparisons of all selected filters were made. The graphs can be read twofold. Latency and amplitude values can be compared for each of the fingers, for the right and left hands for the selected electrodes. In addition, the values for the selected filters are presented. Consequently, (comparing the results for individual fingers) for the right hand, the largest scatter was noticed for finger 4. The difference between the filters used was negligible. For the left hand, the largest scatter was for finger 3. Interestingly, in this analysis there were differences in the filters used. For example, for FIR there was relatively little scatter for finger 2 compared to the IIR used.

For the FIR filter, the amplitudes and latencies can be seen from the individual electrodes. In the case of O1 and O2 electrodes, the lowest latency values can be seen (Figure 6 and Figure 7).

The differences between the right and left hand are noticeable; for example, the FIR filter, both for finger 3 and finger 4. For finger 3 in the left hand, the scatter is significantly larger compared to the right hand; the same goes for finger 4.

For the right hand, the largest scatter can be seen for finger 4, while for the left hand, the largest scatter is discernible for finger 2. When considering the right hand, there is not much difference between the filters used. For the left hand there are noticeable differences between the filters used. In particular, a larger scatter can be observed for fingers 2 and 3 compared to the other filters. If we compare the latencies for the right hand (movement of all fingers) and the chosen electrodes, the selected significance level is less than p < 0.05 and amounts to p = 0.00009 (for notch). For the analysis performed on the second finger p = 0.00006, third p = 0.00004 and fourth p = 0.00004. However, taking into account the amplitude (movement of all fingers, and only electrode C3), p = 0.03.

4. Discussion

There are more and more tools and possibilities for data analysis. The methods used can significantly affect the results and thus the subsequent diagnosis. Therefore, more papers should be published on different comparisons of software, methods and algorithms in use. This would make it much easier for young researchers at the beginning of their medical career to learn how to analyze and interpret the obtained results. There are over 150,000 publications on ERPs alone in the pub med database and over 17,000 on sensorimotor ERPs. This vast amount of information shows that it is often difficult to compare the results because they may depend on the methods used. The EEG itself is a relatively broad topic, yet new papers are published, related to the study of motor or speech areas, which are also key to understanding the motor planning of speech [41] or more broadly discussed sensory attenuation and the involved phenomena [42,43]. A few years ago, papers were also published with a focus on presenting bioelectrical results in the area of sensorimotor cortex not only for diseased subjects [44], but also for healthy/control subjects [45].

It seems to the authors that far too few papers have been published with a focus on comparing several methods of analysis, or based on several different parameters. This seems to be a niche among the original papers. The impact of filters on data interpretation is not always fully appreciated. This paper reviews this issue and explains how a particular filter affects the ERP data if at all. The theoretical part related to the construction and description of filters, and to the problems that can be expected when using them, to the method of choosing the right filter and how to avoid filtering by using alternative tools has been elaborated on in the paper by Alain de Cheveigne and Israel Nelken [46].

Filters are ubiquitous in brain data measurement and analysis. All data scientists involved in the analysis of both ERP and other signals deal with preprocessing and in particular with the choice of a filter for a specific analysis. It is important to improve the SNR, but it must also be remembered that filters affect the target signal. The authors have tried to point this out in this work.

Obvious as this should be, most papers provide incomplete information about the filters used and the “methodology” in general due to journal restrictions. Another issue is the “arbitrariness” of the procedure and analysis, since the preprocessing alone can be done arbitrarily, with different parameters.

The literature provides examples related to the use of filters, where it is indicated that their role is to suppress noise and enhance target activity. Yet, they can have detrimental effects that the researcher should be aware of.

Considering the overall number of emerging publications related to image preprocessing (or based on image preprocessing) or even signals, relatively few papers present a comparison of results. By this we mean a comparison involving exactly the same data, but including a comparison of different types of analysis, or a change of one or more parameters. The results are more often presented using one of the adopted models of the preprocessing analysis.

The question remains, can changes in amplitude or latency be crucial to the performance of EEG-based systems? Rhythms are divided primarily by their frequency range, but also by their amplitude, shape, duration and the location of the brain activity that accompanied their generation. Therefore, any change in amplitude or latency due to preprocessing or later postprocessing can have a significant impact on the medical expert’s assessment.

The authors focus on presenting the results concerning the sensorimotor area, which is of great importance in the diagnosis related to neurodegenerative diseases, such as patients with multiple sclerosis [47,48], Parkinson’s or Alzheimer’s disease [49]. The value of both amplitude and latency is of great significance as attention is paid to each value in the context of a given disease. For example, the usefulness of evoked potentials in the diagnosis and monitoring of MS is widely described in the literature [47,50]. Considering a prolongation of P100 latency or a decrease in amplitude below 5 μV, it significantly changes the diagnostic process. Moreover, visual evoked potentials are useful neurophysiological methods in the diagnosis of subclinical demyelinating foci in the central nervous system (CNS) and the presence of changes in somatosensory evoked potentials indicates the need for a thorough diagnosis of spinal localization in MS.

Some of the waveforms, particularly P50, N100, MMN, P300 and N400, are proposed as biomarkers of schizophrenia [51]. A distinction is made between state markers (episodic, relating to symptoms) and traits (persisting independently of the clinical status) [52]. Based on the results of the study, it is proposed that visual P300 potentials may be a marker of the clinical condition of schizophrenia (research results indicate i.a. that visual P300 potentials are an indicator of the severity of clinical symptoms) [53,54,55], while auditory P300 potentials—a marker of trait or susceptibility to schizophrenia [56].

Somatosensory evoked potentials permit objectification and determination of the location of sensory disturbances. They can complement electronurography and electromyography (EMG, electromyography) in the diagnosis of peripheral nervous system lesions (carpal tunnel syndromes, brachial plexus injuries, upper chest syndrome). They are also used in the diagnosis of spinal cord injuries (trauma, myelopathy, demyelinating disorders). Moreover, they play an important role in intraoperative monitoring of the integrity of sensory pathways (spine and spinal cord procedures) [57]. Similar to BAEP, somatosensory evoked potentials are used to assess brainstem function in unconscious patients [58].

5. Conclusions

Filters form an important part of any research methodology. They are designed to amplify the signal and suppress noise but, apart from their undeniable advantages, they can cause harmful effects. The user should be aware of the impact of filtering, particularly in the field of neuroscience. Based on seven research examples, it can be concluded that significant differences in both amplitude and latency values can occur due to the filter used and the preprocessing performed. It seems that there is a need to “standardize” preprocessing and filtering for individual disease entities in order to avoid erroneously prepared data, which, in turn, may result in a wrong medical diagnosis. The reader, researcher or expert should be aware of the potential effects, therefore more reports should be provided for different areas and selected potentials.

In conclusion, it seems that each analysis should be performed at least twice to verify the results and to minimize the likelihood of misdiagnosis. To the best of our knowledge, the preprocessing of applied filters and other values is not structured yet, and there are simply some recommendations related to, e.g., the software used. Therefore, the literature exhibits quite a lot of freedom in the way that the selected methods are used. Each method has its supporters and opponents. Even an expert is unable to make a proper diagnosis without reliably prepared data. Hence, the influence of the filters on the amplitude and latency calls for a detailed analysis.

Acknowledgments

The author (I.K.) wishes to thank Zofia Drzazga for her role in the development of these studies and her assistance in pilot experiments. Thank you also Aleksander Sobotnicki and Adam Gacek very much for substantive support.

Author Contributions

Conceptualization, I.K.; methodology, I.K.; software, I.K., K.D. and R.K.; validation, I.K., Z.K. and Z.K.; formal analysis, I.K.; investigation, I.K.; resources, I.K.; data curation, I.K.; writing—original draft preparation, I.K. and Z.K; writing—review and editing, I.K., Z.K. and R.K.; visualization, R.K., K.D. and Z.K.; supervision, I.K.; project administration, I.K.; funding acquisition, I.K. All authors have read and agreed to the published version of the manuscript.

Funding

The research was co-funded by the Ministry of Education and Science in Poland, as part of the targed subsidy for the SYBIOZ project no. CŁ/631/2021/DF/DW, granted by the President of the Łukasiewicz Research Network.

Institutional Review Board Statement

These studies benefited from the retrospective studies used and described in previous publications.

Informed Consent Statement

Informed consent was obtained from all subjects involved in the study.

Conflicts of Interest

The authors declare no conflict of interest.

Figure 1 Examples of waveforms. Butterfly plot of somatosensory evoked potentials for all EEG channels (colored lines, 32 channels). The averaged EEG channels are marked in the drawing of the scalp next to the y-axis. Below: Topographical distribution of each component on the scalp. Red and blue indicate the maximum and minimum EEG amplitude at each time point, respectively.

Figure 2 The averaged signal for electrodes O1 (green line), Oz (purple line) and O2 (yellow line).

Figure 3 Presentation of the average latency values for the F3 and F4 electrodes for the right and left hands for selected filters.

Figure 4 Wave amplitude values (V) FIR filter: Top drawing for all and individual fingers: a—all fingers, b—“2” fingers, c—“3” fingers, d—“4” fingers and electrodes P4. Middle drawing for finger 3 and all electrodes. Bottom drawing for finger 4 and all electrodes. Right hand (left in the photo) and left hand (right panel).

Figure 5 Latency values (s) FIR filter: Top drawing for all and individual fingers: a—all fingers, b—“2” fingers, c—“3” fingers, d—“4” fingers and electrodes P4. Middle drawing for finger 3 and all electrodes. Bottom drawing for finger 4 and all electrodes. Right hand (left in the photo) and left hand (right panel).

Figure 6 Box and whisker plot depicting latency values for averaged values, fingers 2, 3 and 4. From the left: Right hand and left hand.

Figure 7 Box and whisker plot depicting amplitude values for averaged values, fingers 2, 3 and 4. From the left: Right hand and left hand.

sensors-21-07711-t001_Table 1 Table 1 Latency values for seven subjects, for selected electrodes (C3, C4, P3, P4, F3, F4).

No	Time	Filter	Latency max (ms)	Electrode	Latency min (ms)	Electrode	Amplitude max (µV)	Electrode	Amplitude min (µV)	Electrode	
1	I
/before 12 a.m.	raw	593	C4	250	C3	4.16	P4	−4.48	P3	
		pass band	648	C4	250	C3	4.10	P4	−4.41	P3	
		notch	648	C4	250	C3	4.09	P4	−4.41	P3	
	II
/after 12 a.m.	raw	371	P4	250	C3	4.01	C4	−2.18	P3	
		pass band	371	P4	250	C3	3.86	C4	−2.18	P3	
		notch	371	P4	250	C3	3.89	C4	−2.16	P3	
2	I
/after 12 a.m.	raw	445	C4	371	P3	21.4	F4	−20.5	C3	
		pass band	441	C4	371	P3	21.1	F4	−20.2	C3	
		notch	441	C4	371	P3	21.1	F4	−20.2	C3	
	II
/after 12 a.m.	raw	542	P4	312	C3	10.7	F4	−9.29	C4	
		pass band	398	F4	328	C3	10.6	F4	−9.27	C4	
		notch	398	F4	328	C3	10.6	F4	−9.26	C4	
3	I
/before 12 a.m.	raw	597	F3	296	C3	9.66	C4	−11.1	P4	
		pass band	382	F3	312	C3	9.32	C4	−10.7	P4	
		notch	382	F3	316	C3	9.36	C4	−10.7	P4	
	II
/before 12 a.m.	raw	648	C4	328	C3	5.22	F3	−4.65	C3	
		pass band	519	F4	328	C3	5.10	F3	−4.14	C3	
		notch	648	C4	328	C3	5.25	F3	−4.20	C3	
4	I
/after 12 a.m.	raw	0.66015625	C3	250	F4	15.4	P4	−8.43	C3	
		pass band	664	F3	250	F4	15.4	P4	−8.35	C3	
		notch	664	F3	250	F4	15.4	P4	−8.37	C3	
	II
/after 12 a.m.	raw	371	F3	250	C3	24.2	C4	5.68	F3	
		pass band	367	F3	250	C3	24.1	C4	5.59	F3	
		notch	367	F3	250	C3	24.2	C4	5.63	F3	
5	I
/after 12 a.m.	raw	644	F3	296	C4	7.42	P3	−12.0	P4	
		pass band	644	F3	296	C4	7.38	P3	−11.9	P4	
		notch	644	F3	296	C4	7.37	P3	−12.0	P4	
	II
/after 12 a.m.	raw	546	C4	304	P4	6.99	P4	−4.33	C4	
		pass band	550	C4	304	P4	6.88	P4	−4.30	C4	
		notch	546	C4	304	P4	6.91	P4	−4.27	C4	
6	I
/after 12 a.m.	raw	406	C3	265	F3	2.14	F3	−2.05	C3	
		pass band	433	C3	257	C4	1.97	F3	−1.58	C3	
		notch	433	C3	257	C4	1.98	F3	−1.58	C3	
	II
/after 12 a.m.	raw	664	F3	335	P3	5.52	P4	−2.22	C3	
		pass band	660	F3	250	P4	5.20	P4	−2.07	C3	
		notch	660	F3	250	P4	5.29	P4	−2.11	C3	
7	I
/after 12 a.m.	raw	507	P3	285	F3	8.17	C4	0.363	P3	
		pass band	507	P3	281	F3	8.10	C4	0.371	P3	
		notch	507	P3	281	F3	8.16	C4	0.360	P3	
	II
/after 12 a.m.	raw	355	F3	289	P3	6.03	P4	−2.10	P3	
		pass band	359	F3	289	P3	6.04	P4	−2.07	P3	
		notch	363	F3	289	C3	6.06	P4	−2.08	P3	

sensors-21-07711-t002_Table 2 Table 2 Specification of the group selected for further analysis which takes into account age, gender and whether the person is right- or left-handed.

No	Age	Sex	Hand	
1	20	M	R	
2	22	F	R	
3	35	M	R	
4	27	F	R	
5	20	F	L/R	
6	21	F	R	
7	24	M	R	

sensors-21-07711-t003_Table 3 Table 3 Numerical values (latency and amplitude) for finger 2, for the right hand, for one person.

Filter	Electrode	Latency (ms)	Amplitude (µV)	
RAW	O1	148	5.3	
RAW	O2	156	2.38	
RAW	F3	265	3.78	
RAW	F4	347	−1.23	
RAW	C3	535	−2.75	
RAW	C4	265	−1.95	
RAW	P3	253	1.51	
RAW	P4	351	−1.95	
FIR	O1	152	4.66	
FIR	O2	152	2.22	
FIR	F3	269	2.98	
FIR	F4	359	−1.34	
FIR	C3	433	−2.09	
FIR	C4	250	−1.64	
FIR	P3	320	1.44	
FIR	P4	324	−1.69	
IIR	O1	152	4.02	
IIR	O2	152	2	
IIR	F3	269	2.57	
IIR	F4	359	−1.09	
IIR	C3	429	−1.72	
IIR	C4	250	−1.45	
IIR	P3	320	1.28	
IIR	P4	324	−1.55	
FFT	O1	152	4.66	
FFT	O2	152	2.22	
FFT	F3	269	2.98	
FFT	F4	359	−1.34	
FFT	C3	433	−2.09	
FFT	C4	250	−1.64	
FFT	P3	320	1.44	
FFT	P4	324	−1.69	
NOTCH	O1	148	4.6	
NOTCH	O2	156	2.18	
NOTCH	F3	265	3.1	
NOTCH	F4	359	−1.2	
NOTCH	C3	464	−2.18	
NOTCH	C4	250	−1.57	
NOTCH	P3	320	1.45	
NOTCH	P4	324	−1.7	

Publisher’s Note: MDPI stays neutral with regard to jurisdictional claims in published maps and institutional affiliations.
==== Refs
References

1. Kawala-Sterniuk A. Podpora M. Pelc M. Blaszczyszyn M. Gorzelanczyk E.J. Martinek R. Ozana S. Comparison of Smoothing Filters in Analysis of EEG Data for the Medical Diagnostics Purposes Sensors 2020 20 807 10.3390/s20030807 32024267
2. Bell M.A. Cuevas K. Using EEG to Study Cognitive Development: Issues and Practices J. Cogn. Dev. 2012 13 281 294 10.1080/15248372.2012.691143 23144592
3. Chen Z. Lu G. Xie Z. Shang W. A Unified Framework and Method for EEG-Based Early Epileptic Seizure Detection and Epilepsy Diagnosis IEEE Access 2020 8 20080 20092 10.1109/ACCESS.2020.2969055
4. Rezaei M. Mohammadi H. Khazaie H. EEG/EOG/EMG Data from a Cross Sectional Study on Psychophysiological Insomnia and Normal Sleep Subjects Data Brief 2017 15 314 319 10.1016/j.dib.2017.09.033 29214192
5. Hussain L. Shah S.A. Aziz W. Bukhari S.N.H. Lone K.J. Chaudhary Q.-A. Analyzing the Dynamics of Sleep Electroencephalographic (EEG) Signals with Different Pathologies Using Threshold-Dependent Symbolic Entropy Waves Random Complex Media 2020 1 18 10.1080/17455030.2020.1743378
6. Horvath A. EEG and ERP Biomarkers of Alzheimer Rsquo s Disease a Critical Review Front. Biosci. 2018 23 183 220 10.2741/4587
7. Erickson M.A. Kappenman E.S. Luck S.J. High Temporal Resolution Measurement of Cognitive and Affective Processes in Psychopathology: What Electroencephalography and Magnetoencephalography Can Tell Us About Mental Illness Biol. Psychiatry Cogn. Neurosci. Neuroimaging 2018 3 4 6 10.1016/j.bpsc.2017.11.008 29397077
8. Sanei S. Chambers J.A. EEG Signal Processing: Sanei/EEG Signal Processing John Wiley & Sons Ltd. West Sussex, UK 2007 978-0-470-51192-3
9. Goshvarpour A. Goshvarpour A. Schizophrenia Diagnosis Using Innovative EEG Feature-Level Fusion Schemes Phys. Eng. Sci. Med. 2020 43 227 238 10.1007/s13246-019-00839-1
10. Rahman S. Sharma T. Mahmud M. Improving Alcoholism Diagnosis: Comparing Instance-Based Classifiers Against Neural Networks for Classifying EEG Signal Proceedings of the Brain Informatics Mahmud M. Vassanelli S. Kaiser M.S. Zhong N. Springer International Publishing Cham, Switzerland 2020 239 250
11. Gross J. Baumgartl H. Kumar R. A Novel Machine Learning Approach for High-Performance Diagnosis of Premature Internet Addiction Using the Unfolded EEG Spectra Proceedings of the 25th America’s Conference on Information Systems Virtual Conference 12–16 August 2020
12. Yadollahpour A. Mirzaiyan M. Rashidi S. Quantitative EEG for Early and Differential Diagnosis of Bipolar Disorders: A Comprehensive Review of the Literature Int. J. Ment. Health Addict. 2017 15 387 393 10.1007/s11469-017-9739-x
13. Shen J. Zhao S. Yao Y. Wang Y. Feng L. A Novel Depression Detection Method Based on Pervasive EEG and EEG Splitting Criterion Proceedings of the 2017 IEEE International Conference on Bioinformatics and Biomedicine (BIBM) Kansas City, MO, USA 13–16 November 2017 1879 1886
14. Raab D. Baumgartl H. Buettner R. Machine Learning Based Diagnosis of Binge Eating Disorder Using EEG Recordings Proceedings of the 24th Pacific Asia Conference on Information Systems Dubai, United Arab Emirates 20 June 2020
15. Attademo L. Bernardini F. Verdolini N. Neural Correlates of Schizotypal Personality Disorder: A Systematic Review of Neuroimaging and EEG Studies Curr. Med. Imaging 2021 10.2174/1573405617666210114142206
16. Boland C. Jalihal V. Organ C. Oak K. McLean B. Laugharne R. Woldman W. Beck R. Shankar R. EEG Markers in Emotionally Unstable Personality Disorder—A Possible Outcome Measure for Neurofeedback: A Narrative Review Clin. EEG Neurosci. 2021 52 254 273 10.1177/1550059420937948 32635758
17. Pernet C. Garrido M.I. Gramfort A. Maurits N. Michel C.M. Pang E. Salmelin R. Schoffelen J.M. Valdes-Sosa P.A. Puce A. Issues and Recommendations from the OHBM COBIDAS MEEG Committee for Reproducible EEG and MEG Research Nat. Neurosci. 2020 23 1473 1483 10.1038/s41593-020-00709-0 32958924
18. Robbins K.A. Touryan J. Mullen T. Kothe C. Bigdely-Shamlo N. How Sensitive Are EEG Results to Preprocessing Methods: A Benchmarking Study IEEE Trans. Neural Syst. Rehabil. Eng. 2020 28 1081 1090 10.1109/TNSRE.2020.2980223 32217478
19. Lawhern V. Hairston W.D. McDowell K. Westerfield M. Robbins K. Detection and Classification of Subject-Generated Artifacts in EEG Signals Using Autoregressive Models J. Neurosci. Methods 2012 208 181 189 10.1016/j.jneumeth.2012.05.017 22634706
20. Lopez-Calderon J. Luck S.J. ERPLAB: An Open-Source Toolbox for the Analysis of Event-Related Potentials Front. Hum. Neurosci. 2014 8 213 10.3389/fnhum.2014.00213 24782741
21. Diana N. Kalsum U. Sabiq A. Jatmiko W. Mursanto P. Comparing Windowing Methods on Finite Impulse Response (FIR) Filter Algorithm in Electroencephalography (EEG) Data Processing J. Theor. Appl. Inf. Technol. 2016 88 558 567
22. Roychowdhury A. Pandey P.C. FIR Filter Design Techniques IIT Bombay Mumbai, India 2002 12
23. Pei S.-C. Tseng C.-C. Two Dimensional IIR and FIR Digital Notch Filter Design Proceedings of the 1993 IEEE International Symposium on Circuits and Systems Chicago, IL, USA 3–6 May 1993 890 893
24. Kim G. Lim S. Kim H. Lee B. Seo S. Cho K. Lee W. Is Robot-Assisted Therapy Effective in Upper Extremity Recovery in Early Stage Stroke?—A Systematic Literature Review J. Phys. Ther. Sci. 2017 29 1108 1112 10.1589/jpts.29.1108 28626337
25. Nitschke J.B. Miller G.A. Cook E.W. Digital Filtering in EEG/ERP Analysis: Some Technical and Empirical Comparisons Behav. Res. Methods Instrum. Comput. 1998 30 54 67 10.3758/BF03209416
26. Fernández A. de Santiago L. Blanco R. Pérez-Rico C. Rodríguez-Ascariz J.M. Barea R. Miguel-Jiménez J.M. García-Luque J.R. Ortiz del Castillo M. Sánchez-Morla E.M. Filtering Multifocal VEP Signals Using Prony’s Method Comput. Biol. Med. 2015 56 13 19 10.1016/j.compbiomed.2014.10.023 25464344
27. Rubinson M. Horowitz I. Naim-Feil J. Gothelf D. Levit-Binnun N. Moses E. Effects of Methylphenidate on the ERP Amplitude in Youth with ADHD: A Double-Blind Placebo-Controlled Cross-over EEG Study PLoS ONE 2019 14 e0217383 10.1371/journal.pone.0217383 31150439
28. Engell A. Junghöfer M. Stein A. Lau P. Wunderlich R. Wollbrink A. Pantev C. Modulatory Effects of Attention on Lateral Inhibition in the Human Auditory Cortex PLoS ONE 2016 11 e0149933 10.1371/journal.pone.0149933 26901149
29. Yang J. Singh H. Hines E.L. Schlaghecken F. Iliescu D.D. Leeson M.S. Stocks N.G. Channel Selection and Classification of Electroencephalogram Signals: An Artificial Neural Network and Genetic Algorithm-Based Approach Artif. Intell. Med. 2012 55 117 126 10.1016/j.artmed.2012.02.001 22503644
30. Widmann A. Schröger E. Filter Effects and Filter Artifacts in the Analysis of Electrophysiological Data Front. Psychol. 2012 3 233 10.3389/fpsyg.2012.00233 22787453
31. VanRullen R. Four Common Conceptual Fallacies in Mapping the Time Course of Recognition Front. Psychol. 2011 2 365 10.3389/fpsyg.2011.00365 22162973
32. Acunzo D.J. MacKenzie G. van Rossum M.C.W. Systematic Biases in Early ERP and ERF Components as a Result of High-Pass Filtering J. Neurosci. Methods 2012 209 212 218 10.1016/j.jneumeth.2012.06.011 22743800
33. Rousselet G.A. Does Filtering Preclude Us from Studying ERP Time-Courses? Front. Psychol. 2012 3 131 10.3389/fpsyg.2012.00131 22586415
34. Zoefel B. Heil P. Detection of Near-Threshold Sounds Is Independent of EEG Phase in Common Frequency Bands Front. Psychol. 2013 4 262 10.3389/fpsyg.2013.00262 23717293
35. Gupta G.S. Bhatnagar M. Kumar S. Sinha R.K. A Comparative Study of Application of Different Non-Conventional Filters on Electroencephalogram Biomed. Res. 2020 31 1 9
36. Keil A. Debener S. Gratton G. Junghöfer M. Kappenman E.S. Luck S.J. Luu P. Miller G.A. Yee C.M. Committee Report: Publication Guidelines and Recommendations for Studies Using Electroencephalography and Magnetoencephalography: Guidelines for EEG and MEG Psychophysiology 2014 51 1 21 10.1111/psyp.12147 24147581
37. Puce A. Hämäläinen M. A Review of Issues Related to Data Acquisition and Analysis in EEG/MEG Studies Brain Sci. 2017 7 58 10.3390/brainsci7060058
38. Karpiel I. Drzazga Z. Comparison Between ERP (SLORETA) and FMRI of Somatosensory Cortex for Healthy Group Acta Phys. Pol. B Proc. Suppl. 2020 13 923 10.5506/APhysPolBSupp.13.923
39. Czaplewski R.L. Variance Approximations for Assessments of Classification Accuracy U.S. Department of Agriculture, Forest Service, Rocky Mountain Forest and Range Experiment Station Ft. Collins, CO, USA 1994 RM-RP-316
40. Nunez M. Srinivasan1 R. Electroencephalography (EEG): Neurophysics, Experimental Methods, and Signal Processing Handbook of Neuroimaging Data Analysis CRC Press London, UK New York, NY, USA 2016 175 197
41. Lancheros M. Jouen A.-L. Laganaro M. Neural Dynamics of Speech and Non-Speech Motor Planning Brain Lang. 2020 203 104742 10.1016/j.bandl.2020.104742 31986473
42. Jo H.-G. Habel U. Schmidt S. Role of the Supplementary Motor Area in Auditory Sensory Attenuation Brain Struct. Funct. 2019 224 2577 2586 10.1007/s00429-019-01920-x 31312903
43. Schmidt-Kassow M. Thöne K. Kaiser J. Auditory-Motor Coupling Affects Phonetic Encoding Brain Res. 2019 1716 39 49 10.1016/j.brainres.2017.11.022 29191770
44. Park W. Kwon G.H. Kim Y.-H. Lee J.-H. Kim L. EEG Response Varies with Lesion Location in Patients with Chronic Stroke J. NeuroEng. Rehabil. 2016 13 21 10.1186/s12984-016-0120-2 26935230
45. Boldyreva G.N. Sharova E.V. Zhavoronkova L.A. Cheliapina M.V. Dubrovskaia L.P. Simonova O.A. Fadeeva L.M. Pronin I.N. Kornienko V.N. Structural and functional peculiarity of brain activity to performance and imaginary motor tasks in healthy persons (EEG and fMRI study) Zh. Vyss. Nerv. Deiat. Im. I. P. Pavlov. 2013 63 316 327 10.7868/s0044467713030039
46. De Cheveigné A. Nelken I. Filters: When, Why, and How (Not) to Use Them Neuron 2019 102 280 293 10.1016/j.neuron.2019.02.039 30998899
47. Pohl D. Rostasy K. Treiber-Held S. Brockmann K. Gärtner J. Hanefeld F. Pediatric Multiple Sclerosis: Detection of Clinically Silent Lesions by Multimodal Evoked Potentials J. Pediatr. 2006 149 125 127 10.1016/j.jpeds.2006.01.003 16860140
48. Matas C.G. de Andrade Matas S.L. de Oliveira C.R.S. Gonçalves I.C. Auditory Evoked Potentials and Multiple Sclerosis Arq. Neuro-Psiquiatr. 2010 68 528 534 10.1590/S0004-282X2010000400010
49. Moore N.C. Visual Evoked Responses in Alzheimer’s Disease: A Review Clin. Electroencephalogr. 1997 28 137 142 10.1177/155005949702800304 9241466
50. Djuric S. Djuric V. Zivkovic M. Milosevic V. Jolic M. Stamenovic J. Djordjevic G. Calixto M. Are Somatosensory Evoked Potentials of the Tibial Nerve the Most Sensitive Test in Diagnosing Multiple Sclerosis? Neurol. India 2010 58 537 10.4103/0028-3886.68669 20739788
51. Kamarajan C. Advances in Electrophysiological Research Alcohol Res. 2015 37 53 87 26259089
52. Schmitt A. Martins-de-Souza D. Akbarian S. Cassoli J.S. Ehrenreich H. Fischer A. Fonteh A. Gattaz W.F. Gawlik M. Gerlach M. Consensus Paper of the WFSBP Task Force on Biological Markers: Criteria for Biomarkers and Endophenotypes of Schizophrenia, Part III: Molecular Mechanisms World J. Biol. Psychiatry 2017 18 330 356 10.1080/15622975.2016.1224929 27782767
53. Mathalon D.H. Ford J.M. Pfefferbaum A. Trait and State Aspects of P300 Amplitude Reduction in Schizophrenia: A Retrospective Longitudinal Study Biol. Psychiatry 2000 47 434 449 10.1016/S0006-3223(99)00277-2 10704955
54. Simson R. Vaughan H.G. Ritter W. The Scalp Topography of Potentials in Auditory and Visual Go/NoGo Tasks Electroencephalogr. Clin. Neurophysiol. 1977 43 864 875 10.1016/0013-4694(77)90009-8 73454
55. Soltani M. Knight R.T. Neural Origins of the P300 Crit. Rev. Neurobiol. 2000 14 199 224 10.1615/CritRevNeurobiol.v14.i3-4.20 12645958
56. Van der Stelt O. Belger A. Application of Electroencephalography to the Study of Cognitive and Brain Functions in Schizophrenia Schizophr. Bull. 2007 33 955 970 10.1093/schbul/sbm016 17363840
57. Citrome L. Bilder R.M. Volavka J. Managing Treatment-Resistant Schizophrenia: Evidence from Randomized Clinical Trials J. Psychiatr. Pract. 2002 8 205 215 10.1097/00131746-200207000-00004 15985880
58. Haupt W.F. Pawlik G. Thiel A. Initial and Serial Evoked Potentials in Cerebrovascular Critical Care Patients J. Clin. Neurophysiol. 2006 23 389 394 10.1097/01.wnp.0000223454.04161.cf 17016148

