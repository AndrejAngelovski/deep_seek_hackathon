
==== Front
Front NeurolFront NeurolFront. Neurol.Frontiers in Neurology1664-2295Frontiers Media S.A. 10.3389/fneur.2018.00652NeurologyMethodsValidation of a Lower Back “Wearable”-Based Sit-to-Stand and Stand-to-Sit Algorithm for Patients With Parkinson's Disease and Older Adults in a Home-Like Environment Pham Minh H. 12*Warmerdam Elke 12Elshehabi Morad 13Schlenstedt Christian 1Bergeest Lu-Marie 1Heller Maren 1Haertner Linda 34Ferreira Joaquim J. 56Berg Daniela 13Schmidt Gerhard 2Hansen Clint 1Maetzler Walter 131Department of Neurology, University Hospital Schleswig-Holstein, Kiel University, Kiel, Germany2Digital Signal Processing and System Theory, Faculty of Engineering, Kiel University, Kiel, Germany3Department of Neurodegeneration, Center for Neurology, Hertie Institute for Clinical Brain Research, University of Tübingen, Tübingen, Germany4DZNE, German Center for Neurodegenerative Diseases, Tübingen, Germany5Clinical Pharmacology Unit, Instituto de Medicina Molecular, Lisbon, Portugal6Laboratory of Clinical Pharmacology and Therapeutics, Faculty of Medicine, University of Lisbon, Lisbon, PortugalEdited by: Marco Schieppati, New international University for Sport and Health, LUNEX University, Luxembourg

Reviewed by: Manuela Galli, Politecnico di Milano, Italy; Peter C. Fino, Oregon Health & Science University, United States

*Correspondence: Minh H. Pham hoangminh.pham@uksh.deThis article was submitted to Movement Disorders, a section of the journal Frontiers in Neurology

10 8 2018 2018 9 65226 3 2018 20 7 2018 Copyright © 2018 Pham, Warmerdam, Elshehabi, Schlenstedt, Bergeest, Heller, Haertner, Ferreira, Berg, Schmidt, Hansen and Maetzler.2018Pham, Warmerdam, Elshehabi, Schlenstedt, Bergeest, Heller, Haertner, Ferreira, Berg, Schmidt, Hansen and MaetzlerThis is an open-access article distributed under the terms of the Creative Commons Attribution License (CC BY). The use, distribution or reproduction in other forums is permitted, provided the original author(s) and the copyright owner(s) are credited and that the original publication in this journal is cited, in accordance with accepted academic practice. No use, distribution or reproduction is permitted which does not comply with these terms.Introduction: Impaired sit-to-stand and stand-to-sit movements (postural transitions, PTs) in patients with Parkinson's disease (PD) and older adults (OA) are associated with risk of falling and reduced quality of life. Inertial measurement units (IMUs, also called “wearables”) are powerful tools to monitor PT kinematics. The purpose of this study was to develop and validate an algorithm, based on a single IMU positioned at the lower back, for PT detection and description in the above-mentioned groups in a home-like environment.

Methods: Four PD patients (two with dyskinesia) and one OA served as algorithm training group, and 21 PD patients (16 without and 5 with dyskinesia) and 11 OA served as test group. All wore an IMU on the lower back and were videotaped while performing everyday activities for 90–180 min in a non-standardized home-like environment. Accelerometer and gyroscope signals were analyzed using discrete wavelet transformation (DWT), a six degrees-of-freedom (DOF) fusion algorithm and vertical displacement estimation.

Results: From the test group, 1,001 PTs, defined by video reference, were analyzed. The accuracy of the algorithm for the detection of PTs against video observation was 82% for PD patients without dyskinesia, 47% for PD patients with dyskinesia and 85% for OA. The overall accuracy of the PT direction detection was comparable across groups and yielded 98%. Mean PT duration values were 1.96 s for PD patients and 1.74 s for OA based on the algorithm (p < 0.001) and 1.77 s for PD patients and 1.51 s for OA based on clinical observation (p < 0.001).

Conclusion: Validation of the PT detection algorithm in a home-like environment shows acceptable accuracy against the video reference in PD patients without dyskinesia and controls. Current limitations are the PT detection in PD patients with dyskinesia and the use of video observation as the video reference. Potential reasons are discussed.

accelerometergyroscopehome-like activitiesolder adultsPD patientspostural transition
==== Body
Introduction
Falls are dangerous incidents often occurring at home for older adults (OA) resulting in injury, and consequently decreased quality of life (1–3). A positive history of falls increases fear of falling, further contributing to future falls (1, 4). Movement deficits often occur in neurological diseases. Within this spectrum Parkinson's disease (PD) is a predominantly motor disorder and patients with PD are specifically prone to increased fall risk (5). In both OA and PD patients, falls frequently happen during sit-to-stand and stand-to-sit movements (postural transitions, PTs), i.e., during changes of posture that require multi-limb coordination (6–8). Usually the diagnosis of these deficits at the doctor's office or in hospitals are based on qualitative parameters or on semi-quantitative scoring tools. The Unified Parkinson Disease Rating Scale (MDS-UPDRS) is one of many tools to rate motor symptoms including gait and postural stability in PD (9). Such tools have been subject to multiple validation studies and reflect disease state relatively well, but a downside is the large inter-rater variability and subjectivity (10–13). Over the last decade, inertial measurement units (IMUs, also called “wearables”), force plates (14), and complex optical 3D motion capture systems have been developed making it interesting for medical purposes (15–25) especially in the complementary assessment of gait and balance (25, 26). A body of literature describes assessment technologies and algorithms for the detection of PTs (27–31). While some systems are expensive and restricted to the laboratory (i.e., force plates, 3D motion capture), IMUs are a good trade-off. IMUs are microelectromechanical systems with multiple degrees of freedom (DOF; e.g., 3D accelerometers, 3D gyroscopes and 3D magnetometers). They are advantageously priced, light-weight, and can measure at frequencies sufficient to capture even fast human movements (32, 33). An additional argument for IMUs is their applicability in virtually any environment especially outside the clinic.

Assessments performed within the clinical environment or a laboratory setting reflect only parts of human behavior. For example, these assessments often measure unintentional (i.e., non-targeted) movements. Assessment of purposeful and target-oriented movements under unsupervised conditions can add highly relevant and complementary insight into human movements and mobility, including treatment effects (34–37). Therefore, a substantial interest is coming from legal institutions, such as the European Medicines Agency (EMA), the Food and Drug Administration (FDA), and from pharmaceutic companies to include parameters collected in the real life environment of study participants.

IMU-based PT studies have shown that PTs differ between OA and PD patients (38) and that PT characteristics change when the disease progresses (39). These studies have most often been performed under standardized lab situations, i.e., PT movements were pre-defined and instructed. However, the behavior in real-life environment may be even more relevant for clinical judgment (34). Therefore, algorithms that have been developed based on lab-based assessments may not be suitable for home assessments. They obviously do not address the high variance of PTs and increase the risk of false-positive (i.e., the detection of movements that are no PTs) and false-negative PTs (i.e., the non-detection of actual PTs) under daily living conditions.

In this study, we developed and validated a PT detection algorithm in PD patients and OA that performed purposeful movements in a home-like environment, from data of a lower back-worn IMU.

Methods
Study participants, setting and data collection process
The study was approved by the ethical committee of the Medical Faculty of the University of Tübingen (protocol number 399/2012BO2). The investigation of participants was carried out at the Neurology department of the University Hospital of Tübingen and the development and validation of the algorithm were performed at Kiel University (both Germany). Before the assessments all participants gave written consent.

All participants were examined by a movement disorder specialist (WM). Participants without orthopedic problems and capable of walking without aids were included. Exclusion criteria were deep brain stimulation and Mini Mental State Examination (MMSE) score <24. Table 1 provides the demographic and clinical details of the participants. All participants were equipped with the Mobility Lab system (APDM, INC., Portland, Oregon) including 3D accelerometers (±16 g) and 3D gyroscopes (±2,000°/s), with 128 samples/s (fs). Participants were then asked to perform daily-like activities, such as moving around in the hospital, climbing stairs, sitting, standing, making coffee, ironing clothes and brushing teeth during an assessment period of 90–180 min (41, 42). During the entire standardized process, the participants were video-recorded with a camera (Sony, resolution 1,920 × 1,080 pixels, frame rate of 50 samples/s). The video was mostly collected within one continuous session and rest periods were also included in the analysis.

Table 1 Demographic and clinical data of the training and test groups.

	PD patients	Older adults	
TRAINING GROUP	
N (females)	4 (3)	1 (0)	
Age (years)	64 (18)	58 (0)	
MDS-UPDRS III (0–132)	37 (2)	1 (0)	
H&Y (0–5)	3 (1)	0 (0)	
LED (mg)	353 (420)	0 (0)	
TEST GROUP	
N (females)	21 (11)	11 (5)	
Age (years)	68 (6)	62 (9)	
MDS-UPDRS III (0–132)	29 (13)	2 (4)	
H&Y (0–5)	2 (1)	0 (0)	
LED (mg)	904 (611)	0 (0)	
Data are shown as mean ± standard deviation, except gender. H&Y, Hoehn & Yahr; LED, Levodopa equivalent dose (40); MDS-UPDRS III, motor part of the revised Unified Parkinson's disease (PD) Rating scale.

Videos were evaluated by two independent clinical observers (LH and EW) to identify PT episodes and to estimate directions and durations of each PT. The clinical observers noted when a stand-to-sit or sit-to-stand movement occurred. The start of a PT episode was defined by a forward bending of the lower back. The PT episode ended when the backward movement of the lower back stopped and the participant fully sat down (in stand-to-sit) or stood up (in sit-to-stand). The PT duration was estimated using a watch and presented in full seconds. Periods during which the participant was out of the camera sight (about 5% of the total number of PTs) were discarded. The mean number of PTs measured per study participant was 33.

Algorithm development and validation
Data obtained from the lower back IMU was used for the analysis (Figure 2A). First, we divided available datasets into an algorithm training dataset consisting of four PD patients (two with dyskinesia) and one OA and a test dataset consisting of 21 PD patients (five with dyskinesia) and 11 OA. We used the training dataset for the development of the algorithm, which is described in the following. The test dataset was used for validation purposes. Table 1 provides demographic and clinical details of the two groups. Figure 1 graphically presents the relevant steps of the algorithm development and the validation processes.

Figure 1 Algorithm development and validation steps for postural transition (PT) detection. Acc, accelerometer; accel, acceleration; DWT, discrete wavelet transform; gyr, gyroscope; SiSt: sit-to-stand, StSi: stand-to-sit; +/-, positive/negative.

Algorithm development
As an overview, the accelerometer and gyroscope data were pre-processed and the stationary periods of the lower back were identified. These stationary periods were used to estimate the tilt angle with respect to the horizontal plane. They were smoothed by using discrete wavelet transformation (DWT denoise) and the start and end of the PTs were identified. The sensor orientation during the PTs was estimated using the quaternion (estimated from accelerometer and gyroscope data) to estimate the vertical displacement of the lower back. Based on the extent of vertical displacement, PTs were classified as “effective PTs” and “PT attempts,” and the direction of the PTs was defined.

Preprocessing
The raw data stems from accelerometers (a0) and gyroscopes (ω0). The magnetometer data was not used, because it is affected by magnetic disturbances (43, 44). Accelerometer signals were filtered with the 4th order Butterworth phaseless, recursive low pass filter (LPF) with a cut-off frequency of fc = 5 Hz to remove electronic noise (30). That cut-off frequency was selected based on a previous study (44), mentioning that the typical frequency range for gait is between 0 and 5 Hz. The filtered accelerometer signal and the gyroscope signal were called a(n) = {ai} and ω(n) = {ωi}, respectively. The index i ∈ {x, y, z} indicates the direction (x, y, or z axis). The acceleration magnitude (|a(n)|) was extracted from the raw accelerometer data according to (Equation 1):

 (1) |a(n)|=∑i={x,y,z}ai(n)2 n is the discrete time index of the data sampled at fs = 128 Hz.

From the acceleration magnitude, the short-term acceleration mean (μa(n)) (Equation 2) and variance (σa2(n)) (Equation 3) were extracted, with N chosen to be 128:

 (2) μa(n)=1N∑i=0N-1|a(n-i)|  (3) σa2(n)=1N∑i=0N-1(|a(n-i)|-μa(n-i))2 The similar short-term estimations were computed for the gyroscope signal, to get the gyroscope magnitude |ω(n)|, the short-term gyroscope mean μω(n) and variance σω2(n). Whenever σω2(n)<10-5ms2, the gyroscope bias (bω) was found according to (Equation 4). This threshold was selected based on the observations on the training dataset.

 (4) bω(n)={ω(n), if σω2(n)<10−5ms2bω(n−1), else The gyroscope bias was removed from the gyroscope signal according to (Equation 5):

 (5) ω~(n)=ω(n)-bω(n) In the following sections, to reduce the complexity of the equations, the index n will be removed except when the time indices of two quantities are different.

Detection of stationary periods
Stationary periods (sp) were defined as the episodes when the lower back of the participant was almost not moving and not rotating. While previous research has set threshold values based on mathematical approaches or estimations (45), we used thresholds determined based on the training data set. The period was defined as a stationary period (sp) when |a|<0.05ms2 and σa2<0.01m2s4 and σω2<0.011s2. Otherwise, the period was considered as an active period (ap).

Tilt angle estimation
We assumed that the tilt angle of the lower back during PTs was only around the medio-lateral axis (M/L) of the body. As shown in Figure 2A, during a sp, accelerometers measure only gravity (g), whose component (gz, gx) could be used to estimate the tilt angle during sp θsp(Equations 6–8):

 (6) gx=ax  (7) gz=az  (8) θsp={atan2(gz,gx), if gz≥0atan2(gz,gx)+2π, if gz<0 Figure 2 (A) Sensor location. The upper left x/z axis represents the reference frame (gravity, g). ax, acceleration in vertical direction (x-axis); az, acceleration in anterior-posterior direction (z-axis); IMU, inertial measurement unit; θ, tilt angle. (B) Tilt angle estimation from sit-to-stand and stand-to-sit movements. The blue line shows the tilt angle estimation based on integration. The black dotted line shows the drift of the integration. The red line shows the tilt angle estimation after removing the drift. ap, active period; sp, stationary period; nls, latest time index of the previous stationary period; nrs, earliest time index of the following stationary period. The step change at nrs for the “tilt angle (with drift)” line is caused by the accumulative integration error of the medio-lateral gyroscope signal. The tilt angle at that point changes from “estimated by gyroscope” to “estimated by accelerometer”.

Tilt angle during ap (θap) was estimated as follows (Figure 2B):
- integrate the angular velocity around the medial lateral axis (ωy) (the 2nd component of the gyroscope signal without bias ω~), from the latest time index (nls) of the previous stationary period, to the earliest time index (nrs) of the following stationary period, to get the tilt angle with drift (θap+d) (Equations 9, 10):
 (9) θap+d(nls+1)=θsp(nls)+ωy(nls)*1fs 
 (10) θap+d(n+1)=θap+d(n)+ωy(n)*1fs 



estimate the drift (d) from nls to nrs, according to (Equations 11, 12):
 (11) dθ(n)=kθ*(n-nls)+θsp(nls) 

with

 (12) kθ=θap+d(nrs)-θsp(nrs)nrs-nls estimate θap, which was the tilt angle without drift, according to (Equation 13):



 (13) θap=θap+d-dθ The tilt angle (θ), consisting of θsp and θap, was used for further analysis.

Discrete wavelet transformation (DWT) to denoise the tilt angle (θ)
DWT was used to remove the integration drift and movement artifacts (30). To scale θ from −1 to 1, sinθ was calculated, then denoised using DWT (Figure 3). sinθ was passed through a LPF [with h(n) as the impulse response] and high pass filter (HPF) [with g(n) as the impulse response], then both were down-sampled by half (2↓1). sinθ was split into the low-frequency component (A21[sinθ]), and the high-frequency component (D21[sinθ]). This step is called one deconstruction step. A21[sinθ] was deconstructed again, split into A22[sinθ] and D22[sinθ]. h(n) and g(n) were chosen by the Coiflet order 5 (46). The process was continued similarly on the lowest-frequency component to get A2j[sinθ] and D2j[sinθ], with j is the number of iteration.

Figure 3 The denoising process with discrete wavelet transform. θ, tilt angle; A2j[sinθ], low frequency components; D2j[sinθ], high frequency components with j, number of iteration; h(n), low pass filter; g(n), high pass filter; 2↓1, downsample by half; 1↓2, upsample by double; Rj[sinθ], denoised signal after j iterations. Dash lines mean suppressing the components to zero. This figure shows an example of the denoising process with two iterations.

In the reconstruction step, all high-frequency components were suppressed to zero (Equation 14):

 (14) D2j[sinθ]={0, if j>0D2j[sinθ], if j=0 A20[sinθ] was upsampled (1↑2) by double, to get the denoised signal (Rj[sinθ]). This process is called reconstruction.

In this study, j was taken to be three times (to get R3[sinθ]) and 10 times (to get R10[sinθ]) (based on the training results). The symbol R3[sinθ] describes the aforementioned process “deconstruct the signal sinθ three times; suppress the high-frequency components; reconstruct with the lowest frequency component.” The symbol R10[sinθ] describes “deconstruct the signal sinθ 10 times; suppress the high-frequency components; reconstruct with the lowest frequency component.” The difference between R3[sinθ] and R10[sinθ], called tilt_denoise (tilt_denoise = R3[sinθ]−R10[sinθ]), was used for further analysis.

Postural transition (PT) detection
The peaks of the tilt_denoise signal with magnitude and prominence >0.1 were defined as PT events (indicated by a star symbol, Figure 4). In the following parts, they were classified into either “effective PTs” (i.e., the participant was considered to perform a complete standing up or sitting down movement) or “PT attempts” (i.e., the participant was considered not to perform a complete PT, e.g., forward and backwards body motion).

Figure 4 Postural transition (PT) detection and PT start/end identification. The upper part shows the tilt angle. The middle part shows the denoised tilt signal used for PT detection. The lower part presents the medio-lateral-axis gyroscope signal (ωy) whose zero-crossings were used for the identification of the start and the end of a PT. The fine-dashed vertical line indicates the start and the gross-dashed line the end of the respective PTs. The star symbols indicate the PT events with magnitude and prominence >0.1.

The zero-crossing method was used to define the beginning and the end of a PT in the gyroscope signal (47) (indicated by vertical lines, Figure 4). The beginning of a PT was defined as the first zero crossing point of the medio-lateral angular velocity (ωy) on the left side of the PT event, with negative slope. The end of a PT was defined as the zero crossing point of ωy on the right side of the PT event, again with negative slope.

Orientation estimation of the sensor with respect to the earth frame
A 6DOF fusion algorithm was used to represent the orientation of the sensor with respect to the earth frame in quaternion q (48) (Figure 5). q has the form of [q1
q2
q3
q4], with the initial orientation value q(0)=[12 0 (-12) 0] once the sp is firstly detected. Gravity in the sensor frame (gest) was estimated using gest=[2*(q2q4-q1q3)2*(q1q2+q3q4)q12-q22-q32+q42]. The preprocessed acceleration vector (a) was normalized to a^=a|a|. The angular velocity (ωest) was re-estimated (calculated by ωest=ω~+β△ω) with △ω is the feedback fixation of ω~ (calculated by ω=a^×gest, with × is the cross product) and β is the coefficient (which is 0 during ap, and 0.5 during sp). The quaternion change (q°) was computed q˙=12q⊗ωest (with ⊗ is the quaternion multiplication) and used to update the current quaternion using the following formula (Equation 15):

 (15) q(n+1)=q(n)+q˙(n)*1fs q values were normalized q~=q|q| before being used for further analysis.

Figure 5 Structure of the algorithm for the detection of postural transitions using six degree-of-freedom IMU sensor fusion. a, pre-processed accelerometer signal; a^, normalized acceleration; |a|, magnitude of the acceleration; β, feedback coefficient; gest, estimated gravity; ∫dt, integration symbol; ω~, gyroscope signal with no bias; ω, feedback fixation of ω~; ωest, re-estimated ω~; q1, q2, q3, q4, four components of the quaternion; q(n), quaternion from the current iteration; q(n+1), quaternion from the next iteration; q˙, change in quaternion; q, quaternion; |q|, quaternion magnitude; z−1, time shift operator.

Translational acceleration estimation (aT)
a was converted to the earth frame (Ea) (Equation 16):

 (16) [0 Ea]=q~⊗[0 a]⊗q~* where q˜* is the quaternion conjugation of the quaternion (Equation 17)

 (17) q˜*=[q˜1 −q˜2 −q˜3 −q˜4] The gravity component (Eg), which equals [0 0 1] in the earth frame, was eliminated from the Ea to get only translational acceleration (aT) (Equation 18):

 (18) aT=Ea-Eg Translational velocity (vT) and vertical displacement (dZ) estimation
During sp, vT was set to zero. During ap, translational velocity with drift (vT+d) was obtained by integrating aT (Equation 19):

 (19) vT+d=aT.1fs Similar to the aforementioned part “Tilt angle estimation,” with vT during sp being zero, the drift (dv) was estimated (Equations 20, 21) and removed from vT+d, to get vT:

 (20) dv(n)=kvn-kvnls  (21) with kv=vT+d(nrs)nrs-nls During the ap period, vT along the vertical axis (vz, which is the 3rd component of vT) was integrated to obtain the vertical displacement (dz) (Equation 22):

 (22) dz=vz.1fs The difference of dz between the end and the beginning of each PT events (△dz) was calculated and was used for further analysis. A threshold was set to △dz = 0.1m to differentiate between effective PTs and PT attempts. PT attempts were excluded from the final result. Regarding the direction of the PTs, positive △dz was defined as a sit-to-stand, and negative △dz as a stand-to-sit movement. The duration of the PT was defined as the time between the beginning and the end of the PT.

Statistical analysis
Analyses were conducted using JMP 11.1.1 software (SAS Institute GmbH, Böblingen, Germany). Demographic data of the training group and the validating group is presented with mean and standard deviation (Table 1). Intraclass correlation (ICC) was used to evaluate the agreements between two clinical observers (EW and LH). Contingency table was used to calculate the sensitivity, accuracy and positive predictive value for PT detection. 888 true positive PTs were used for the inference statistics. Student t-test was performed to detect PT duration differences between PD patients and OA for both the algorithm and the video reference. PT direction (SiSt or StSi) of the true positive PTs was compared between the algorithm and the video reference. The difference of the PT duration, estimated by the algorithm and the video reference, and the 95% confidence interval (CI) were also computed.

Results
The ICC of the two clinical observers regarding PT detection was 0.99. Total number of detected PTs were 1,001 and 1,064 for clinical raters and the algorithm, respectively. The accuracy of the algorithm to detect PTs reached 82% for PD patients without dyskinesia, 47% for PD patients with dyskinesia and 85% for OA (Table 2). The overall accuracy regarding the PT direction was 98%.

Table 2 Validation values for detection of postural transitions (PTs) derived from the test group.

Groups	Acc.	Sens.	PPV	PT detected by the algorithm	PT detected by the clinical observers	True positive PT	False positive PT	False negative PT	
All participants (N = 32)	77	89	83	1,064	1,001	888	176	113	
OA (N = 11)	85	98	86	307	273	265	42	6	
PD without dyskinesia (N = 16)	82	89	90	595	599	533	61	67	
PD with dyskinesia (N = 5)	47	69	55	162	129	89	73	40	
Values are calculated on a sample-by-sample basis. Acc., accuracy; NPV, negative predictive value; PD, Parkinson's disease; OA, older adults; PPV, positive predictive value; Sens, sensitivity.

The algorithm yielded a mean (SD) PT duration of 1.96 (0.72)s for PD patients and 1.74 (0.43)s for OA, with 0.22 s PT duration difference (p < 0.001) between the groups showing a comparable value with the video reference (0.26 s, p < 0.001). Figure 6 shows the difference of the PT duration, estimated by the algorithm and the video reference including the 95% CI. The mean duration difference between the algorithm and the video reference was 0.20 s, with a 95% CI between −1.06 s and 1.45 s.

Figure 6 Differences between the postural transition duration estimation including the mean and the 95% confidence interval represented as horizontal lines. PT, postural transition; CI, confidence interval.

Discussion
In this paper, we present an algorithm for successful PT detection and quantification from a single wearable sensor on the lower back in a home-like environment. The algorithm was developed and tested with PD patients with and without dyskinesia and OA, and the results were compared against video observation.

The introduced algorithm yielded accuracies of 82% for PD patients without dyskinesia, 47% for PD patients with dyskinesia and 85% for OA. To our knowledge, this is the first validated PT detection algorithm for PD patients and OA based on home-like-environment data using one sensor fixed to the lower back.

Previous research (27, 29, 31, 49) has reported higher detection accuracies, however the studies either estimated PTs in healthy adults or during scripted laboratory protocols/supervised conditions, which differs to daily-life conditions.

Equally, the studies investigating PT occurrences in home-like conditions (50, 51) showed very promising results for healthy OA, frail OA and for post-stroke patients. Nevertheless, the groups and the IMU localization differ; therefore, accuracy values should be compared with caution.

With regards to PD patients, one study (52) reported high accuracy values for the detection and evaluation of PTs in healthy individuals (94%) and PD patients (87%) in home-like conditions using a fuzzy classifier, but the definition of PT was not specified to sit-to-stand and stand-to-sit movements and multiple sensors were used.

We argue that data obtained from the lower back is preferable, as the position is closer to the center of mass (53), and lower back-derived algorithms for PT-“associated” movements, such as walking (33, 54, 55) and turning (32, 47, 56), show excellent accuracy values. The inclusion of PD patients and healthy OA in the validation process supplemented the robustness of the proposed algorithm yielding in excellent accuracy regarding the PT direction identification (98%), for further investigations.

This study used discrete wavelet transform to remove noise and to deal with integration errors in tilt angle estimation from the gyroscope bias (30, 57). The tilt angle was estimated by integrating the gyroscope and this computation step avoids inverse trigonometric functions, resulting in faster computation speed. This wavelet technique also enhances the height of PT peaks in the tilt angle pattern, suppresses the superfluous peaks (i.e., the peaks in the pattern produced by other activities) and consequently increases the sensitivity of PT detection. The inclusion of the orientation estimation (by using the quaternion) and the vertical displacement led to a substantial improvement of accuracy values compared to vertical acceleration and velocity. Specifically, this approach reduced, compared to the mentioned vertical acceleration and velocity approach, the number of false positive PTs due to erroneous detection of trunk movements (which regularly occur during daily activity movements, such as ironing). In summary, we feel that we can provide here a mature “hypothesis-derived” algorithm for PT detection in PD patients and OA, however with potential of further improvement (see also below).

Although our results are promising, still more work is necessary, particularly with the definition and validation of quantitative PT parameters. Most promising candidate parameters are, in our view, flexion and extension tilt angles of the lower back during PTs (58), as well as flexion and extension angular velocities (59).

With regard to the dyskinetic PD patients, the algorithm was not sufficiently accurate. The main reason is that these patients were constantly moving, which prevented the algorithm from detecting stationary periods sufficient to estimate a correct vertical displacement (50, 60). One option to overcome this issue, at least in patients that are not continuously dyskinetic, is to use algorithms for dyskinesia detection (41, 61) and to remove dyskinetic phases before the PT evaluation. For the evaluation of PTs during dyskinetic phases, an additional barometric pressure sensor could be included as it allows the accurate estimation of vertical displacement (50, 62).

Mean PT duration of 1.89 s is comparable to other studies including PD patients (31). The mean PT duration difference between the algorithm and the video reference was 0.20 s and comparable to (27). The difference is partly explained by the video reference measurement. Measuring in full seconds may increase the mean PT duration difference and consequently the confidence intervals between the IMU-based and video reference durations (Figure 6). Moreover, it is often difficult for clinical observers to differentiate between an effective PT and a PT attempt. For example, we experienced that especially slow and long PT attempts were occasionally classified as a single PT attempt by the clinical observers, while being identified as two PTs (i.e., a sit-to-stand and stand-to-sit movement) by the algorithm. Such a misclassification leads consequently to two false positives and this misinterpretation explained 60% of the false positives in our validation group. Furthermore, we have still some false positive PT detections from the activities involving the leaning forward and backward of the upper body, such as during ironing clothes, picking objects, and tying shoelaces. False negative PT detections seem to originate mainly from rigid sit-to-stand and stand-to-sit episodes in severely bradykinetic PD patients (63). Those specific patterns need to be further investigated in order to reduce the false detection, hence improve the accuracy of the algorithm.

Conclusion
We present here an algorithm for PT detection in PD patients and OA who all performed purposeful PTs in a home-like environment. The validation values for PD patients and OA justify, in our view, the use of the algorithm in pilot studies performed in clinical and home-based settings. Our algorithm needs further validation particularly with regard to PT quantification, to provide, e.g., validated PT angle-related parameters. Moreover, further exploration is required particularly in specific subgroups performing “unusual” movements (here: PD patients suffering from dyskinesia), e.g., within collaborations of algorithm developing research groups including cross-validation approaches.

Author contributions
MP, GS, and WM were responsible for the conception and design of the study. WM contributed to the data acquisition. MP, EW, ME, L-MB, JF, DB, MH, LH, CH, GS, and WM were involved in the analysis and interpretation of data. MP, ME, EW, CH, and WM drafted the first version of the article. All authors revised it critically for important intellectual content. All authors gave final approval of the version to be submitted.

Conflict of interest statement
The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.

We thank all individuals who took part in the study.

Funding. The study was supported by the EU project FAIR-PARK II, funded under the Horizon2020 Programme of the European commission (grant N° 633190, PHC13 2014–2015; NCT02655315), by the European Union's Horizon 2020 research and innovation programme under the Marie Sklodowska-Curie grant agreement No 721577, and by Lundbeck. The funding sources did not have any role in conception and design of the study, acquisition, analysis and interpretation of data, and in writing of the manuscript. We acknowledge financial support by Land Schleswig-Holstein within the funding programme Open Access Publikationsfonds. All opinions are those of the authors and not the funders.
==== Refs
References
1. Voss TS Elm JJ Wielinski CL Aminoff MJ Bandyopadhyay D Chou KL  . Fall frequency and risk assessment in early Parkinson's disease . Parkinsonism Relat Disord.  (2012 ) 18 :837 –41 . 10.1016/j.parkreldis.2012.04.004 22542094 
2. Cheng FY Yang YR Wang CJ Wu YR Cheng SJ Wang HC  . Factors influencing turning and its relationship with falls in individuals with Parkinson's disease . PLoS ONE  (2014 ) 9 :e93572 . 10.1371/journal.pone.0093572 24699675 
3. Yang W-C Hsu W-L Wu R-M Lu T-W Lin K-H  . Motion analysis of axial rotation and gait stability during turning in people with Parkinson's disease . Gait Posture  (2016 ) 44 :83 –8 . 10.1016/j.gaitpost.2015.10.023 27004637 
4. Allen NE Schwarzel AK Canning CG  . Recurrent falls in parkinson's disease: a systematic review . Parkinsons Dis.  (2013 ) 2013 :906274 . 10.1155/2013/906274 23533953 
5. Bloem BR Hausdorff JM Visser JE Giladi N  . Falls and freezing of gait in Parkinson's disease: a review of two interconnected, episodic phenomena . Mov Disord.  (2004 ) 19 :871 –84 . 10.1002/mds.20115 15300651 
6. Lord SR Murray SM Chapman K Munro B Tiedemann A  . Sit-to-stand performance depends on sensation, speed, balance, and psychological status in addition to strength in older people . J Gerontol A Biol Sci Med Sci.  (2002 ) 57 :M539 –43 . 10.1093/gerona/57.8.M539 12145369 
7. Jones CJ Rikli RE Beam WC  . A 30-s chair-stand test as a measure of lower body strength in community-residing older adults . Res Q Exerc Sport  (1999 ) 70 :113 –9 . 10.1080/02701367.1999.10608028 10380242 
8. Cheng PT Liaw MY Wong MK Tang FT Lee MY Lin PS  . The sit-to-stand movement in stroke patients and its correlation with falling . Arch Phys Med Rehabil.  (1998 ) 79 :1043 –6 . 10.1016/S0003-9993(98)90168-X 9749681 
9. Goetz CG Tilley BC Shaftman SR Stebbins GT Fahn S Martinez-Martin P  . Movement disorder society-sponsored revision of the unified Parkinson's disease rating scale (MDS-UPDRS): scale presentation and clinimetric testing results . Mov Disord.  (2008 ) 23 :2129 –70 . 10.1002/mds.22340 19025984 
10. Parry SW Deary V Finch T Bamford C Sabin N McMeekin P  . The STRIDE (Strategies to Increase confidence, InDependence and Energy) study: cognitive behavioural therapy-based intervention to reduce fear of falling in older fallers living in the community–study protocol for a randomised controlled trial . Trials  (2014 ) 15 :210 . 10.1186/1745-6215-15-210 24906406 
11. Canning CG Sherrington C Lord SR Fung VSC Close JCT Latt MD  . Exercise therapy for prevention of falls in people with Parkinson's disease: a protocol for a randomised controlled trial and economic evaluation . BMC Neurol.  (2009 ) 9 :4 . 10.1186/1471-2377-9-4 19161631 
12. Wong TH Nguyen HV Chiu MT Chow KY Ong MEH Lim GH  . The low fall as a surrogate marker of frailty predicts long-term mortality in older trauma patients . PLoS ONE  (2015 ) 10 :e0137127 . 10.1371/journal.pone.0137127 26327646 
13. Veuas BJ Wayne SJ Romero LJ Baumgartner RN Garry P  
Fear of falling and restriction of mobility in elderly fallers . Age Ageing  (1997 ) 26 :189 –93 .9223714 
14. Schlicht J Camaione DN Owen SV  . Effect of intense strength training on standing balance, walking speed, and sit-to-stand performance in older adults . J Gerontol A Biol Sci Med Sci.  (2001 ) 56 :M281 –6 . 10.1093/gerona/56.5.M281 11320107 
15. Starkstein SE Merello M  . The unified Parkinson's disease rating scale: validation study of the mentation, behavior, and mood section . Mov Disord.  (2007 ) 22 :2156 –61 . 10.1002/mds.21521 17721877 
16. Rampp A Barth J Schuelein S Gassmann K-G Klucken J Eskofier BM  . Inertial sensor-based stride parameter calculation from gait sequences in geriatric patients . IEEE Trans Biomed Eng.  (2015 ) 62 :1089 –97 . 10.1109/TBME.2014.2368211 25389237 
17. Maetzler W Klucken J Horne M  . A clinical view on the development of technology-based tools in managing Parkinson's disease . Mov Disord.  (2016 ) 31 :1263 –71 . 10.1002/mds.26673 27273651 
18. Schülein S Barth J Rampp A Rupprecht R Eskofier BM Winkler J  . Instrumented gait analysis: a measure of gait improvement by a wheeled walker in hospitalized geriatric patients . J Neuroeng Rehabil.  (2017 ) 14 :18 . 10.1186/s12984-017-0228-z 28241769 
19. Klucken J Barth J Kugler P Schlachetzki J Henze T Marxreiter F  . Unbiased and mobile gait analysis detects motor impairment in Parkinson's disease . PLoS ONE  (2013 ) 8 :e56956 . 10.1371/journal.pone.0056956 23431395 
20. Bianchi MT  . Sleep devices: wearables and nearables, informational and interventional, consumer and clinical . Metabolism  (2017 ) 84 :99 –108 . 10.1016/j.metabol.2017.10.008 29080814 
21. Torous J Firth J Mueller N Onnela JP Baker JT  . Methodology and reporting of mobile heath and smartphone application studies for schizophrenia . Harv Rev Psychiatry  (2017 ) 25 :146 –54 . 10.1097/HRP.0000000000000133 28234658 
22. Pevnick JM Birkeland K Zimmer R Elad Y Kedan I  . Wearable technology for cardiology: an update and framework for the future . Trends Cardiovasc Med.  (2018 ) 28 :144 –50 . 10.1016/j.tcm.2017.08.003 28818431 
23. Haghi M Thurow K Stoll R  . Wearable devices in medical internet of things: scientific research and commercially available devices . Healthc Inform Res.  (2017 ) 23 :4 –15 . 10.4258/hir.2017.23.1.4 28261526 
24. Cahn A Akirov A Raz I  . Digital health technology and diabetes management . J Diabetes  (2018 ) 10 :10 –7 . 10.1111/1753-0407.12606 28872765 
25. Vienne A Barrois RP Buffat S Ricard D Vidal P-P  . Inertial sensors to assess gait quality in patients with neurological disorders: a systematic review of technical and analytical challenges . Front Psychol.  (2017 ) 8 :817 . 10.3389/fpsyg.2017.00817 28572784 
26. Stolze H Klebe S Baecker C Zechlin C Friege L Pohle S  . Prevalence of gait disorders in hospitalized neurological patients . Mov Disord.  (2005 ) 20 :89 –94 . 10.1002/mds.20266 15390043 
27. Hickey A Galna B Mathers JC Rochester L Godfrey A  . A multi-resolution investigation for postural transition detection and quantification using a single wearable . Gait Posture  (2016 ) 49 :411 –7 . 10.1016/j.gaitpost.2016.07.328 27513738 
28. Van Lummel RC Ainsworth E Lindemann U Zijlstra W Chiari L Van Campen P  . Automated approach for quantifying the repeated sit-to-stand using one body fixed sensor in young and older adults . Gait Posture  (2013 ) 38 :153 –6 . 10.1016/j.gaitpost.2012.10.008 23195854 
29. Van Lummel RC Walgaard S Hobert MA Maetzler W Van Dieën JH Galindo-Garre F  . Intra-rater, inter-rater and test-retest reliability of an instrumented timed up and Go (iTUG) test in patients with Parkinson's disease . PLoS ONE  (2016 ) 11 :e0151881 . 10.1371/journal.pone.0151881 26999051 
30. Najafi B Aminian K Loew F Blanc Y Robert PA  . Measurement of stand-sit and sit-stand transitions using a miniature gyroscope and its application in fall risk evaluation in the elderly . IEEE Trans Biomed Eng.  (2002 ) 49 :843 –51 . 10.1109/TBME.2002.800763 12148823 
31. Zijlstra A Mancini M Lindemann U Chiari L Zijlstra W  . Sit-stand and stand-sit transitions in older adults and patients with Parkinson's disease: event detection based on motion sensors versus force plates . J Neuroeng Rehabil.  (2012 ) 9 :75 . 10.1186/1743-0003-9-75 23039219 
32. Pham MH Elshehabi M Haertner L Heger T Hobert MA Faber GS  . Algorithm for turning detection and analysis validated under home-like conditions in patients with Parkinson's disease and older adults using a 6 degree-of-freedom inertial measurement unit at the lower back . Front Neurol.  (2017 ) 8 :135 . 10.3389/fneur.2017.00135 28443059 
33. Pham MH Elshehabi M Haertner L Del Din S Srulijes K Heger T  . Validation of a step detection algorithm during straight walking and turning in patients with Parkinson's disease and older adults using an inertial measurement unit at the lower back . Front Neurol.  (2017 ) 8 :457 . 10.3389/fneur.2017.00457 28928711 
34. Giannouli E Bock O Mellone S Zijlstra W  
Mobility in old age: capacity is not performance . Biomed Res Int.  (2016 ) 2016 :3261567 
10.1155/2016/3261567 27034932 
35. van Lummel RC Walgaard S Pijnappels M Elders PJM Garcia-Aymerich J van Dieën JH  . Physical performance and physical activity in older adults: associated but separate domains of physical function in old age . PLoS ONE  (2015 ) 10 :e0144048 . 10.1371/journal.pone.0144048 26630268 
36. Artusi CA Mishra M Latimer P Vizcarra JA Lopiano L Maetzler W  . Integration of technology-based outcome measures in clinical trials of Parkinson and other neurodegenerative diseases . Parkinsonism Relat Disord.  (2018 ) 46 :S53 –6 . 10.1016/j.parkreldis.2017.07.022 28760593 
37. Haertner LM Elshehabi M Zaunbrecher L Pham MH Maetzler C van Uem JM  . Effect of fear of falling on turning performance in Parkinson's disease in the lab and at home . Front Aging Neurosci.  (2018 ) 10 :78 . 10.3389/fnagi.2018.00078 29636676 
38. Rovini E Maremmani C Cavallo F  . How wearable sensors can support Parkinson's disease diagnosis and treatment: a systematic review . Front Neurosci.  (2017 ) 11 :555 . 10.3389/fnins.2017.00555 29056899 
39. Inkster LM Eng JJ  . Postural control during a sit-to-stand task in individuals with mild Parkinson's disease . Exp Brain Res.  (2004 ) 154 :33 –8 . 10.1007/s00221-003-1629-8 12961057 
40. Tomlinson CL Stowe R Patel S Rick C Gray R Clarke CE  . Systematic review of levodopa dose equivalency reporting in Parkinson's disease . Mov Disord.  (2010 ) 25 :2649 –53 . 10.1002/mds.23429 21069833 
41. Ramsperger R Meckler S Heger T van Uem J Hucker S Braatz U  . Continuous leg dyskinesia assessment in Parkinson's disease–clinical validity and ecological effect . Parkinsonism Relat Disord.  (2016 ) 26 :41 –6 . 10.1016/j.parkreldis.2016.02.007 26952699 
42. Ferreira JJ Godinho C Santos ATAT Domingos J Abreu D Lobo R  . Quantitative home-based assessment of Parkinson's symptoms: the SENSE-PARK feasibility and usability study . BMC Neurol.  (2015 ) 15 :89 . 10.1186/s12883-015-0343-z 26059091 
43. Ricci L Taffoni F Formica D  . On the orientation error of IMU: investigating static and dynamic accuracy targeting human motion . PLoS ONE  (2016 ) 11 :e0161940 . 10.1371/journal.pone.0161940 27612100 
44. Godfrey A Conway R Meagher D ÓLaighin G  . Direct measurement of human movement by accelerometry . Med Eng Phys.  (2008 ) 30 :1364 –86 . 10.1016/j.medengphy.2008.09.005 18996729 
45. Olivares A Ramírez J Górriz JM Olivares G Damas M  . Detection of (in)activity periods in human body motion using inertial sensors: a comparative study . Sensors (Basel)  (2012 ) 12 :5791 –814 . 10.3390/s120505791 22778613 
46. Daubechies I  
Ten Lectures on Wavelets (CBMS-NSF Regional Conference Series in Applied Mathematics) . (1992 ). Available online at: http://www.amazon.ca/exec/obidos/redirect?tag=citeulike09-20&amp;path=ASIN/0898712742
47. Mancini M El-Gohary M Pearson S McNames J Schlueter H Nutt JG  . Continuous monitoring of turning in Parkinson's disease: rehabilitation potential . NeuroRehabilitation  (2015 ) 37 :3 –10 . 10.3233/NRE-151236 26409689 
48. Madgwick SOH  
An Efficient Orientation Filter for Inertial and Inertial/Magnetic Sensor Arrays  (2010 ). Bristol : Report x-io and University of Bristol , 25 :113 –8 .
49. Lockhart TE Soangra R Zhang J Wu X  . Wavelet based automated postural event detection and activity classification with single IMU . Biomed Sci Instrum.  (2013 ) 49 :224 –33 . 10.1016/j.micinf.2011.07.011.Innate 23686204 
50. Masse F Gonzenbach R Paraschiv-Ionescu A Luft AR Aminian K  . Wearable barometric pressure sensor to improve postural transition recognition of mobility-impaired stroke patients . IEEE Trans Neural Syst Rehabil Eng.  (2016 ) 24 :1210 –7 . 10.1109/TNSRE.2016.2532844 27046903 
51. Ganea R Paraschiv-Lonescu A Aminian K  . Detection and classification of postural transitions in real-world conditions . IEEE Trans Neural Syst Rehabil Eng.  (2012 ) 20 :688 –96 . 10.1109/TNSRE.2012.2202691 22692942 
52. Salarian A Russmann H Vingerhoets FJG Burkhard PR Aminian K  . Ambulatory monitoring of physical activities in patients with Parkinson's disease . IEEE Trans Biomed Eng.  (2007 ) 54 :2296 –9 . 10.1109/tbme.2007.896591 18075046 
53. Yang CC Hsu YL  . A review of accelerometry-based wearable motion detectors for physical activity monitoring . Sensors  (2010 ) 10 :7772 –88 . 10.3390/s100807772 22163626 
54. Zijlstra W Hof AL  . Assessment of spatio-temporal gait parameters from trunk accelerations during human walking . Gait Posture  (2003 ) 18 :1 –10 . 10.1016/S0966-6362(02)00190-X 14654202 
55. Din S Godfrey A Rochester L  . Validation of an accelerometer to quantify a comprehensive battery of gait characteristics in healthy older adults and Parkinson's disease: toward clinical and at home use . IEEE J Biomed Heal Inform.  (2015 ) 20 :838 –47 . 10.1109/JBHI.2015.2419317 25850097 
56. El-Gohary M Pearson S McNames J Mancini M Horak F Mellone S  . Continuous monitoring of turning in patients with movement disability . Sensors (Basel)  (2013 ) 14 :356 –69 . 10.3390/s140100356 24379043 
57. Wachowiak MP Rash GS Quesada PM Desoky AH  . Wavelet-based noise removal for biomechanical signals: a comparative study . IEEE Trans Biomed Eng.  (2000 ) 47 :360 –8 . 10.1109/10.827298 10743778 
58. Lundin TM Jahnigen DW Grabiner MD  
Maximum trunk flexion angle during the sit to stand is not determined by knee or trunk-hip extension strength in healthy older adults . J Appl Biomech.  (1999 ) 15 :233 –41 . 10.1123/jab.15.3.233 
59. Schenkman M Riley PO Pieper C  . Sit to stand from progressively lower seat heights–alterations in angular velocity . Clin Biomech.  (1996 ) 11 :153 –8 . 10.1016/0268-0033(95)00060-7 11415613 
60. Tanigawa M Luinge H Schipper L Slycke P  
Drift-free dynamic height sensor using MEMS IMU aided by MEMS pressure sensor . In: 5th Workshop on Positioning, Navigation and Communication, WPNC'08  (2008 ). p. 191 –6 .
61. Lopane G Mellone S Chiari L Cortelli P Calandra-Buonaura G Contin M  . Dyskinesia detection and monitoring by a single sensor in patients with Parkinson's disease . Mov Disord.  (2015 ) 30 :1267 –71 . 10.1002/mds.26313 26179817 
62. Massé F Bourke AK Chardonnens J Paraschiv-Ionescu A Aminian K  . Suitability of commercial barometric pressure sensors to distinguish sitting and standing activities for wearable monitoring . Med Eng Phys.  (2014 ) 36 :739 –44 . 10.1016/j.medengphy.2014.01.001 24485500 
63. Mak MKY Yang F Pai Y-C  . Limb collapse, rather than instability, causes failure in sit-to-stand performance among patients with parkinson disease . Phys Ther.  (2011 ) 91 :381 –91 . 10.2522/ptj.20100232 21273628

